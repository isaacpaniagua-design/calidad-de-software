<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Materiales - Calidad de Software</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap");

      body {
        font-family: "Inter", sans-serif;
        background: #764ba2;
        min-height: 100vh;
      }

      .main-container {
        background: white;
        border-radius: 2rem;
        margin: 2rem;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        overflow: hidden;
        position: relative;
      }

      .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 3rem 2rem;
        text-align: center;
        position: relative;
      }

      .header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
        opacity: 0.3;
      }

      .header-content {
        position: relative;
        z-index: 1;
      }

      .platform-title {
        font-size: 3rem;
        font-weight: 800;
        margin-bottom: 1rem;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      }

      .platform-subtitle {
        font-size: 1.5rem;
        opacity: 0.9;
        font-weight: 500;
      }

      .role-toggle {
        position: absolute;
        top: 2rem;
        right: 2rem;
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
        border-radius: 2rem;
        padding: 0.5rem;
        display: flex;
        gap: 0.5rem;
      }

      .role-btn {
        padding: 0.75rem 1.5rem;
        border-radius: 1.5rem;
        background: transparent;
        color: white;
        border: none;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .role-btn.active {
        background: white;
        color: #764ba2;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .content-area {
        padding: 3rem 2rem;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin-bottom: 3rem;
      }

      .stat-card {
        background: linear-gradient(135deg, #f8fafc, #e2e8f0);
        border-radius: 1rem;
        padding: 2rem;
        text-align: center;
        border: 2px solid #e2e8f0;
        transition: all 0.3s ease;
      }

      .stat-card:hover {
        transform: translateY(-5px);
        border-color: #764ba2;
        box-shadow: 0 10px 30px rgba(118, 75, 162, 0.2);
      }

      .stat-icon {
        width: 3rem;
        height: 3rem;
        background: linear-gradient(135deg, #667eea, #764ba2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.5rem;
        margin: 0 auto 1rem;
      }

      .stat-number {
        font-size: 2rem;
        font-weight: 800;
        color: #1a202c;
        margin-bottom: 0.5rem;
      }

      .stat-label {
        color: #4a5568;
        font-weight: 500;
      }

      .upload-area {
        border: 3px dashed #cbd5e0;
        border-radius: 1rem;
        padding: 3rem;
        text-align: center;
        margin-bottom: 3rem;
        transition: all 0.3s ease;
        cursor: pointer;
        background: #f7fafc;
      }

      .upload-area:hover,
      .upload-area.dragover {
        border-color: #764ba2;
        background: #f0f4ff;
        transform: scale(1.02);
      }

      .upload-icon {
        font-size: 4rem;
        color: #764ba2;
        margin-bottom: 1rem;
      }

      .upload-text {
        font-size: 1.25rem;
        color: #4a5568;
        margin-bottom: 1rem;
      }

      .upload-subtext {
        color: #718096;
        font-size: 0.9rem;
      }

      .file-input {
        display: none;
      }

      .category-tabs {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
      }

      .category-tab {
        padding: 1rem 2rem;
        border-radius: 2rem;
        background: #f7fafc;
        color: #4a5568;
        border: 2px solid #e2e8f0;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .category-tab:hover {
        border-color: #764ba2;
        color: #764ba2;
      }

      .category-tab.active {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border-color: #764ba2;
      }

      .search-bar {
        position: relative;
        margin-bottom: 2rem;
      }

      .search-input {
        width: 100%;
        padding: 1rem 1rem 1rem 3rem;
        border: 2px solid #e2e8f0;
        border-radius: 1rem;
        font-size: 1rem;
        transition: all 0.3s ease;
      }

      .search-input:focus {
        outline: none;
        border-color: #764ba2;
        box-shadow: 0 0 0 3px rgba(118, 75, 162, 0.1);
      }

      .search-icon {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: #9ca3af;
      }

      .materials-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 2rem;
        margin-bottom: 3rem;
        align-items: stretch;
      }

      .material-card {
        background: white;
        border-radius: 1rem;
        padding: 2rem;
        border: 2px solid #e2e8f0;
        transition: all 0.3s ease;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        height: 100%;
      }

      .material-card:hover {
        transform: translateY(-5px);
        border-color: #764ba2;
        box-shadow: 0 10px 30px rgba(118, 75, 162, 0.2);
      }

      .material-header {
        display: flex;
        align-items: flex-start;
        margin-bottom: 1rem;
        min-height: 4rem;
      }

      .file-icon {
        width: 3rem;
        height: 3rem;
        border-radius: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.5rem;
        margin-right: 1rem;
        flex-shrink: 0;
      }

      .file-icon.pdf {
        background: linear-gradient(135deg, #dc2626, #991b1b);
      }

      .file-icon.doc {
        background: linear-gradient(135deg, #2563eb, #1d4ed8);
      }

      .file-icon.xls {
        background: linear-gradient(135deg, #16a34a, #15803d);
      }

      .file-icon.ppt {
        background: linear-gradient(135deg, #ea580c, #c2410c);
      }

      .file-icon.default {
        background: linear-gradient(135deg, #6b7280, #4b5563);
      }

      .material-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: #1a202c;
        margin-bottom: 0.5rem;
        line-height: 1.3;
        min-height: 2.6rem;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .material-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        color: #718096;
        font-size: 0.9rem;
        margin-bottom: 1rem;
      }

      .material-description {
        color: #4a5568;
        font-size: 0.9rem;
        line-height: 1.5;
        flex-grow: 1;
        margin-bottom: 1.5rem;
        min-height: 3.6rem;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .material-actions {
        display: flex;
        gap: 0.5rem;
        margin-top: auto;
      }

      .action-btn {
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        border: none;
        cursor: pointer;
        font-weight: 600;
        font-size: 0.9rem;
        transition: all 0.3s ease;
      }

      .download-btn {
        background: linear-gradient(135deg, #16a34a, #15803d);
        color: white;
        flex: 1;
      }

      .download-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(22, 163, 74, 0.4);
      }

      .edit-btn {
        background: linear-gradient(135deg, #f59e0b, #d97706);
        color: white;
      }

      .edit-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(245, 158, 11, 0.4);
      }

      .delete-btn {
        background: linear-gradient(135deg, #dc2626, #991b1b);
        color: white;
      }

      .delete-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(220, 38, 38, 0.4);
      }

      .upload-form {
        background: #f8fafc;
        border-radius: 1rem;
        padding: 2rem;
        margin-bottom: 3rem;
        border: 2px solid #e2e8f0;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-label {
        display: block;
        font-weight: 600;
        color: #374151;
        margin-bottom: 0.5rem;
      }

      .form-input,
      .form-select,
      .form-textarea {
        width: 100%;
        padding: 0.75rem;
        border: 2px solid #e2e8f0;
        border-radius: 0.5rem;
        font-size: 1rem;
        transition: all 0.3s ease;
      }

      .form-input:focus,
      .form-select:focus,
      .form-textarea:focus {
        outline: none;
        border-color: #764ba2;
        box-shadow: 0 0 0 3px rgba(118, 75, 162, 0.1);
      }

      .form-textarea {
        resize: vertical;
        min-height: 100px;
      }

      .submit-btn {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 1rem 2rem;
        border-radius: 0.5rem;
        border: none;
        cursor: pointer;
        font-weight: 700;
        font-size: 1rem;
        transition: all 0.3s ease;
      }

      .submit-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(118, 75, 162, 0.4);
      }

      .progress-bar {
        width: 100%;
        height: 0.5rem;
        background: #e2e8f0;
        border-radius: 0.25rem;
        overflow: hidden;
        margin-top: 1rem;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(135deg, #16a34a, #15803d);
        width: 0%;
        transition: width 0.3s ease;
      }

      .hidden {
        display: none !important;
      }

      .notification {
        position: fixed;
        top: 2rem;
        right: 2rem;
        background: white;
        border-radius: 1rem;
        padding: 1.5rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        border-left: 4px solid #16a34a;
        z-index: 1000;
        transform: translateX(100%);
        transition: transform 0.3s ease;
      }

      .notification.show {
        transform: translateX(0);
      }

      .notification.error {
        border-left-color: #dc2626;
      }

      @media (max-width: 768px) {
        .main-container {
          margin: 1rem;
        }

        .header {
          padding: 2rem 1rem;
        }

        .platform-title {
          font-size: 2rem;
        }

        .role-toggle {
          position: relative;
          top: auto;
          right: auto;
          margin-top: 2rem;
        }

        .content-area {
          padding: 2rem 1rem;
        }

        .materials-grid {
          grid-template-columns: 1fr;
        }

        .category-tabs {
          justify-content: center;
        }
      }
    </style>
  
<style>
html, body { min-height: 100%; }
body{
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
  padding-top: 80px;
}
.qs-nav{position:fixed;top:0;left:0;right:0;z-index:1000;backdrop-filter:saturate(140%) blur(20px);
       background:rgba(255,255,255,.95);border-bottom:1px solid rgba(255,255,255,.2);
       box-shadow:0 8px 32px rgba(0,0,0,.10)}
.qs-nav .wrap{max-width:1200px;margin:0 auto;padding:15px 20px;display:flex;gap:16px;align-items:center;justify-content:space-between;flex-wrap:nowrap}
.qs-brand{display:flex;gap:15px;align-items:center;color:#1f2937;font-weight:800;font-size:1.3rem;text-decoration:none;position:relative;padding:8px 16px;border-radius:20px;flex:0 0 auto}
.qs-brand::before{content:"🎓";font-size:1.6rem}
.qs-tabs{display:flex;gap:12px;background:rgba(255,255,255,.3);padding:8px;border-radius:30px;backdrop-filter:blur(10px);
         flex:1 1 auto;justify-content:flex-end;flex-wrap:nowrap;overflow-x:auto;white-space:nowrap;scrollbar-width:thin;-webkit-overflow-scrolling:touch}
.qs-btn{border:0;padding:12px 20px;border-radius:25px;background:rgba(255,255,255,.7);color:#374151;cursor:pointer;text-decoration:none;font-weight:600;font-size:.9rem;
       transition:all .4s cubic-bezier(.4,0,.2,1);backdrop-filter:blur(10px);border:2px solid transparent;position:relative;overflow:hidden;flex:0 0 auto}
.qs-btn::before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(135deg,#667eea,#764ba2);transition:all .4s ease;z-index:-1}
.qs-btn:hover{color:#fff;transform:translateY(-3px);box-shadow:0 8px 25px rgba(102,126,234,.4);border-color:rgba(102,126,234,.3)}
.qs-btn:hover::before{left:0}
.qs-btn[aria-current="page"]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;pointer-events:none;box-shadow:0 6px 20px rgba(102,126,234,.5);transform:translateY(-2px)}
.qs-btn[aria-current="page"]::before{left:0}
.footer{
  margin-top:60px;
  padding:30px 20px;
  text-align:center;
  background:rgba(255, 255, 255, 0.1);
  backdrop-filter:blur(10px);
  border-top:1px solid rgba(255, 255, 255, 0.2);
}
.footer-content{
  max-width:1200px;
  margin:0 auto;
  color:rgba(255,255,255,0.8);
  font-size:0.95rem;
  transition:all 0.3s ease;
  cursor:default;
}
.footer-content:hover{ color:#fff; transform:translateY(-2px); }
</style>


<style>
/* Ajuste tipografía y espacio del NAV para que el efecto se vea completo */
.qs-nav .wrap{padding-top:18px;padding-bottom:18px}
.qs-tabs{padding:10px 12px; overflow: visible}
.qs-btn{font-size:.85rem}
.qs-btn:hover{transform:translateY(-4px)}
.qs-btn[aria-current="page"]{transform:translateY(-3px)}
</style>

</head>
  <body>

<div class="qs-nav">
  <div class="wrap">
    <a class="qs-brand" href="index.html"><span>Plataforma QS</span></a>
    <nav class="qs-tabs" aria-label="Navegación">
      <a class="qs-btn" href="materiales.html" aria-current="page">Materiales</a>
      <a class="qs-btn" href="asistencia.html">Asistencia</a>
      <a class="qs-btn" href="calificaciones.html">Calificaciones</a>
      <a class="qs-btn" href="Foro.html">Foro</a>
      <a class="qs-btn" href="paneldocente.html">Panel</a>
      <a class="qs-btn" href="roadmap.html">Roadmap</a>
      <a class="qs-btn" href="checklist.html">Checklist</a>
      <a class="qs-btn" href="status.html">Status</a>
    </nav>
  </div>
</div>

    <div class="main-container">
      <!-- Header -->
      <div class="header">
        <div class="role-toggle">
          <button
            class="role-btn active"
            onclick="switchRole('teacher')"
            id="teacherBtn"
          >
            👨‍🏫 Profesor
          </button>
          <button
            class="role-btn"
            onclick="switchRole('student')"
            id="studentBtn"
          >
            👨‍🎓 Estudiante
          </button>
        </div>

        <div class="header-content">
          <h1 class="platform-title">📚 Materiales de Curso</h1>
          <p class="platform-subtitle">
            Calidad de Software - Recursos y Documentos
          </p>
        </div>
      </div>

      <!-- Content Area -->
      <div class="content-area">
        <!-- Auth bar for Materials -->
        <div class="w-full flex items-center justify-center py-3">
          <div id="authAreaMaterials" class="flex items-center justify-center gap-3">
            <button id="signInMaterials" class="bg-gradient-to-r from-emerald-600 to-green-600 text-white px-4 py-2 rounded-full hover:from-emerald-700 hover:to-green-700 transition-all duration-200 font-semibold">
              Acceder con cuenta @potros
            </button>
            <div id="userInfoMaterials" class="hidden items-center gap-3">
              <img id="userPhotoMaterials" class="w-8 h-8 rounded-full border" alt="Foto" />
              <span id="userNameMaterials" class="text-gray-800 font-medium"></span>
              <button id="signOutMaterials" class="px-3 py-1 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm font-medium">Salir</button>
            </div>
          </div>
        </div>
        <!-- Teacher View -->
        <div id="teacherView">
          <!-- Statistics -->
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon">📄</div>
              <div class="stat-number">24</div>
              <div class="stat-label">Total Materiales</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">📥</div>
              <div class="stat-number">156</div>
              <div class="stat-label">Descargas</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">📊</div>
              <div class="stat-number">4</div>
              <div class="stat-label">Categorías</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">🕒</div>
              <div class="stat-number">Hoy</div>
              <div class="stat-label">Última Actualización</div>
            </div>
          </div>

          <!-- Upload Area -->
          <div
            class="upload-area"
            onclick="document.getElementById('fileInput').click()"
          >
            <div class="upload-icon">☁️</div>
            <div class="upload-text">
              Arrastra archivos aquí o haz clic para seleccionar
            </div>
            <div class="upload-subtext">
              Formatos soportados: PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX (Máx.
              10MB)
            </div>
            <input
              type="file"
              id="fileInput"
              class="file-input"
              multiple
              accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx"
            />
          </div>

          <!-- Upload Form -->
          <div class="upload-form hidden" id="uploadForm">
            <h3 class="text-xl font-bold text-gray-800 mb-4">
              📝 Detalles del Material
            </h3>
            <form id="materialForm">
              <div class="form-group">
                <label class="form-label">Título del Material</label>
                <input
                  type="text"
                  class="form-input"
                  id="materialTitle"
                  placeholder="Ej: Presentación Sesión 1 - Introducción"
                />
              </div>

              <div class="form-group">
                <label class="form-label">Categoría</label>
                <select class="form-select" id="materialCategory">
                  <option value="presentations">📊 Presentaciones</option>
                  <option value="templates">📋 Plantillas</option>
                  <option value="exercises">✏️ Ejercicios</option>
                  <option value="references">📚 Referencias</option>
                </select>
              </div>

              <div class="form-group">
                <label class="form-label">Descripción</label>
                <textarea
                  class="form-textarea"
                  id="materialDescription"
                  placeholder="Breve descripción del contenido y propósito del material"
                ></textarea>
              </div>

              <div class="form-group">
                <button type="submit" class="submit-btn">
                  📤 Subir Material
                </button>
                <button
                  type="button"
                  class="submit-btn"
                  onclick="cancelUpload()"
                  style="background: #6b7280; margin-left: 1rem"
                >
                  ❌ Cancelar
                </button>
              </div>

              <div class="progress-bar hidden" id="progressBar">
                <div class="progress-fill" id="progressFill"></div>
              </div>
            </form>
          </div>
        </div>

        <!-- Student View -->
        <div id="studentView" class="hidden">
          <!-- Search Bar -->
          <div class="search-bar">
            <div class="search-icon">🔍</div>
            <input
              type="text"
              class="search-input"
              placeholder="Buscar materiales..."
              id="searchInput"
            />
          </div>
        </div>

        <!-- Category Tabs (Both Views) -->
        <div class="category-tabs">
          <div class="category-tab active" data-category="all">📁 Todos</div>
          <div class="category-tab" data-category="presentations">
            📊 Presentaciones
          </div>
          <div class="category-tab" data-category="templates">
            📋 Plantillas
          </div>
          <div class="category-tab" data-category="exercises">
            ✏️ Ejercicios
          </div>
          <div class="category-tab" data-category="references">
            📚 Referencias
          </div>
        </div>

        <!-- Materials Grid -->
        <div class="materials-grid" id="materialsGrid">
          <!-- Sample Materials -->
          <div class="material-card" data-category="presentations">
            <div class="material-header">
              <div class="file-icon pdf">📄</div>
              <div>
                <div class="material-title">
                  Sesión 1: Introducción a la Calidad
                </div>
                <div class="material-meta">
                  <span>📅 15 Ago 2024</span>
                  <span>📥 23 descargas</span>
                </div>
              </div>
            </div>
            <div class="material-description">
              Presentación introductoria que cubre los conceptos fundamentales
              de calidad de software, definiciones clave y la importancia en el
              desarrollo moderno.
            </div>
            <div class="material-actions">
              <button
                class="action-btn download-btn"
                onclick="downloadFile('sesion1.pdf')"
              >
                📥 Descargar
              </button>
              <button
                class="action-btn edit-btn teacher-only"
                onclick="editMaterial(1)"
              >
                ✏️ Editar
              </button>
              <button
                class="action-btn delete-btn teacher-only"
                onclick="deleteMaterial(1)"
              >
                🗑️ Eliminar
              </button>
            </div>
          </div>

          <div class="material-card" data-category="templates">
            <div class="material-header">
              <div class="file-icon doc">📝</div>
              <div>
                <div class="material-title">Plantilla de Plan de Calidad</div>
                <div class="material-meta">
                  <span>📅 12 Ago 2024</span>
                  <span>📥 18 descargas</span>
                </div>
              </div>
            </div>
            <div class="material-description">
              Plantilla estándar para elaborar planes de calidad de software
              siguiendo las mejores prácticas de la industria.
            </div>
            <div class="material-actions">
              <button
                class="action-btn download-btn"
                onclick="downloadFile('plantilla-plan-calidad.docx')"
              >
                📥 Descargar
              </button>
              <button
                class="action-btn edit-btn teacher-only"
                onclick="editMaterial(2)"
              >
                ✏️ Editar
              </button>
              <button
                class="action-btn delete-btn teacher-only"
                onclick="deleteMaterial(2)"
              >
                🗑️ Eliminar
              </button>
            </div>
          </div>

          <div class="material-card" data-category="exercises">
            <div class="material-header">
              <div class="file-icon xls">📊</div>
              <div>
                <div class="material-title">
                  Ejercicios de Métricas de Calidad
                </div>
                <div class="material-meta">
                  <span>📅 10 Ago 2024</span>
                  <span>📥 31 descargas</span>
                </div>
              </div>
            </div>
            <div class="material-description">
              Conjunto de ejercicios prácticos para calcular y analizar
              diferentes métricas de calidad de software con ejemplos reales.
            </div>
            <div class="material-actions">
              <button
                class="action-btn download-btn"
                onclick="downloadFile('ejercicios-metricas.xlsx')"
              >
                📥 Descargar
              </button>
              <button
                class="action-btn edit-btn teacher-only"
                onclick="editMaterial(3)"
              >
                ✏️ Editar
              </button>
              <button
                class="action-btn delete-btn teacher-only"
                onclick="deleteMaterial(3)"
              >
                🗑️ Eliminar
              </button>
            </div>
          </div>

          <div class="material-card" data-category="references">
            <div class="material-header">
              <div class="file-icon pdf">📚</div>
              <div>
                <div class="material-title">Guía de Estándares ISO 25010</div>
                <div class="material-meta">
                  <span>📅 8 Ago 2024</span>
                  <span>📥 45 descargas</span>
                </div>
              </div>
            </div>
            <div class="material-description">
              Documento de referencia completo sobre el estándar ISO 25010 para
              la evaluación de calidad de productos de software.
            </div>
            <div class="material-actions">
              <button
                class="action-btn download-btn"
                onclick="downloadFile('iso-25010-guia.pdf')"
              >
                📥 Descargar
              </button>
              <button
                class="action-btn edit-btn teacher-only"
                onclick="editMaterial(4)"
              >
                ✏️ Editar
              </button>
              <button
                class="action-btn delete-btn teacher-only"
                onclick="deleteMaterial(4)"
              >
                🗑️ Eliminar
              </button>
            </div>
          </div>

          <div class="material-card" data-category="presentations">
            <div class="material-header">
              <div class="file-icon ppt">📊</div>
              <div>
                <div class="material-title">Sesión 5: Modelos de Calidad</div>
                <div class="material-meta">
                  <span>📅 5 Ago 2024</span>
                  <span>📥 27 descargas</span>
                </div>
              </div>
            </div>
            <div class="material-description">
              Presentación detallada sobre los principales modelos de calidad de
              software: McCall, Boehm, ISO 9126 e ISO 25010.
            </div>
            <div class="material-actions">
              <button
                class="action-btn download-btn"
                onclick="downloadFile('sesion5-modelos.pptx')"
              >
                📥 Descargar
              </button>
              <button
                class="action-btn edit-btn teacher-only"
                onclick="editMaterial(5)"
              >
                ✏️ Editar
              </button>
              <button
                class="action-btn delete-btn teacher-only"
                onclick="deleteMaterial(5)"
              >
                🗑️ Eliminar
              </button>
            </div>
          </div>

          <div class="material-card" data-category="templates">
            <div class="material-header">
              <div class="file-icon doc">📋</div>
              <div>
                <div class="material-title">Formato de Reporte de Defectos</div>
                <div class="material-meta">
                  <span>📅 3 Ago 2024</span>
                  <span>📥 22 descargas</span>
                </div>
              </div>
            </div>
            <div class="material-description">
              Plantilla estandarizada para documentar y reportar defectos
              encontrados durante las pruebas de software.
            </div>
            <div class="material-actions">
              <button
                class="action-btn download-btn"
                onclick="downloadFile('formato-defectos.docx')"
              >
                📥 Descargar
              </button>
              <button
                class="action-btn edit-btn teacher-only"
                onclick="editMaterial(6)"
              >
                ✏️ Editar
              </button>
              <button
                class="action-btn delete-btn teacher-only"
                onclick="deleteMaterial(6)"
              >
                🗑️ Eliminar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
      <div class="flex items-center">
        <div class="text-2xl mr-3" id="notificationIcon">✅</div>
        <div>
          <div class="font-bold" id="notificationTitle">Éxito</div>
          <div class="text-sm text-gray-600" id="notificationMessage">
            Operación completada correctamente
          </div>
        </div>
      </div>
    </div>

    <script>
      let currentRole = "teacher";
      let selectedFiles = [];

      // Role switching
      function switchRole(role) {
        currentRole = role;

        // Update buttons
        document
          .getElementById("teacherBtn")
          .classList.toggle("active", role === "teacher");
        document
          .getElementById("studentBtn")
          .classList.toggle("active", role === "student");

        // Update views
        document
          .getElementById("teacherView")
          .classList.toggle("hidden", role !== "teacher");
        document
          .getElementById("studentView")
          .classList.toggle("hidden", role !== "student");

        // Update teacher-only elements
        const teacherOnlyElements = document.querySelectorAll(".teacher-only");
        teacherOnlyElements.forEach((element) => {
          element.classList.toggle("hidden", role !== "teacher");
        });

        showNotification(
          "success",
          "Vista cambiada",
          `Ahora viendo como ${role === "teacher" ? "Profesor" : "Estudiante"}`
        );
      }

      // File upload handling
      document
        .getElementById("fileInput")
        .addEventListener("change", function (e) {
          selectedFiles = Array.from(e.target.files);
          if (selectedFiles.length > 0) {
            document.getElementById("uploadForm").classList.remove("hidden");
            document.querySelector(".upload-area").style.display = "none";
          }
        });

      // Drag and drop
      const uploadArea = document.querySelector(".upload-area");

      uploadArea.addEventListener("dragover", function (e) {
        e.preventDefault();
        uploadArea.classList.add("dragover");
      });

      uploadArea.addEventListener("dragleave", function (e) {
        e.preventDefault();
        uploadArea.classList.remove("dragover");
      });

      uploadArea.addEventListener("drop", function (e) {
        e.preventDefault();
        uploadArea.classList.remove("dragover");

        selectedFiles = Array.from(e.dataTransfer.files);
        if (selectedFiles.length > 0) {
          document.getElementById("uploadForm").classList.remove("hidden");
          uploadArea.style.display = "none";
        }
      });

      // Form submission
      document
        .getElementById("materialForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const title = document.getElementById("materialTitle").value;
          const category = document.getElementById("materialCategory").value;
          const description = document.getElementById(
            "materialDescription"
          ).value;

          if (!title || !description) {
            showNotification(
              "error",
              "Error",
              "Por favor completa todos los campos requeridos"
            );
            return;
          }

          // Simulate upload progress
          const progressBar = document.getElementById("progressBar");
          const progressFill = document.getElementById("progressFill");

          progressBar.classList.remove("hidden");

          let progress = 0;
          const interval = setInterval(() => {
            progress += Math.random() * 30;
            if (progress >= 100) {
              progress = 100;
              clearInterval(interval);

              setTimeout(() => {
                showNotification(
                  "success",
                  "Material subido",
                  `${selectedFiles.length} archivo(s) subido(s) correctamente`
                );
                resetUploadForm();

                // Add new material to grid (simulation)
                addMaterialToGrid(
                  title,
                  category,
                  description,
                  selectedFiles[0]
                );
              }, 500);
            }
            progressFill.style.width = progress + "%";
          }, 200);
        });

      function cancelUpload() {
        resetUploadForm();
      }

      function resetUploadForm() {
        document.getElementById("uploadForm").classList.add("hidden");
        document.querySelector(".upload-area").style.display = "block";
        document.getElementById("materialForm").reset();
        document.getElementById("progressBar").classList.add("hidden");
        document.getElementById("progressFill").style.width = "0%";
        selectedFiles = [];
      }

      function addMaterialToGrid(title, category, description, file) {
        const grid = document.getElementById("materialsGrid");
        const fileExtension = file.name.split(".").pop().toLowerCase();

        let iconClass = "default";
        let iconEmoji = "📄";

        if (["pdf"].includes(fileExtension)) {
          iconClass = "pdf";
          iconEmoji = "📄";
        } else if (["doc", "docx"].includes(fileExtension)) {
          iconClass = "doc";
          iconEmoji = "📝";
        } else if (["xls", "xlsx"].includes(fileExtension)) {
          iconClass = "xls";
          iconEmoji = "📊";
        } else if (["ppt", "pptx"].includes(fileExtension)) {
          iconClass = "ppt";
          iconEmoji = "📊";
        }

        const materialCard = document.createElement("div");
        materialCard.className = "material-card";
        materialCard.setAttribute("data-category", category);

        materialCard.innerHTML = `
                <div class="material-header">
                    <div class="file-icon ${iconClass}">${iconEmoji}</div>
                    <div>
                        <div class="material-title">${title}</div>
                        <div class="material-meta">
                            <span>📅 Hoy</span>
                            <span>📥 0 descargas</span>
                        </div>
                    </div>
                </div>
                <div class="material-description">${description}</div>
                <div class="material-actions">
                    <button class="action-btn download-btn" onclick="downloadFile('${
                      file.name
                    }')">📥 Descargar</button>
                    <button class="action-btn edit-btn teacher-only" onclick="editMaterial(${Date.now()})">✏️ Editar</button>
                    <button class="action-btn delete-btn teacher-only" onclick="deleteMaterial(${Date.now()})">🗑️ Eliminar</button>
                </div>
            `;

        grid.insertBefore(materialCard, grid.firstChild);

        // Update teacher-only visibility
        if (currentRole !== "teacher") {
          materialCard
            .querySelectorAll(".teacher-only")
            .forEach((el) => el.classList.add("hidden"));
        }
      }

      // Category filtering
      document.querySelectorAll(".category-tab").forEach((tab) => {
        tab.addEventListener("click", function () {
          // Update active tab
          document
            .querySelectorAll(".category-tab")
            .forEach((t) => t.classList.remove("active"));
          this.classList.add("active");

          // Filter materials
          const category = this.getAttribute("data-category");
          const materials = document.querySelectorAll(".material-card");

          materials.forEach((material) => {
            if (
              category === "all" ||
              material.getAttribute("data-category") === category
            ) {
              material.style.display = "block";
            } else {
              material.style.display = "none";
            }
          });
        });
      });

      // Search functionality
      document
        .getElementById("searchInput")
        .addEventListener("input", function (e) {
          const searchTerm = e.target.value.toLowerCase();
          const materials = document.querySelectorAll(".material-card");

          materials.forEach((material) => {
            const title = material
              .querySelector(".material-title")
              .textContent.toLowerCase();
            const description = material
              .querySelector(".material-description")
              .textContent.toLowerCase();

            if (
              title.includes(searchTerm) ||
              description.includes(searchTerm)
            ) {
              material.style.display = "block";
            } else {
              material.style.display = "none";
            }
          });
        });

      // Material actions
      function downloadFile(filename) {
        showNotification(
          "success",
          "Descarga iniciada",
          `Descargando ${filename}`
        );

        // Simulate download (in real implementation, this would trigger actual download)
        console.log("Downloading:", filename);
      }

      function editMaterial(id) {
        showNotification(
          "info",
          "Editar material",
          `Editando material ID: ${id}`
        );
        // Implement edit functionality
      }

      function deleteMaterial(id) {
        if (confirm("¿Estás seguro de que quieres eliminar este material?")) {
          showNotification(
            "success",
            "Material eliminado",
            "El material ha sido eliminado correctamente"
          );
          // Implement delete functionality
        }
      }

      // Notification system
      function showNotification(type, title, message) {
        const notification = document.getElementById("notification");
        const icon = document.getElementById("notificationIcon");
        const titleEl = document.getElementById("notificationTitle");
        const messageEl = document.getElementById("notificationMessage");

        // Set content
        titleEl.textContent = title;
        messageEl.textContent = message;

        // Set type
        notification.classList.remove("error");
        if (type === "error") {
          notification.classList.add("error");
          icon.textContent = "❌";
        } else if (type === "info") {
          icon.textContent = "ℹ️";
        } else {
          icon.textContent = "✅";
        }

        // Show notification
        notification.classList.add("show");

        // Hide after 3 seconds
        setTimeout(() => {
          notification.classList.remove("show");
        }, 3000);
      }

      // Initialize
      switchRole("teacher");
    </script>
    <script type="module">
      import { onAuth, signInWithGooglePotros, signOutCurrent, uploadMaterial, subscribeMaterials, deleteMaterialById, incrementMaterialDownloads } from './js/firebase.js';
      import { allowedEmailDomain, allowedTeacherEmails } from './js/firebase-config.js';

      const signInBtn = document.getElementById('signInMaterials');
      const signOutBtn = document.getElementById('signOutMaterials');
      const userInfo = document.getElementById('userInfoMaterials');
      const userName = document.getElementById('userNameMaterials');
      const userPhoto = document.getElementById('userPhotoMaterials');

      if (signInBtn) signInBtn.addEventListener('click', async () => {
        try { await signInWithGooglePotros(); } catch (e) { alert(e.message || 'No se pudo iniciar sesión'); }
      });
      if (signOutBtn) signOutBtn.addEventListener('click', async () => { await signOutCurrent(); });

      function setRoleUI(isTeacher) {
        if (typeof window.switchRole === 'function') window.switchRole(isTeacher ? 'teacher' : 'student');
      }

      let unsubscribeMaterials = null;
      onAuth(async (user) => {
        const isPotros = !!user?.email?.toLowerCase().endsWith(`@${allowedEmailDomain}`);
        const isTeacher = isPotros && allowedTeacherEmails.includes(user.email.toLowerCase());

        if (isPotros) {
          userName.textContent = user.displayName || user.email;
          if (user.photoURL) { userPhoto.src = user.photoURL; userPhoto.classList.remove('hidden'); } else { userPhoto.classList.add('hidden'); }
          userInfo.classList.remove('hidden');
          if (signInBtn) signInBtn.classList.add('hidden');
        } else {
          userInfo.classList.add('hidden');
          if (signInBtn) signInBtn.classList.remove('hidden');
        }

        setRoleUI(!!isTeacher);

        if (unsubscribeMaterials) { unsubscribeMaterials(); unsubscribeMaterials = null; }
        if (isPotros) {
          const grid = document.getElementById('materialsGrid');
          unsubscribeMaterials = subscribeMaterials((items) => {
            if (!grid) return;
            grid.innerHTML = '';
            for (const item of items) {
              const ext = (item.path || '').split('.').pop().toLowerCase();
              let iconClass = 'default'; let iconEmoji = '📄';
              if (ext === 'pdf') { iconClass = 'pdf'; iconEmoji = '📄'; }
              else if (['doc','docx'].includes(ext)) { iconClass='doc'; iconEmoji='📝'; }
              else if (['xls','xlsx'].includes(ext)) { iconClass='xls'; iconEmoji='📊'; }
              else if (['ppt','pptx'].includes(ext)) { iconClass='ppt'; iconEmoji='📈'; }
              const card = document.createElement('div');
              card.className = 'material-card';
              card.setAttribute('data-category', item.category || 'others');
              card.innerHTML = `
                <div class="material-header">
                  <div class="file-icon ${iconClass}">${iconEmoji}</div>
                  <div>
                    <div class="material-title">${item.title || 'Sin título'}</div>
                    <div class="material-meta">
                      <span>📅 ${(item.createdAt && item.createdAt.toDate) ? item.createdAt.toDate().toLocaleDateString('es-MX') : 'Hoy'}</span>
                      <span>⬇️ ${item.downloads || 0} descargas</span>
                    </div>
                  </div>
                </div>
                <div class="material-description">${item.description || ''}</div>
                <div class="material-actions">
                  <button class="action-btn download-btn">⬇️ Descargar</button>
                  ${isTeacher ? `<button class="action-btn delete-btn" data-id="${item.id}">🗑️ Eliminar</button>` : ''}
                </div>`;
              const dlBtn = card.querySelector('.download-btn');
              dlBtn?.addEventListener('click', async () => {
                try { await incrementMaterialDownloads(item.id); } catch (_) {}
                window.open(item.url, '_blank', 'noopener');
              });
              if (isTeacher) {
                const btn = card.querySelector('.delete-btn');
                btn?.addEventListener('click', async () => {
                  if (confirm('¿Eliminar este material?')) {
                    try { await deleteMaterialById(item.id); } catch (e) { alert('No se pudo eliminar'); }
                  }
                });
              }
              grid.appendChild(card);
            }
          });
        }
      });

      // Override submit to upload to Firebase
      const form = document.getElementById('materialForm');
      if (form) {
        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          e.stopImmediatePropagation();
          const fileInput = document.getElementById('fileInput');
          const file = fileInput?.files?.[0];
          const title = document.getElementById('materialTitle').value.trim();
          const category = document.getElementById('materialCategory').value;
          const description = document.getElementById('materialDescription').value.trim();
          if (!file || !title) { alert('Selecciona archivo y título'); return; }
          const progressBar = document.getElementById('progressBar');
          const progressFill = document.getElementById('progressFill');
          progressBar?.classList.remove('hidden');
          try {
            await uploadMaterial({ file, title, category, description, onProgress: (p) => { if (progressFill) progressFill.style.width = `${p}%`; } });
            // Reset form
            progressBar?.classList.add('hidden');
            if (progressFill) progressFill.style.width = '0%';
            (document.getElementById('materialForm')).reset();
            const uploadArea = document.querySelector('.upload-area');
            if (uploadArea) uploadArea.style.display = 'block';
          } catch (err) {
            alert('No se pudo subir el material');
          }
        }, { capture: true });
      }
    </script>
    <script>
      (function () {
        function c() {
          var b = a.contentDocument || a.contentWindow.document;
          if (b) {
            var d = b.createElement("script");
            d.innerHTML =
              "window.__CF$cv$params={r:'97b7a97f37dc2a88',t:'MTc1NzI2MzM3NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
            b.getElementsByTagName("head")[0].appendChild(d);
          }
        }
        if (document.body) {
          var a = document.createElement("iframe");
          a.height = 1;
          a.width = 1;
          a.style.position = "absolute";
          a.style.top = 0;
          a.style.left = 0;
          a.style.border = "none";
          a.style.visibility = "hidden";
          document.body.appendChild(a);
          if ("loading" !== document.readyState) c();
          else if (window.addEventListener)
            document.addEventListener("DOMContentLoaded", c);
          else {
            var e = document.onreadystatechange || function () {};
            document.onreadystatechange = function (b) {
              e(b);
              "loading" !== document.readyState &&
                ((document.onreadystatechange = e), c());
            };
          }
        }
      })();
    </script>
  
<footer class="footer">
  <div class="footer-content">© 2024 · Plataforma QS - Calidad de Software | Isaac Paniagua</div>
</footer>

</body>
</html>
