<!doctype html>
<html lang="es" style="height: 100%;">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Herramienta de An√°lisis de Brechas</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        .priority-high { border-left: 4px solid #ef4444; }
        .priority-medium { border-left: 4px solid #f59e0b; }
        .priority-low { border-left: 4px solid #10b981; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @media print {
            .no-print { display: none !important; }
            body { background: white !important; }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body style="height: 100%; margin: 0; font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;" class="bg-slate-50">
  <div class="min-h-full flex flex-col"><!-- Header -->
   <header class="bg-gradient-to-r from-slate-900 to-slate-800 text-white shadow-lg">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
     <div class="flex items-center justify-between">
      <div class="flex items-center space-x-4">
       <div class="bg-white bg-opacity-10 p-3 rounded-lg">
        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
        </svg>
       </div>
       <div>
        <h1 id="tool-title" class="text-3xl font-bold">An√°lisis de Brechas (Gap Analysis)</h1>
        <p class="mt-1 text-slate-300 text-lg"><span id="company-name">Empresa</span> ‚Ä¢ <span id="model-name">Modelo de Calidad</span></p>
        <p id="current-user-info" class="mt-2 text-sm text-blue-200 hidden flex items-center">
         <svg class="w-4 h-4 mr-1" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
         </svg><span id="display-student-name"></span> (<span id="display-user-id"></span>)</p>
       </div>
      </div>
      <div class="flex items-center space-x-4 no-print">
       <div class="text-right">
        <div class="text-sm text-slate-300">
         Total de Elementos
        </div>
        <div class="text-2xl font-bold text-white">
         <span id="total-items">0</span>
        </div>
       </div>
       <div class="flex space-x-3"><button id="export-pdf-btn" class="bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl flex items-center space-x-2">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
         </svg><span>Exportar PDF</span> </button> <button id="add-gap-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl flex items-center space-x-2">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
         </svg><span>Nueva Brecha</span> </button>
       </div>
      </div>
     </div>
    </div>
   </header><!-- Main Content -->
   <main class="flex-1 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><!-- Project Information Card -->
    <div class="bg-white rounded-xl shadow-lg border border-slate-200 mb-8">
     <div class="bg-gradient-to-r from-slate-50 to-slate-100 px-6 py-4 border-b border-slate-200 rounded-t-xl">
      <h2 class="text-xl font-bold text-slate-900 flex items-center">
       <svg class="w-6 h-6 mr-2 text-slate-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
       </svg> Informaci√≥n del Proyecto</h2>
     </div>
     <div class="p-6"><!-- Student Identification -->
      <div id="student-form" class="mb-6">
       <h3 class="text-lg font-semibold text-slate-900 mb-4 flex items-center">
        <svg class="w-5 h-5 mr-2 text-blue-600" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
        </svg> Identificaci√≥n del Analista</h3>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div><label for="student-name" class="block text-sm font-semibold text-slate-700 mb-2"> Nombre Completo del Analista * </label> <input type="text" id="student-name" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-slate-50" placeholder="Ingresa tu nombre completo">
        </div>
        <div><label for="user-id" class="block text-sm font-semibold text-slate-700 mb-2"> ID de Usuario / Matr√≠cula * </label> <input type="text" id="user-id" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-slate-50" placeholder="Ej. EST001, 2024001, etc.">
        </div>
       </div>
       <div class="mt-6 flex items-center justify-between"><button type="button" id="save-identity-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-semibold transition-all duration-200 shadow-lg hover:shadow-xl"> Confirmar Identidad </button>
        <p class="text-sm text-slate-600 max-w-md">
         <svg class="w-4 h-4 inline mr-1 text-amber-500" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
         </svg> Esta informaci√≥n se asociar√° permanentemente con todos tus an√°lisis de brechas.</p>
       </div>
      </div><!-- Project Details -->
      <div class="border-t border-slate-200 pt-6">
       <h3 class="text-lg font-semibold text-slate-900 mb-4 flex items-center">
        <svg class="w-5 h-5 mr-2 text-emerald-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2-2v2m8 0V6a2 2 0 012 2v6a2 2 0 01-2 2H8a2 2 0 01-2-2V8a2 2 0 012-2V6"></path>
        </svg> Detalles del An√°lisis</h3>
       <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="bg-slate-50 p-4 rounded-lg border border-slate-200">
         <div class="text-sm font-medium text-slate-600 mb-1">
          Organizaci√≥n
         </div>
         <div id="company-display" class="text-lg font-semibold text-slate-900">
          Empresa
         </div>
        </div>
        <div class="bg-slate-50 p-4 rounded-lg border border-slate-200">
         <div class="text-sm font-medium text-slate-600 mb-1">
          Marco de Referencia
         </div>
         <div id="model-display" class="text-lg font-semibold text-slate-900">
          Modelo de Calidad
         </div>
        </div>
        <div class="bg-slate-50 p-4 rounded-lg border border-slate-200">
         <div class="text-sm font-medium text-slate-600 mb-1">
          Fecha de An√°lisis
         </div>
         <div id="analysis-date" class="text-lg font-semibold text-slate-900">
          -
         </div>
        </div>
       </div>
      </div>
     </div>
    </div><!-- Executive Summary Dashboard -->
    <div class="bg-white rounded-xl shadow-lg border border-slate-200 mb-8">
     <div class="bg-gradient-to-r from-slate-50 to-slate-100 px-6 py-4 border-b border-slate-200 rounded-t-xl">
      <h2 class="text-xl font-bold text-slate-900 flex items-center">
       <svg class="w-6 h-6 mr-2 text-slate-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
       </svg> Resumen Ejecutivo</h2>
     </div>
     <div class="p-6">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"><!-- Critical Non-Compliance -->
       <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-xl p-6 border border-red-200 shadow-sm">
        <div class="flex items-center justify-between mb-4">
         <div class="p-3 bg-red-500 rounded-lg shadow-lg">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
          </svg>
         </div>
         <div class="text-right">
          <div id="not-compliant-count" class="text-3xl font-bold text-red-700">
           0
          </div>
          <div class="text-sm font-medium text-red-600">
           Elementos
          </div>
         </div>
        </div>
        <div class="text-sm font-semibold text-red-800">
         No Cumplido
        </div>
        <div class="text-xs text-red-600 mt-1">
         Requiere acci√≥n inmediata
        </div>
       </div><!-- Partial Compliance -->
       <div class="bg-gradient-to-br from-amber-50 to-amber-100 rounded-xl p-6 border border-amber-200 shadow-sm">
        <div class="flex items-center justify-between mb-4">
         <div class="p-3 bg-amber-500 rounded-lg shadow-lg">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
         </div>
         <div class="text-right">
          <div id="partial-count" class="text-3xl font-bold text-amber-700">
           0
          </div>
          <div class="text-sm font-medium text-amber-600">
           Elementos
          </div>
         </div>
        </div>
        <div class="text-sm font-semibold text-amber-800">
         Parcialmente Cumplido
        </div>
        <div class="text-xs text-amber-600 mt-1">
         En proceso de mejora
        </div>
       </div><!-- Full Compliance -->
       <div class="bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-xl p-6 border border-emerald-200 shadow-sm">
        <div class="flex items-center justify-between mb-4">
         <div class="p-3 bg-emerald-500 rounded-lg shadow-lg">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
         </div>
         <div class="text-right">
          <div id="compliant-count" class="text-3xl font-bold text-emerald-700">
           0
          </div>
          <div class="text-sm font-medium text-emerald-600">
           Elementos
          </div>
         </div>
        </div>
        <div class="text-sm font-semibold text-emerald-800">
         Cumplido
        </div>
        <div class="text-xs text-emerald-600 mt-1">
         Conforme a est√°ndares
        </div>
       </div><!-- High Priority Items -->
       <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-6 border border-purple-200 shadow-sm">
        <div class="flex items-center justify-between mb-4">
         <div class="p-3 bg-purple-500 rounded-lg shadow-lg">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
          </svg>
         </div>
         <div class="text-right">
          <div id="high-priority-count" class="text-3xl font-bold text-purple-700">
           0
          </div>
          <div class="text-sm font-medium text-purple-600">
           Elementos
          </div>
         </div>
        </div>
        <div class="text-sm font-semibold text-purple-800">
         Alta Prioridad
        </div>
        <div class="text-xs text-purple-600 mt-1">
         Atenci√≥n prioritaria
        </div>
       </div>
      </div><!-- Compliance Progress Bar -->
      <div class="mt-8 p-4 bg-slate-50 rounded-lg border border-slate-200">
       <div class="flex items-center justify-between mb-2"><span class="text-sm font-semibold text-slate-700">Nivel de Cumplimiento General</span> <span id="compliance-percentage" class="text-sm font-bold text-slate-900">0%</span>
       </div>
       <div class="w-full bg-slate-200 rounded-full h-3">
        <div id="compliance-bar" class="bg-gradient-to-r from-emerald-500 to-emerald-600 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
       </div>
       <div class="flex justify-between text-xs text-slate-500 mt-1"><span>0% Cumplimiento</span> <span>100% Cumplimiento</span>
       </div>
      </div>
     </div>
    </div><!-- Gap Analysis Form -->
    <div id="gap-form" class="bg-white rounded-xl shadow-lg border border-slate-200 mb-8 hidden no-print">
     <div class="bg-gradient-to-r from-blue-50 to-blue-100 px-6 py-4 border-b border-slate-200 rounded-t-xl">
      <h3 class="text-xl font-bold text-slate-900 flex items-center">
       <svg class="w-6 h-6 mr-2 text-blue-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"></path>
       </svg><span id="form-title">Nuevo An√°lisis de Brecha</span></h3>
     </div>
     <div class="p-6">
      <form id="gap-analysis-form" class="space-y-6"><!-- Section 1: Requirements and Evidence -->
       <div class="bg-slate-50 rounded-lg p-6 border border-slate-200">
        <h4 class="text-lg font-semibold text-slate-900 mb-4 flex items-center">
         <svg class="w-5 h-5 mr-2 text-slate-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
         </svg> Requisitos y Evidencia</h4>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
         <div><label for="practice-requirement" class="block text-sm font-semibold text-slate-700 mb-2"> Pr√°ctica/Requisito del Marco de Referencia * </label> <textarea id="practice-requirement" rows="4" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm" placeholder="Ej. CMMI REQM 1.1: Gestionar los requisitos del proyecto y sus cambios de manera sistem√°tica"></textarea>
          <div class="text-xs text-slate-500 mt-1">
           Describe el requisito espec√≠fico del modelo de calidad
          </div>
         </div>
         <div><label for="current-evidence" class="block text-sm font-semibold text-slate-700 mb-2"> Evidencia/Pr√°ctica Actual en la Organizaci√≥n * </label> <textarea id="current-evidence" rows="4" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm" placeholder="Ej. Los cambios de requisitos se comunican informalmente por WhatsApp sin documentaci√≥n formal ni proceso de aprobaci√≥n"></textarea>
          <div class="text-xs text-slate-500 mt-1">
           Describe la situaci√≥n actual observada en la organizaci√≥n
          </div>
         </div>
        </div>
       </div><!-- Section 2: Assessment and Priority -->
       <div class="bg-slate-50 rounded-lg p-6 border border-slate-200">
        <h4 class="text-lg font-semibold text-slate-900 mb-4 flex items-center">
         <svg class="w-5 h-5 mr-2 text-slate-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
         </svg> Evaluaci√≥n y Priorizaci√≥n</h4>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
         <div><label for="gap-status" class="block text-sm font-semibold text-slate-700 mb-2"> Estado de Cumplimiento * </label> <select id="gap-status" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm"> <option value="">Seleccionar nivel de cumplimiento</option> <option value="No Cumplido">üî¥ No Cumplido - Ausencia total del requisito</option> <option value="Parcialmente Cumplido">üü° Parcialmente Cumplido - Implementaci√≥n incompleta</option> <option value="Cumplido">üü¢ Cumplido - Conforme al est√°ndar</option> </select>
         </div>
         <div><label for="priority" class="block text-sm font-semibold text-slate-700 mb-2"> Nivel de Prioridad * </label> <select id="priority" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm"> <option value="">Seleccionar prioridad de atenci√≥n</option> <option value="Alta">üî• Alta - Requiere atenci√≥n inmediata</option> <option value="Media">‚ö° Media - Importante para el proceso</option> <option value="Baja">üìã Baja - Mejora recomendada</option> </select>
         </div>
        </div>
       </div><!-- Section 3: Recommendations -->
       <div class="bg-slate-50 rounded-lg p-6 border border-slate-200">
        <h4 class="text-lg font-semibold text-slate-900 mb-4 flex items-center">
         <svg class="w-5 h-5 mr-2 text-slate-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
         </svg> Plan de Acci√≥n Recomendado</h4>
        <div><label for="recommended-actions" class="block text-sm font-semibold text-slate-700 mb-2"> Acciones Correctivas y de Mejora * </label> <textarea id="recommended-actions" rows="4" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm" placeholder="Ej. 1) Dise√±ar e implementar un Formulario de Control de Cambios formal, 2) Establecer flujo de aprobaci√≥n con roles definidos, 3) Capacitar al equipo en el nuevo proceso, 4) Implementar herramienta de seguimiento"></textarea>
         <div class="text-xs text-slate-500 mt-1">
          Detalla las acciones espec√≠ficas necesarias para cerrar la brecha identificada
         </div>
        </div>
       </div><!-- Form Actions -->
       <div class="flex items-center justify-between pt-6 border-t border-slate-200"><button type="button" id="cancel-btn" class="px-6 py-3 text-slate-600 hover:text-slate-800 font-semibold transition-colors"> Cancelar </button> <button type="submit" id="save-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-semibold transition-all duration-200 shadow-lg hover:shadow-xl flex items-center space-x-2">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
         </svg><span>Guardar An√°lisis</span> </button>
       </div>
      </form>
     </div>
    </div><!-- Gap Analysis Table -->
    <div class="bg-white rounded-xl shadow-lg border border-slate-200">
     <div class="bg-gradient-to-r from-slate-50 to-slate-100 px-6 py-4 border-b border-slate-200 rounded-t-xl">
      <h3 class="text-xl font-bold text-slate-900 flex items-center">
       <svg class="w-6 h-6 mr-2 text-slate-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
       </svg> Registro Detallado de Brechas</h3>
     </div>
     <div id="gaps-container" class="divide-y divide-slate-200">
      <div id="empty-state" class="p-16 text-center">
       <div class="w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-slate-100 to-slate-200 rounded-full flex items-center justify-center shadow-inner">
        <svg class="w-10 h-10 text-slate-400" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
        </svg>
       </div>
       <h3 class="text-xl font-semibold text-slate-900 mb-3">Registro de An√°lisis Vac√≠o</h3>
       <p class="text-slate-600 mb-6 max-w-md mx-auto">Para comenzar tu an√°lisis de brechas, primero identif√≠cate como analista y luego agrega tu primera evaluaci√≥n de cumplimiento.</p>
       <div class="space-y-3"><button id="empty-add-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-semibold transition-all duration-200 shadow-lg hover:shadow-xl flex items-center space-x-2 mx-auto">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
         </svg><span>Iniciar Primer An√°lisis</span> </button>
        <p class="text-xs text-slate-500">Los datos se guardar√°n autom√°ticamente en tu Canva Sheet</p>
       </div>
      </div>
     </div>
    </div>
   </main>
  </div><!-- Loading Overlay -->
  <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
   <div class="bg-white rounded-lg p-6 flex items-center space-x-3">
    <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div><span class="text-slate-700">Procesando...</span>
   </div>
  </div>
  <script>
        // Configuration
        const defaultConfig = {
            tool_title: "An√°lisis de Brechas (Gap Analysis)",
            company_name: "Empresa",
            model_name: "Modelo de Calidad"
        };

        let currentGaps = [];
        let allGaps = [];
        let isLoading = false;
        let editingGap = null;
        let currentUser = {
            student_name: '',
            user_id: ''
        };

        // Data handler for SDK
        const dataHandler = {
            onDataChanged(data) {
                allGaps = data || [];
                filterGapsByUser();
                renderGapsList();
                updateSummaryCards();
                updateTotalCount();
            }
        };

        // Initialize SDKs
        async function initializeApp() {
            try {
                if (window.dataSdk) {
                    const result = await window.dataSdk.init(dataHandler);
                    if (!result.isOk) {
                        console.error("Failed to initialize data SDK");
                    }
                }

                if (window.elementSdk) {
                    await window.elementSdk.init({
                        defaultConfig,
                        onConfigChange: async (config) => {
                            document.getElementById('tool-title').textContent = config.tool_title || defaultConfig.tool_title;
                            document.getElementById('company-name').textContent = config.company_name || defaultConfig.company_name;
                            document.getElementById('model-name').textContent = config.model_name || defaultConfig.model_name;
                            
                            // Update project details display
                            document.getElementById('company-display').textContent = config.company_name || defaultConfig.company_name;
                            document.getElementById('model-display').textContent = config.model_name || defaultConfig.model_name;
                            
                            // Update analysis date
                            document.getElementById('analysis-date').textContent = new Date().toLocaleDateString('es-ES', {
                                year: 'numeric',
                                month: 'long',
                                day: 'numeric'
                            });
                        },
                        mapToCapabilities: (config) => ({
                            recolorables: [
                                {
                                    get: () => config.primary_color || "#3b82f6",
                                    set: (value) => {
                                        window.elementSdk.setConfig({ primary_color: value });
                                        updateColors(value);
                                    }
                                }
                            ],
                            borderables: [],
                            fontEditable: undefined,
                            fontSizeable: undefined
                        }),
                        mapToEditPanelValues: (config) => new Map([
                            ["tool_title", config.tool_title || defaultConfig.tool_title],
                            ["company_name", config.company_name || defaultConfig.company_name],
                            ["model_name", config.model_name || defaultConfig.model_name]
                        ])
                    });
                }

                // Load saved user identity
                loadUserIdentity();
            } catch (error) {
                console.error("Initialization error:", error);
            }
        }

        function updateColors(primaryColor) {
            const elements = document.querySelectorAll('.bg-blue-600, .hover\\:bg-blue-700, .focus\\:ring-blue-500, .focus\\:border-blue-500');
            elements.forEach(el => {
                el.style.backgroundColor = primaryColor;
            });
        }

        // User Identity Management
        function loadUserIdentity() {
            const saved = localStorage.getItem('gap_analysis_user');
            if (saved) {
                currentUser = JSON.parse(saved);
                document.getElementById('student-name').value = currentUser.student_name;
                document.getElementById('user-id').value = currentUser.user_id;
                showUserInfo();
                filterGapsByUser();
            }
        }

        function saveUserIdentity() {
            const studentName = document.getElementById('student-name').value.trim();
            const userId = document.getElementById('user-id').value.trim();

            if (!studentName || !userId) {
                showInlineMessage("Por favor completa tu nombre y ID de usuario", "error");
                return;
            }

            currentUser = {
                student_name: studentName,
                user_id: userId
            };

            localStorage.setItem('gap_analysis_user', JSON.stringify(currentUser));
            showUserInfo();
            filterGapsByUser();
            showInlineMessage("Identidad guardada correctamente", "success");
        }

        function showUserInfo() {
            document.getElementById('display-student-name').textContent = currentUser.student_name;
            document.getElementById('display-user-id').textContent = currentUser.user_id;
            document.getElementById('current-user-info').classList.remove('hidden');
        }

        function filterGapsByUser() {
            if (!currentUser.user_id) {
                currentGaps = [];
                return;
            }
            currentGaps = allGaps.filter(gap => gap.user_id === currentUser.user_id);
        }

        // Event listeners
        document.getElementById('save-identity-btn').addEventListener('click', saveUserIdentity);
        document.getElementById('add-gap-btn').addEventListener('click', showGapForm);
        document.getElementById('empty-add-btn').addEventListener('click', showGapForm);
        document.getElementById('cancel-btn').addEventListener('click', hideGapForm);
        document.getElementById('gap-analysis-form').addEventListener('submit', handleFormSubmit);
        document.getElementById('export-pdf-btn').addEventListener('click', exportToPDF);

        function showGapForm() {
            if (!currentUser.user_id) {
                showInlineMessage("Primero debes identificarte como estudiante", "error");
                document.getElementById('student-name').focus();
                return;
            }

            document.getElementById('gap-form').classList.remove('hidden');
            document.getElementById('gap-form').classList.add('fade-in');
            document.getElementById('practice-requirement').focus();
            
            if (!editingGap) {
                document.getElementById('form-title').textContent = 'Nuevo An√°lisis de Brecha';
                clearForm();
            }
        }

        function hideGapForm() {
            document.getElementById('gap-form').classList.add('hidden');
            editingGap = null;
            clearForm();
        }

        function clearForm() {
            document.getElementById('gap-analysis-form').reset();
        }

        async function handleFormSubmit(e) {
            e.preventDefault();
            
            if (isLoading) return;

            if (!currentUser.user_id) {
                showInlineMessage("Primero debes identificarte como estudiante", "error");
                return;
            }

            const formData = {
                practice_requirement: document.getElementById('practice-requirement').value.trim(),
                current_evidence: document.getElementById('current-evidence').value.trim(),
                gap_status: document.getElementById('gap-status').value,
                priority: document.getElementById('priority').value,
                recommended_actions: document.getElementById('recommended-actions').value.trim()
            };

            // Validation
            if (!formData.practice_requirement || !formData.current_evidence || 
                !formData.gap_status || !formData.priority || !formData.recommended_actions) {
                showInlineMessage("Por favor completa todos los campos requeridos", "error");
                return;
            }

            if (allGaps.length >= 999) {
                showInlineMessage("Se ha alcanzado el l√≠mite m√°ximo de 999 elementos. Por favor elimina algunos elementos primero.", "error");
                return;
            }

            setLoading(true);

            try {
                const gapData = {
                    id: editingGap ? editingGap.id : generateId(),
                    user_id: currentUser.user_id,
                    student_name: currentUser.student_name,
                    ...formData,
                    created_at: new Date().toISOString()
                };

                let result;
                if (editingGap) {
                    result = await window.dataSdk.update({ ...gapData, __backendId: editingGap.__backendId });
                } else {
                    result = await window.dataSdk.create(gapData);
                }

                if (result.isOk) {
                    hideGapForm();
                    showInlineMessage(editingGap ? "Brecha actualizada exitosamente" : "Brecha agregada exitosamente", "success");
                } else {
                    showInlineMessage("Error al guardar la brecha. Por favor intenta nuevamente.", "error");
                }
            } catch (error) {
                showInlineMessage("Error al guardar la brecha. Por favor intenta nuevamente.", "error");
            } finally {
                setLoading(false);
            }
        }

        function editGap(gap) {
            editingGap = gap;
            document.getElementById('practice-requirement').value = gap.practice_requirement;
            document.getElementById('current-evidence').value = gap.current_evidence;
            document.getElementById('gap-status').value = gap.gap_status;
            document.getElementById('priority').value = gap.priority;
            document.getElementById('recommended-actions').value = gap.recommended_actions;
            
            // Update form title
            document.getElementById('form-title').textContent = 'Editar An√°lisis de Brecha';
            
            showGapForm();
            document.getElementById('gap-form').scrollIntoView({ behavior: 'smooth' });
        }

        async function deleteGap(gap) {
            if (isLoading) return;

            // Create inline confirmation
            const gapElement = document.querySelector(`[data-gap-id="${gap.id}"]`);
            const deleteBtn = gapElement.querySelector('.delete-btn');
            const originalText = deleteBtn.innerHTML;
            
            deleteBtn.innerHTML = '¬øConfirmar?';
            deleteBtn.classList.add('bg-red-600', 'hover:bg-red-700', 'text-white', 'px-2', 'py-1', 'rounded');
            
            // Add cancel option
            const cancelBtn = document.createElement('button');
            cancelBtn.innerHTML = 'Cancelar';
            cancelBtn.className = 'ml-2 px-3 py-1 text-sm text-slate-600 hover:text-slate-800';
            cancelBtn.onclick = () => {
                deleteBtn.innerHTML = originalText;
                deleteBtn.classList.remove('bg-red-600', 'hover:bg-red-700', 'text-white', 'px-2', 'py-1', 'rounded');
                cancelBtn.remove();
            };
            deleteBtn.parentNode.insertBefore(cancelBtn, deleteBtn.nextSibling);
            
            deleteBtn.onclick = async () => {
                setLoading(true);
                try {
                    const result = await window.dataSdk.delete(gap);
                    if (result.isOk) {
                        showInlineMessage("Brecha eliminada exitosamente", "success");
                    } else {
                        showInlineMessage("Error al eliminar la brecha", "error");
                    }
                } catch (error) {
                    showInlineMessage("Error al eliminar la brecha", "error");
                } finally {
                    setLoading(false);
                }
            };
        }

        // PDF Export Function
        async function exportToPDF() {
            if (!currentUser.user_id) {
                showInlineMessage("Primero debes identificarte como estudiante", "error");
                return;
            }

            if (currentGaps.length === 0) {
                showInlineMessage("No hay an√°lisis de brechas para exportar", "error");
                return;
            }

            setLoading(true);

            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Header
                doc.setFontSize(20);
                doc.text('An√°lisis de Brechas (Gap Analysis)', 20, 30);
                
                doc.setFontSize(12);
                doc.text(`Estudiante: ${currentUser.student_name}`, 20, 45);
                doc.text(`ID: ${currentUser.user_id}`, 20, 55);
                doc.text(`Empresa: ${document.getElementById('company-name').textContent}`, 20, 65);
                doc.text(`Modelo: ${document.getElementById('model-name').textContent}`, 20, 75);
                doc.text(`Fecha: ${new Date().toLocaleDateString('es-ES')}`, 20, 85);
                
                // Summary
                doc.setFontSize(14);
                doc.text('Resumen:', 20, 105);
                doc.setFontSize(10);
                doc.text(`Total de elementos: ${currentGaps.length}`, 20, 115);
                doc.text(`No Cumplido: ${currentGaps.filter(g => g.gap_status === 'No Cumplido').length}`, 20, 125);
                doc.text(`Parcialmente Cumplido: ${currentGaps.filter(g => g.gap_status === 'Parcialmente Cumplido').length}`, 20, 135);
                doc.text(`Cumplido: ${currentGaps.filter(g => g.gap_status === 'Cumplido').length}`, 20, 145);
                doc.text(`Alta Prioridad: ${currentGaps.filter(g => g.priority === 'Alta').length}`, 20, 155);
                
                let yPosition = 175;
                
                // Gaps details
                currentGaps.forEach((gap, index) => {
                    if (yPosition > 250) {
                        doc.addPage();
                        yPosition = 30;
                    }
                    
                    doc.setFontSize(12);
                    doc.text(`${index + 1}. ${gap.practice_requirement}`, 20, yPosition);
                    yPosition += 10;
                    
                    doc.setFontSize(10);
                    doc.text(`Estado: ${gap.gap_status} | Prioridad: ${gap.priority}`, 20, yPosition);
                    yPosition += 8;
                    
                    const evidenceLines = doc.splitTextToSize(`Evidencia: ${gap.current_evidence}`, 170);
                    doc.text(evidenceLines, 20, yPosition);
                    yPosition += evidenceLines.length * 5 + 3;
                    
                    const actionsLines = doc.splitTextToSize(`Acciones: ${gap.recommended_actions}`, 170);
                    doc.text(actionsLines, 20, yPosition);
                    yPosition += actionsLines.length * 5 + 10;
                });
                
                // Generate PDF as blob and open in new tab
                const pdfBlob = doc.output('blob');
                const fileName = `Gap_Analysis_${currentUser.user_id}_${new Date().toISOString().split('T')[0]}.pdf`;
                
                // Create object URL and open in new tab
                const url = URL.createObjectURL(pdfBlob);
                const link = document.createElement('a');
                link.href = url;
                link.target = '_blank';
                link.rel = 'noopener noreferrer';
                link.download = fileName;
                
                // Trigger download by opening in new tab
                window.open(url, '_blank', 'noopener,noreferrer');
                
                // Clean up object URL after a delay
                setTimeout(() => {
                    URL.revokeObjectURL(url);
                }, 1000);
                
                showInlineMessage("PDF generado y abierto en nueva pesta√±a", "success");
            } catch (error) {
                showInlineMessage("Error al generar PDF", "error");
                console.error("PDF export error:", error);
            } finally {
                setLoading(false);
            }
        }

        function renderGapsList() {
            const container = document.getElementById('gaps-container');
            const emptyState = document.getElementById('empty-state');
            
            if (currentGaps.length === 0) {
                emptyState.classList.remove('hidden');
                return;
            }
            
            emptyState.classList.add('hidden');
            
            // Clear existing gaps (except empty state)
            const existingGaps = container.querySelectorAll('.gap-item');
            existingGaps.forEach(item => item.remove());
            
            currentGaps.forEach(gap => {
                const gapElement = createGapElement(gap);
                container.appendChild(gapElement);
            });
        }

        function createGapElement(gap) {
            const div = document.createElement('div');
            div.className = `gap-item p-8 hover:bg-slate-50 transition-all duration-200 priority-${gap.priority.toLowerCase()} border-l-4`;
            div.setAttribute('data-gap-id', gap.id);
            
            const statusColor = getStatusColor(gap.gap_status);
            const priorityColor = getPriorityColor(gap.priority);
            const statusIcon = getStatusIcon(gap.gap_status);
            const priorityIcon = getPriorityIcon(gap.priority);
            
            // Set border color based on priority
            if (gap.priority === 'Alta') {
                div.classList.add('border-l-red-500');
            } else if (gap.priority === 'Media') {
                div.classList.add('border-l-amber-500');
            } else {
                div.classList.add('border-l-emerald-500');
            }
            
            div.innerHTML = `
                <div class="flex items-start justify-between">
                    <div class="flex-1">
                        <!-- Header with Status and Priority -->
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-3">
                                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold ${statusColor}">
                                    ${statusIcon} ${gap.gap_status}
                                </span>
                                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold ${priorityColor}">
                                    ${priorityIcon} ${gap.priority}
                                </span>
                            </div>
                            <div class="text-xs text-slate-500">
                                ${new Date(gap.created_at).toLocaleDateString('es-ES')}
                            </div>
                        </div>
                        
                        <!-- Requirement Title -->
                        <div class="mb-6">
                            <h4 class="text-xl font-bold text-slate-900 mb-2 leading-tight">
                                ${escapeHtml(gap.practice_requirement)}
                            </h4>
                        </div>
                        
                        <!-- Evidence and Actions Grid -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <!-- Current Evidence -->
                            <div class="bg-slate-50 rounded-lg p-6 border border-slate-200">
                                <div class="flex items-center mb-3">
                                    <svg class="w-5 h-5 mr-2 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    <h5 class="text-sm font-bold text-slate-700 uppercase tracking-wide">Situaci√≥n Actual</h5>
                                </div>
                                <p class="text-sm text-slate-700 leading-relaxed">${escapeHtml(gap.current_evidence)}</p>
                            </div>
                            
                            <!-- Recommended Actions -->
                            <div class="bg-blue-50 rounded-lg p-6 border border-blue-200">
                                <div class="flex items-center mb-3">
                                    <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                    </svg>
                                    <h5 class="text-sm font-bold text-blue-700 uppercase tracking-wide">Plan de Acci√≥n</h5>
                                </div>
                                <p class="text-sm text-blue-700 leading-relaxed">${escapeHtml(gap.recommended_actions)}</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="flex flex-col space-y-2 ml-6 no-print">
                        <button onclick="editGap(${JSON.stringify(gap).replace(/"/g, '&quot;')})" 
                            class="bg-blue-100 hover:bg-blue-200 text-blue-700 px-4 py-2 rounded-lg text-sm font-semibold transition-colors flex items-center space-x-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                            <span>Editar</span>
                        </button>
                        <button onclick="deleteGap(${JSON.stringify(gap).replace(/"/g, '&quot;')})" 
                            class="delete-btn bg-red-100 hover:bg-red-200 text-red-700 px-4 py-2 rounded-lg text-sm font-semibold transition-colors flex items-center space-x-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                            <span>Eliminar</span>
                        </button>
                    </div>
                </div>
            `;
            
            return div;
        }

        function getStatusIcon(status) {
            switch (status) {
                case 'Cumplido': return '‚úÖ';
                case 'Parcialmente Cumplido': return '‚ö†Ô∏è';
                case 'No Cumplido': return '‚ùå';
                default: return '‚ùì';
            }
        }

        function getPriorityIcon(priority) {
            switch (priority) {
                case 'Alta': return 'üî•';
                case 'Media': return '‚ö°';
                case 'Baja': return 'üìã';
                default: return 'üìå';
            }
        }

        function getStatusColor(status) {
            switch (status) {
                case 'Cumplido': return 'bg-green-100 text-green-800';
                case 'Parcialmente Cumplido': return 'bg-yellow-100 text-yellow-800';
                case 'No Cumplido': return 'bg-red-100 text-red-800';
                default: return 'bg-slate-100 text-slate-800';
            }
        }

        function getPriorityColor(priority) {
            switch (priority) {
                case 'Alta': return 'bg-red-100 text-red-800';
                case 'Media': return 'bg-yellow-100 text-yellow-800';
                case 'Baja': return 'bg-green-100 text-green-800';
                default: return 'bg-slate-100 text-slate-800';
            }
        }

        function updateSummaryCards() {
            const compliant = currentGaps.filter(g => g.gap_status === 'Cumplido').length;
            const partial = currentGaps.filter(g => g.gap_status === 'Parcialmente Cumplido').length;
            const notCompliant = currentGaps.filter(g => g.gap_status === 'No Cumplido').length;
            const highPriority = currentGaps.filter(g => g.priority === 'Alta').length;
            
            document.getElementById('compliant-count').textContent = compliant;
            document.getElementById('partial-count').textContent = partial;
            document.getElementById('not-compliant-count').textContent = notCompliant;
            document.getElementById('high-priority-count').textContent = highPriority;

            // Update compliance percentage and progress bar
            const total = currentGaps.length;
            if (total > 0) {
                const complianceScore = ((compliant * 100) + (partial * 50)) / total;
                const percentage = Math.round(complianceScore);
                document.getElementById('compliance-percentage').textContent = `${percentage}%`;
                document.getElementById('compliance-bar').style.width = `${percentage}%`;
                
                // Update bar color based on compliance level
                const bar = document.getElementById('compliance-bar');
                if (percentage >= 80) {
                    bar.className = 'bg-gradient-to-r from-emerald-500 to-emerald-600 h-3 rounded-full transition-all duration-500';
                } else if (percentage >= 60) {
                    bar.className = 'bg-gradient-to-r from-amber-500 to-amber-600 h-3 rounded-full transition-all duration-500';
                } else {
                    bar.className = 'bg-gradient-to-r from-red-500 to-red-600 h-3 rounded-full transition-all duration-500';
                }
            } else {
                document.getElementById('compliance-percentage').textContent = '0%';
                document.getElementById('compliance-bar').style.width = '0%';
            }
        }

        function updateTotalCount() {
            document.getElementById('total-items').textContent = currentGaps.length;
        }

        function setLoading(loading) {
            isLoading = loading;
            const overlay = document.getElementById('loading-overlay');
            const saveBtn = document.getElementById('save-btn');
            
            if (loading) {
                overlay.classList.remove('hidden');
                if (saveBtn) {
                    saveBtn.disabled = true;
                    saveBtn.textContent = 'Guardando...';
                }
            } else {
                overlay.classList.add('hidden');
                if (saveBtn) {
                    saveBtn.disabled = false;
                    saveBtn.textContent = 'Guardar';
                }
            }
        }

        function showInlineMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `fixed top-4 right-4 px-4 py-3 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-100 text-green-800 border border-green-200' : 
                'bg-red-100 text-red-800 border border-red-200'
            }`;
            messageDiv.textContent = message;
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 4000);
        }

        function generateId() {
            return 'gap_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Initialize app
        initializeApp();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99643d0956e4b589',t:'MTc2MTc1NzMyMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
