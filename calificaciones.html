<!DOCTYPE html>
<html lang="es" data-layout="global">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistema de Gestión de Calificaciones - Calidad de Software</title>

    <link rel="stylesheet" href="css/layout.css" />
    <link rel="stylesheet" href="css/calificaciones.css" />

    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      /* Se mantiene este estilo base para la fuente, ya que es global */
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap");
      body {
        font-family: "Inter", sans-serif;
      }
    </style>
  </head>
  <body id="calificaciones-root">
    <div class="qs-nav" data-role="main-nav">
      <div class="wrap">
        <div class="qs-brand-shell">
          <div class="qs-brand-region">
            <a class="qs-brand" href="index.html">
              <span class="qs-logo" aria-hidden="true">QS</span>
              <span class="qs-brand-text">
                <span class="qs-title">Calidad de Software</span>
                <span class="qs-subtitle">ITSON</span>
              </span>
            </a>
          </div>
          <button
            class="qs-menu-toggle"
            type="button"
            aria-expanded="false"
            aria-controls="qs-nav-links"
          >
            <span class="qs-menu-icon" aria-hidden="true"></span>
            <span class="sr-only">Abrir menú</span>
          </button>
        </div>
        <div class="qs-links-region">
          <nav
            class="qs-tabs"
            id="qs-nav-links"
            aria-label="Navegación principal"
          >
            <a class="qs-btn" href="materiales.html">Materiales</a>
            <a class="qs-btn" href="asistencia.html">Asistencia</a>
            <a class="qs-btn" href="calificaciones.html">Calificaciones</a>
            <a class="qs-btn teacher-only" href="actividades.html"
              >Actividades</a
            >
            <a class="qs-btn" href="Foro.html">Foro</a>
            <a
              class="qs-btn teacher-only"
              href="paneldocente.html"
              hidden
              aria-hidden="true"
              >Panel</a
            >
          </nav>
        </div>
      </div>
    </div>

    <header class="grades-hero">
    <div class="grades-hero__grid">
      <div class="grades-hero__intro">
        <span class="grades-hero__badge" aria-hidden="true">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.8" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 7v9a2 2 0 002 2h12m0 0l-3.5-4m3.5 4l3.5-4M9 3v4m0 0h6M9 7a3 3 0 01-3 3H4" />
          </svg>
        </span>
        <div>
          <span class="grades-hero__eyebrow">Calidad de Software · Gestión por unidades</span>
          <h1>📊 Sistema de Gestión de Calificaciones</h1>
          <p>Visualiza el desempeño por unidad, registra evidencias y genera reportes en tiempo real.</p>
        </div>
      </div>
      <div class="grades-hero__meta">
        <div class="grades-hero__stat">
          <span>Modo docente</span>
          <span>Activa controles para editar calificaciones y observaciones.</span>
        </div>
        <div class="grades-hero__stat">
          <span>Sincronización</span>
          <span>Compatible con Google Drive para adjuntar evidencias.</span>
        </div>
      </div>
    </div>
    <div class="grades-hero__footer">
      <span class="grades-hero__tag">Unidades 1 a 6</span>
      <span class="grades-hero__tag">Reportes exportables</span>
      <span class="grades-hero__tag">Seguimiento individual</span>
    </div>
  </header>

    <div class="container mx-auto px-6 py-8 teacher-view" style="display: none">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Vista del Docente</h2>
      <div id="student-list-container" class="bg-white rounded-lg card-shadow p-6">
        <h3 class="text-xl font-semibold text-gray-700 mb-4">Lista de Estudiantes</h3>
        </div>
    </div>

    <div
      class="container mx-auto px-6 py-8 student-view"
    >
      <div id="grades-table-container" style="display: none">
        <div class="bg-white rounded-lg card-shadow p-6">
          <h2
            class="text-xl font-semibold text-gray-800 mb-4"
            id="grades-title"
          >
            Mis Calificaciones
          </h2>
          <div class="overflow-x-auto">
            <table class="w-full text-left">
              <thead>
                <tr class="border-b bg-gray-50">
                  <th class="py-3 px-4 font-semibold text-left">
                    Nombre del Estudiante
                  </th>
                  <th class="py-3 px-4 font-semibold text-center">Unidad 1</th>
                  <th class="py-3 px-4 font-semibold text-center">Unidad 2</th>
                  <th class="py-3 px-4 font-semibold text-center">
                    Proyecto Final
                  </th>
                  <th class="py-3 px-4 font-semibold text-center">
                    Calificación Final
                  </th>
                </tr>
              </thead>
              <tbody id="grades-table-body">
                <tr>
                  <td colspan="5" class="text-center py-4">
                    Cargando calificaciones...
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="container mx-auto px-6 py-8">
        <div id="grades-table-container" style="display: none"></div>

        <div
          class="container mx-auto px-4 py-8"
          id="student-uploads-container"
        >
          <div class="student-uploads bg-white rounded-lg card-shadow p-6 mt-8">
            <div class="student-uploads__header">
              <h2 class="text-xl font-semibold text-gray-800 mb-2">
                Desglose de Actividades
              </h2>
              <p class="text-gray-600">
                Este es el listado de todas las actividades y evidencias que has
                subido a la plataforma, junto con las calificaciones asignadas
                por el docente.
              </p>
            </div>
            <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-8">
              <div>
                <div
                  class="student-uploads__records-header"
                  style="
                    padding-bottom: 10px;
                    border-bottom: 1px solid #e2e8f0;
                  "
                >
                  <h3
                    class="student-uploads__records-title"
                    style="font-weight: 600"
                  >
                    Tus Entregas (desde Drive)
                  </h3>
                  <span
                    class="student-uploads__count"
                    data-upload-count="0"
                    style="
                      font-size: 0.9rem;
                      background-color: #f1f5f9;
                      padding: 4px 8px;
                      border-radius: 999px;
                    "
                    >0</span
                  >
                </div>
                <ul
                  id="studentUploadList"
                  class="student-uploads__list"
                  style="margin-top: 1rem"
                ></ul>
                <div
                  id="studentUploadEmpty"
                  class="student-uploads__empty"
                  hidden
                  style="
                    text-align: center;
                    padding: 2rem 1rem;
                    border: 2px dashed #e2e8f0;
                    border-radius: 8px;
                    margin-top: 1rem;
                  "
                >
                  <p>
                    Aún no has realizado ninguna entrega. <br /><a
                      href="index.html"
                      style="color: #4f46e5; text-decoration: underline"
                      >Vuelve al inicio para subir tu primera actividad.</a
                    >
                  </p>
                </div>
              </div>
              <div>
                <div
                  class="teacher-grades__records-header"
                  style="
                    padding-bottom: 10px;
                    border-bottom: 1px solid #e2e8f0;
                  "
                >
                  <h3
                    class="teacher-grades__records-title"
                    style="font-weight: 600"
                  >
                    Calificaciones de Actividades
                  </h3>
                </div>
                <ul
                  id="teacherGradesList"
                  class="teacher-grades__list"
                  style="margin-top: 1rem"
                ></ul>
                <div
                  id="teacherGradesEmpty"
                  class="teacher-grades__empty"
                  hidden
                  style="
                    text-align: center;
                    padding: 2rem 1rem;
                    border: 2px dashed #e2e8f0;
                    border-radius: 8px;
                    margin-top: 1rem;
                  "
                >
                  <p>
                    El docente aún no ha asignado calificaciones para las
                    actividades.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Configuración de Firebase (sin cambios)
      window.firebaseConfig = {
        apiKey: "AIzaSyBDip2OjSOUZrr3iiIle2Klodify9LaLe8",
        authDomain: "calidad-de-software-v2.firebaseapp.com",
        projectId: "calidad-de-software-v2",
        storageBucket: "calidad-de-software-v2.appspot.com",
        messagingSenderId: "220818066383",
        appId: "1:220818066383:web:0c2119f470a5f9711b60ba",
      };
    </script>

    <script type="module" src="js/auth-guard.js"></script>
    <script type="module" src="js/layout.js"></script>
    <script type="module" src="./js/role-gate.js"></script>
    <script type="module" src="js/calificaciones-backend.js"></script>
    <script type="module" src="js/calificaciones-uploads-ui.js"></script>
    <script type="module" src="js/calificaciones-docente.js"></script>
    <script type="module" src="js/calificaciones-docente-vista.js"></script>
    <script type="module" src="js/student-uploads.js"></script>
    <script defer src="js/nav-inject.js"></script>
    <script defer src="js/back-home.js"></script>
  </body>
</html>
