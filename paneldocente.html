<!DOCTYPE html>
<html lang="es" data-layout="global">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Panel del Maestro ¬∑ Calidad de Software</title>
    <link rel="stylesheet" href="./css/layout.css" />
    <script>
      window.firebaseConfig = {
        apiKey: "AIzaSyBDip2OjSOUZrr3iiIle2Klodify9LaLe8",
        authDomain: "calidad-de-software-v2.firebaseapp.com",
        projectId: "calidad-de-software-v2",
        storageBucket: "calidad-de-software-v2.firebasestorage.app",
        messagingSenderId: "220818066383",
        appId: "1:220818066383:web:0c2119f470a5f9711b60ba",
      };
    </script>
    <style>
      :root {
        --pd-shell-width: min(1160px, 94vw);
        --pd-card-bg: rgba(255, 255, 255, 0.92);
        --pd-card-border: rgba(148, 163, 184, 0.35);
        --pd-card-shadow: 0 18px 40px rgba(15, 23, 42, 0.12);
        --pd-muted: #64748b;
        --pd-accent: #2563eb;
        --pd-accent-soft: rgba(37, 99, 235, 0.08);
        --pd-surface: rgba(248, 250, 252, 0.9);
      body {
        color: #0f172a;
      main.pd-shell {
        width: var(--pd-shell-width);
        margin: clamp(36px, 6vw, 72px) auto clamp(96px, 12vw, 140px);
        display: grid;
        gap: clamp(28px, 5vw, 44px);
      .pd-hero {
        display: flex;
        flex-wrap: wrap;
        gap: clamp(18px, 4vw, 32px);
        align-items: flex-start;
        justify-content: space-between;
        padding: clamp(24px, 5vw, 36px);
        border-radius: 28px;
        background: linear-gradient(145deg, rgba(15, 23, 42, 0.92), rgba(30, 64, 175, 0.88));
        color: #e2e8f0;
        box-shadow: 0 28px 60px rgba(15, 23, 42, 0.35);
        overflow: hidden;
      .pd-hero::after {
        content: "";
        position: absolute;
        inset: -25% 45% auto -12%;
        min-height: 320px;
        background: radial-gradient(circle at center, rgba(59, 130, 246, 0.38), transparent 68%);
        filter: blur(48px);
        opacity: 0.7;
      }

      .pd-hero h1 {
        margin: 0;
        font-size: clamp(1.9rem, 5vw, 2.6rem);
        font-weight: 700;
        letter-spacing: -0.02em;
      }

      .pd-hero p {
        margin: 0;
        max-width: 48ch;
        color: rgba(226, 232, 240, 0.88);
        font-size: clamp(1rem, 2.5vw, 1.1rem);
      }

      .pd-chip-row {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: clamp(6px, 2vw, 12px);
      }

      .pd-chip {
        gap: 8px;
        padding: 6px 12px;
        border-radius: 999px;
        background: rgba(15, 23, 42, 0.45);
        border: 1px solid rgba(226, 232, 240, 0.22);
        font-size: 0.85rem;
        font-weight: 500;
      .pd-hero-actions {
        display: flex;
        flex-direction: column;
        gap: 12px;
        min-width: 200px;
      .pd-button {
        display: inline-flex;
        gap: 10px;
        font-weight: 600;
        font-size: 0.95rem;
        border-radius: 999px;
        border: none;
        cursor: pointer;
        padding: 12px 18px;
        transition: transform 0.2s var(--motion-easing), box-shadow 0.2s var(--motion-easing);
      .pd-button.primary {
        color: white;
        background: linear-gradient(135deg, #2563eb, #7c3aed);
        box-shadow: 0 18px 38px rgba(59, 130, 246, 0.35);
      }

      .pd-button.primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 22px 48px rgba(59, 130, 246, 0.4);
      }

      .pd-button.secondary {
        background: rgba(226, 232, 240, 0.16);
        color: #e0e7ff;
        border: 1px solid rgba(148, 163, 184, 0.35);
      }

      .pd-button.secondary:hover {
        transform: translateY(-1px);
        background: rgba(226, 232, 240, 0.22);
      }

      .pd-tabs {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        padding: 6px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.6);
        border: 1px solid rgba(148, 163, 184, 0.25);
        box-shadow: var(--pd-card-shadow);
      }

      .pd-tab {
        appearance: none;
        border: none;
        background: transparent;
        color: var(--pd-muted);
        font-weight: 600;
        padding: 10px 18px;
        border-radius: 999px;
        cursor: pointer;
        transition: background var(--motion-duration) var(--motion-easing),
          color var(--motion-duration) var(--motion-easing);
      }

      .pd-tab[aria-pressed="true"] {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.18), rgba(147, 51, 234, 0.18));
        color: #1d4ed8;
      }

      .pd-tab:focus-visible {
        outline: 3px solid rgba(59, 130, 246, 0.4);
        outline-offset: 2px;
      }

      .pd-panel {
        display: none;
        padding: clamp(24px, 4vw, 32px);
        border-radius: 24px;
        background: var(--pd-card-bg);
        border: 1px solid var(--pd-card-border);
        box-shadow: var(--pd-card-shadow);
      }

      .pd-panel.active {
        display: grid;
        gap: clamp(18px, 3vw, 28px);
      }

      .pd-panel h2 {
        margin: 0;
        font-size: clamp(1.35rem, 3vw, 1.7rem);
      }

      .pd-subtitle {
        margin: 0;
        color: var(--pd-muted);
        font-size: 0.95rem;
      }

      .pd-grid {
        display: grid;
        gap: clamp(16px, 3vw, 24px);
      }

      .pd-grid.cols-4 {
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      }

      .pd-card {
        background: var(--pd-surface);
        border-radius: 22px;
        padding: clamp(18px, 3vw, 24px);
        border: 1px solid rgba(148, 163, 184, 0.25);
        box-shadow: 0 16px 32px rgba(15, 23, 42, 0.08);
        display: grid;
        gap: 6px;
      }

      .pd-card strong {
        font-size: clamp(1.6rem, 4vw, 2rem);
        color: #1d4ed8;
      }

      .pd-card small {
        color: var(--pd-muted);
      .pd-table-wrap {
        overflow-x: auto;
        border-radius: 18px;
        border: 1px solid rgba(148, 163, 184, 0.25);
      }

      table.pd-table {
        width: 100%;
        border-collapse: collapse;
        min-width: 640px;
      table.pd-table th,
      table.pd-table td {
        padding: 14px 16px;
        text-align: left;
        border-bottom: 1px solid rgba(226, 232, 240, 0.8);
        font-size: 0.95rem;
      table.pd-table th {
        background: rgba(241, 245, 249, 0.7);
        font-weight: 600;
        color: #0f172a;
      table.pd-table tbody tr:hover {
        background: rgba(248, 250, 252, 0.7);
      .pd-table .pd-col-select {
        width: 48px;

      .pd-table input[type="checkbox"] {
        width: 18px;
        height: 18px;
      .pd-empty {
        padding: 32px 20px;
        text-align: center;
        color: var(--pd-muted);
        font-style: italic;
      }
      .pd-form {
        display: grid;
        gap: 16px;
        margin-top: 12px;
      }
      .pd-form-row {
        display: grid;
        gap: 16px;
      .pd-form-row.cols-2 {
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      label.pd-field {
        display: grid;
        gap: 6px;
        font-weight: 600;
        color: #0f172a;
      .pd-field input,
      .pd-field textarea,
      .pd-field select {
        padding: 12px 14px;
        border-radius: 14px;
        border: 1px solid rgba(148, 163, 184, 0.35);
        background: rgba(255, 255, 255, 0.9);
        font: inherit;
        resize: vertical;
        transition: border-color var(--motion-duration) var(--motion-easing),
          box-shadow var(--motion-duration) var(--motion-easing);
      .pd-field input:focus,
      .pd-field textarea:focus,
      .pd-field select:focus {
        outline: none;
        border-color: rgba(59, 130, 246, 0.6);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.25);
      textarea#pd-rubric-text {
        min-height: 220px;
      }
      .pd-inline-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        justify-content: flex-end;
      }

      .pd-tag {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 8px 14px;
        border-radius: 999px;
        background: rgba(59, 130, 246, 0.12);
        color: #1d4ed8;
        font-weight: 600;
        font-size: 0.9rem;
      }

      .pd-action-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 6px 12px;
        border-radius: 999px;
        border: 1px solid rgba(59, 130, 246, 0.35);
        background: rgba(59, 130, 246, 0.08);
        color: #1d4ed8;
        font-weight: 600;
        cursor: pointer;
        transition: background var(--motion-duration) var(--motion-easing);
      }

      .pd-action-btn:hover {
        background: rgba(59, 130, 246, 0.16);
      }
      @media (max-width: 920px) {
        .pd-hero {
          border-radius: 24px;
        main.pd-shell {
          margin-top: clamp(28px, 10vw, 48px);
          margin-bottom: clamp(80px, 14vw, 120px);
        .pd-tabs {
          border-radius: 18px;
        }
      @media (max-width: 640px) {
        .pd-hero-actions {
          width: 100%;
          flex-direction: row;
          flex-wrap: wrap;
          justify-content: flex-start;
        }
        .pd-button {
          flex: 1 1 180px;
        }
        table.pd-table {
          min-width: 520px;
        }
    </style>
  </head>
  <body>
    <main id="paneldocente-root" data-grupo="calidad-2025" class="pd-shell">
      <header class="pd-hero">
        <div class="pd-hero-text">
          <h1>Panel del Maestro</h1>
          <p>
            Un tablero integral para monitorear entregas, calificaciones y el avance
            de cada estudiante del grupo.
          </p>
          <div class="pd-chip-row" aria-hidden="true">
            <span class="pd-chip">üìÜ Semana actual <strong id="pd-week-display">‚Äî</strong></span>
            <span class="pd-chip">üßë‚Äçüè´ Docente activo</span>
          </div>
        </div>
        <div class="pd-hero-actions">
          <button id="pd-remind-selected" class="pd-button primary" type="button">
            üìß Enviar recordatorio
          </button>
          <a id="pd-exam-u1-link" class="pd-button secondary" href="#" aria-disabled="true">
            üìò Examen Unidad I
          </a>
          <a id="pd-exam-u2-link" class="pd-button secondary" href="#" aria-disabled="true">
            üìó Examen Unidad II
          </a>
        </div>
      </header>

      <nav class="pd-tabs" aria-label="Secciones del panel">
        <button
          id="tab-btn-overview"
          class="pd-tab"
          type="button"
          data-tab-target="overview"
          aria-controls="tab-overview"
          aria-pressed="true"
        >
          Resumen
        </button>
        <button
          id="tab-btn-deliverables"
          class="pd-tab"
          type="button"
          data-tab-target="deliverables"
          aria-controls="tab-deliverables"
          aria-pressed="false"
        >
          Entregables
        </button>
        <button
          id="tab-btn-evaluations"
          class="pd-tab"
          type="button"
          data-tab-target="evaluations"
          aria-controls="tab-evaluations"
          aria-pressed="false"
        >
          Evaluaciones
        </button>
        <button
          id="tab-btn-rubric"
          class="pd-tab"
          type="button"
          data-tab-target="rubric"
          aria-controls="tab-rubric"
          aria-pressed="false"
        >
          R√∫brica
        </button>
        <button
          id="tab-btn-students"
          class="pd-tab"
          type="button"
          data-tab-target="students"
          aria-controls="tab-students"
          aria-pressed="false"
        >
          Estudiantes
        </button>
        <button
          id="tab-btn-gantt"
          class="pd-tab"
          type="button"
          data-tab-target="gantt"
          aria-controls="tab-gantt"
          aria-pressed="false"
        >
          Cronograma
        </button>
      </nav>

      <section
        id="tab-overview"
        class="pd-panel active"
        role="tabpanel"
        aria-labelledby="tab-btn-overview"
      >
        <div>
          <h2>Resumen general</h2>
          <p class="pd-subtitle">
            Estos indicadores se calculan autom√°ticamente a partir de la informaci√≥n en Firebase.
          </p>
        </div>
        <div class="pd-grid cols-4">
          <article class="pd-card">
            <span class="pd-subtitle">Estudiantes registrados</span>
            <strong id="pd-summary-total-students">0</strong>
          </article>
          <article class="pd-card">
            <span class="pd-subtitle">Promedio final (escala 5)</span>
            <strong id="pd-summary-avg-final">0.0</strong>
          </article>
          <article class="pd-card">
            <span class="pd-subtitle">Entregables activos</span>
            <strong id="pd-summary-active-deliverables">‚Äî</strong>
            <small>Se actualiza al crear o archivar entregables.</small>
          </article>
          <article class="pd-card">
            <span class="pd-subtitle">√öltima sincronizaci√≥n</span>
            <strong id="pd-summary-sync">En curso</strong>
            <small>La informaci√≥n se recarga autom√°ticamente al abrir el panel.</small>
          </article>
        </div>
      </section>

      <section
        id="tab-deliverables"
        class="pd-panel"
        role="tabpanel"
        aria-labelledby="tab-btn-deliverables"
        hidden
      >
        <div>
          <h2>Gesti√≥n de entregables</h2>
          <p class="pd-subtitle">
            Visualiza, edita y crea entregables que alimentan el c√°lculo de calificaciones del curso.
          </p>
        </div>
        <div class="pd-table-wrap" role="region" aria-live="polite">
          <table class="pd-table">
            <thead>
              <tr>
                <th scope="col">T√≠tulo</th>
                <th scope="col">Descripci√≥n</th>
                <th scope="col">Unidad</th>
                <th scope="col">Ponderaci√≥n</th>
                <th scope="col">Entrega</th>
                <th scope="col">Acciones</th>
              </tr>
            </thead>
            <tbody id="pd-deliverables-tbody">
              <tr><td colspan="6" class="pd-empty">Cargando entregables‚Ä¶</td></tr>
            </tbody>
          </table>
        </div>
        <form id="pd-new-deliverable-form" class="pd-form" autocomplete="off">
          <h3>Registrar nuevo entregable</h3>
          <div class="pd-form-row cols-2">
            <label class="pd-field">
              T√≠tulo
              <input id="pd-deliv-title" type="text" name="title" placeholder="Ej. Informe de avances" required />
            </label>
            <label class="pd-field">
              Unidad
              <select id="pd-deliv-unidad" name="unidad">
                <option value="">Selecciona‚Ä¶</option>
                <option value="1">Unidad I</option>
                <option value="2">Unidad II</option>
                <option value="3">Unidad III</option>
              </select>
            </label>
          </div>
          <label class="pd-field">
            Descripci√≥n
            <textarea id="pd-deliv-desc" name="description" placeholder="Objetivo, materiales requeridos o notas adicionales."></textarea>
          </label>
          <div class="pd-form-row cols-2">
            <label class="pd-field">
              Ponderaci√≥n (%)
              <input id="pd-deliv-weight" type="number" min="0" max="100" step="1" name="weight" />
            </label>
            <label class="pd-field">
              Fecha de entrega
              <input id="pd-deliv-due" type="date" name="due" />
            </label>
          </div>
          <div class="pd-inline-actions">
            <button class="pd-button primary" type="submit">Guardar entregable</button>
          </div>
        </form>
      </section>

      <section
        id="tab-evaluations"
        class="pd-panel"
        role="tabpanel"
        aria-labelledby="tab-btn-evaluations"
        hidden
      >
        <div>
          <h2>Evaluaciones del curso</h2>
          <p class="pd-subtitle">
            Los enlaces a ex√°menes se habilitan al registrar la URL correspondiente en la colecci√≥n de Firebase.
          </p>
        </div>
        <div class="pd-grid cols-4">
          <article class="pd-card">
            <span class="pd-subtitle">Examen Unidad I</span>
            <small>El bot√≥n del encabezado apunta al formulario disponible.</small>
          </article>
          <article class="pd-card">
            <span class="pd-subtitle">Examen Unidad II</span>
            <small>Utiliza el bot√≥n del encabezado para abrir el enlace.</small>
          </article>
        </div>
        <div class="pd-table-wrap">
          <table class="pd-table">
            <thead>
              <tr>
                <th scope="col">Asignaci√≥n</th>
                <th scope="col">Unidad</th>
                <th scope="col">Ponderaci√≥n</th>
                <th scope="col">Clave</th>
                <th scope="col">Descripci√≥n</th>
              </tr>
            </thead>
            <tbody id="pd-assignments-tbody">
              <tr><td colspan="5" class="pd-empty">Sin asignaciones registradas.</td></tr>
            </tbody>
          </table>
        </div>
      </section>

      <section
        id="tab-rubric"
        class="pd-panel"
        role="tabpanel"
        aria-labelledby="tab-btn-rubric"
        hidden
      >
        <div>
          <h2>R√∫brica de evaluaci√≥n</h2>
          <p class="pd-subtitle">
            Personaliza la r√∫brica utilizada para evaluar entregables y ex√°menes. Se almacena directamente en Firebase.
          </p>
        </div>
        <label class="pd-field">
          Contenido de la r√∫brica
          <textarea id="pd-rubric-text" name="rubric" placeholder="Define los criterios, niveles de desempe√±o y pesos por unidad."></textarea>
        </label>
        <div class="pd-inline-actions">
          <button id="pd-rubric-save" class="pd-button primary" type="button">Guardar r√∫brica</button>
        </div>
      </section>

      <section
        id="tab-students"
        class="pd-panel"
        role="tabpanel"
        aria-labelledby="tab-btn-students"
        hidden
      >
        <div>
          <h2>Seguimiento de estudiantes</h2>
          <p class="pd-subtitle">
            Consulta los promedios por unidad y selecciona estudiantes para enviar recordatorios personalizados.
          </p>
        </div>
        <div class="pd-table-wrap" role="region" aria-live="polite">
          <table class="pd-table">
            <thead>
              <tr>
                <th scope="col" class="pd-col-select">&nbsp;</th>
                <th scope="col">Nombre</th>
                <th scope="col">Correo</th>
                <th scope="col">Unidad I</th>
                <th scope="col">Unidad II</th>
                <th scope="col">Unidad III</th>
                <th scope="col">Final</th>
              </tr>
            </thead>
            <tbody id="pd-students-tbody">
              <tr><td colspan="7" class="pd-empty">Preparando informaci√≥n de estudiantes‚Ä¶</td></tr>
            </tbody>
          </table>
        </div>
      </section>

      <section
        id="tab-gantt"
        class="pd-panel"
        role="tabpanel"
        aria-labelledby="tab-btn-gantt"
        hidden
      >
        <div>
          <h2>Cronograma de actividades</h2>
          <p class="pd-subtitle">
            Las filas se construyen desde la colecci√≥n <code>gantt</code> del grupo en Firebase.
          </p>
        </div>
        <div class="pd-table-wrap" role="region" aria-live="polite">
          <table class="pd-table">
            <thead>
              <tr>
                <th scope="col">Actividad</th>
                <th scope="col">Inicio</th>
                <th scope="col">Fin</th>
                <th scope="col">Responsable</th>
                <th scope="col">Estado</th>
              </tr>
            </thead>
            <tbody id="pd-gantt-tbody">
              <tr><td colspan="5" class="pd-empty">Sin actividades programadas.</td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const tabs = document.querySelectorAll('.pd-tab');
        const panels = document.querySelectorAll('.pd-panel');
        const weekEl = document.getElementById('pd-week-display');

        if (weekEl) {
          const now = new Date();
          const yearStart = new Date(now.getFullYear(), 0, 1);
          const pastDays = Math.floor((now - yearStart) / 86400000);
          const weekNumber = Math.max(1, Math.ceil((pastDays + yearStart.getDay() + 1) / 7));
          weekEl.textContent = weekNumber;
        }

        function activate(targetId) {
          panels.forEach((panel) => {
            const isActive = panel.id === `tab-${targetId}`;
            panel.classList.toggle('active', isActive);
            panel.hidden = !isActive;
          });
          tabs.forEach((tab) => {
            const isActive = tab.dataset.tabTarget === targetId;
            tab.setAttribute('aria-pressed', isActive ? 'true' : 'false');
        }

        tabs.forEach((tab) => {
          tab.addEventListener('click', () => activate(tab.dataset.tabTarget));
        });

        activate('overview');
      });
    </script>
    <script type="module" src="./js/paneldocente-backend.js"></script>
    <script type="module" src="./js/role-gate.js"></script>
    <script defer src="./js/layout.js"></script>
    <script defer src="js/back-home.js"></script>
    <script defer src="js/nav-inject.js"></script>
  </body>
</html>

              </div>
              <div class="text-center p-4 bg-orange-50 rounded-lg">
                <div class="text-2xl mb-2">üíæ</div>
                <h4 class="font-bold text-orange-600">Equipo 4</h4>
                <p class="text-sm text-gray-600 mb-2">DataFlow Systems (7)</p>
                <div class="text-xl font-bold text-orange-600">86.0</div>
                <div class="text-xs text-gray-500">Promedio</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Gantt Chart Tab -->
      <div id="calendar" class="tab-content">
        <div class="mb-8">
          <h2 class="text-3xl font-bold text-gray-800 mb-4">
            üìä Cronograma Gantt - Proyecto Final
          </h2>
          <p class="text-gray-600 mb-6">
            Visualizaci√≥n temporal de fases, entregas y actividades
          </p>

          <!-- Gantt Controls -->
          <div class="bg-white rounded-xl p-6 shadow-lg mb-8">
            <div class="flex justify-between items-center mb-4">
              <div class="flex items-center space-x-4">
                <h3 class="text-xl font-bold text-gray-800">
                  Octubre - Diciembre 2024
                </h3>
                <div class="text-sm text-gray-600">
                  <span class="font-medium">Semana actual:</span>
                  <span class="text-blue-600 font-bold">12 de 16</span>
                </div>
              </div>
              <div class="flex items-center space-x-2">
                <button
                  onclick="zoomGantt('week')"
                  class="bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-2 rounded-lg text-sm"
                >
                  üìÖ Semanal
                </button>
                <button
                  onclick="zoomGantt('month')"
                  class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-lg text-sm"
                >
                  üìÜ Mensual
                </button>
                <button
                  onclick="exportGantt()"
                  class="bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg text-sm"
                >
                  üìä Exportar
                </button>
              </div>
            </div>

            <!-- Gantt Chart Container -->
            <div class="gantt-container overflow-x-auto">
              <div class="gantt-chart min-w-full">
                <!-- Timeline Header -->
                <div
                  class="gantt-header grid grid-cols-12 gap-1 mb-4 text-xs font-medium text-gray-600"
                >
                  <div class="col-span-3 text-left font-bold text-gray-800">
                    Actividad / Fase
                  </div>
                  <div class="text-center">Oct S4</div>
                  <div class="text-center">Nov S1</div>
                  <div class="text-center">Nov S2</div>
                  <div class="text-center bg-blue-50 text-blue-700 font-bold">
                    Nov S3
                  </div>
                  <div class="text-center">Nov S4</div>
                  <div class="text-center">Dic S1</div>
                  <div class="text-center">Dic S2</div>
                  <div class="text-center">Dic S3</div>
                  <div class="text-center">Dic S4</div>
                </div>

                <!-- Gantt Rows -->
                <div class="gantt-rows space-y-2">
                  <!-- Semana 10: Lanzamiento -->
                  <div
                    class="gantt-row grid grid-cols-12 gap-1 items-center py-2 hover:bg-gray-50 rounded-lg"
                  >
                    <div
                      class="col-span-3 text-sm font-semibold text-green-700"
                    >
                      üöÄ Semana 10: Lanzamiento
                    </div>
                    <div
                      class="gantt-bar bg-green-500 text-white text-xs px-2 py-1 rounded text-center"
                    >
                      ‚úÖ Completado
                    </div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                  </div>

                  <!-- Diagn√≥stico inicial -->
                  <div
                    class="gantt-row grid grid-cols-12 gap-1 items-center py-1 hover:bg-gray-50 rounded-lg ml-4"
                  >
                    <div class="col-span-3 text-xs text-gray-600">
                      üìã Entrega: Diagn√≥stico inicial
                    </div>
                    <div
                      class="gantt-milestone bg-green-600 w-3 h-3 rounded-full mx-auto"
                    ></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                  </div>

                  <!-- Semana 11: Diagn√≥stico detallado -->
                  <div
                    class="gantt-row grid grid-cols-12 gap-1 items-center py-2 hover:bg-gray-50 rounded-lg"
                  >
                    <div
                      class="col-span-3 text-sm font-semibold text-green-700"
                    >
                      üîç Semana 11: Diagn√≥stico detallado
                    </div>
                    <div></div>
                    <div
                      class="gantt-bar bg-green-500 text-white text-xs px-2 py-1 rounded text-center"
                    >
                      ‚úÖ Completado
                    </div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                  </div>

                  <!-- Plan de Pruebas -->
                  <div
                    class="gantt-row grid grid-cols-12 gap-1 items-center py-1 hover:bg-gray-50 rounded-lg ml-4"
                  >
                    <div class="col-span-3 text-xs text-gray-600">
                      üìã Entrega: Plan de Pruebas IEEE
                    </div>
                    <div></div>
                    <div
                      class="gantt-milestone bg-green-600 w-3 h-3 rounded-full mx-auto"
                    ></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                  </div>

                  <!-- Semana 12: Documentaci√≥n -->
                  <div
                    class="gantt-row grid grid-cols-12 gap-1 items-center py-2 hover:bg-gray-50 rounded-lg"
                  >
                    <div
                      class="col-span-3 text-sm font-semibold text-orange-700"
                    >
                      üìö Semana 12: Documentaci√≥n QA
                    </div>
                    <div></div>
                    <div></div>
                    <div
                      class="gantt-bar bg-orange-500 text-white text-xs px-2 py-1 rounded text-center"
                    >
                      üîÑ En progreso
                    </div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                  </div>

                  <!-- Registro de Defectos -->
                  <div
                    class="gantt-row grid grid-cols-12 gap-1 items-center py-1 hover:bg-gray-50 rounded-lg ml-4"
                  >
                    <div class="col-span-3 text-xs text-gray-600">
                      üìã Entrega: Registro de Defectos
                    </div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div
                      class="gantt-milestone bg-red-600 w-3 h-3 rounded-full mx-auto animate-pulse"
                    ></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                  </div>

                  <!-- Semana 13: Gap Analysis -->
                  <div
                    class="gantt-row grid grid-cols-12 gap-1 items-center py-2 hover:bg-gray-50 rounded-lg"
                  >
                    <div class="col-span-3 text-sm font-semibold text-blue-700">
                      üìä Semana 13: Gap Analysis
                    </div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div
                      class="gantt-bar bg-blue-500 text-white text-xs px-2 py-1 rounded text-center"
                    >
                      ‚è≥ Pr√≥ximo
                    </div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                  </div>

                  <!-- Gap Analysis Entrega -->
                  <div
                    class="gantt-row grid grid-cols-12 gap-1 items-center py-1 hover:bg-gray-50 rounded-lg ml-4"
                  >
                    <div class="col-span-3 text-xs text-gray-600">
                      üìã Entrega: Gap Analysis
                    </div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div
                      class="gantt-milestone bg-orange-600 w-3 h-3 rounded-full mx-auto"
                    ></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                  </div>

                  <!-- Semana 14: Roadmap -->
                  <div
                    class="gantt-row grid grid-cols-12 gap-1 items-center py-2 hover:bg-gray-50 rounded-lg"
                  >
                    <div
                      class="col-span-3 text-sm font-semibold text-purple-700"
                    >
                      üó∫Ô∏è Semana 14: Roadmap
                    </div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div
                      class="gantt-bar bg-purple-400 text-white text-xs px-2 py-1 rounded text-center"
                    >
                      ‚è∏Ô∏è Pendiente
                    </div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                  </div>

                  <!-- Roadmap Entrega -->
                  <div
                    class="gantt-row grid grid-cols-12 gap-1 items-center py-1 hover:bg-gray-50 rounded-lg ml-4"
                  >
                    <div class="col-span-3 text-xs text-gray-600">
                      üìã Entrega: Roadmap
                    </div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div
                      class="gantt-milestone bg-purple-600 w-3 h-3 rounded-full mx-auto"
                    ></div>
                    <div></div>
                    <div></div>
                    <div></div>
                  </div>

                  <!-- Semanas 15-16: Presentaciones -->
                  <div
                    class="gantt-row grid grid-cols-12 gap-1 items-center py-2 hover:bg-gray-50 rounded-lg"
                  >
                    <div class="col-span-3 text-sm font-semibold text-red-700">
                      üéØ Semanas 15-16: Presentaciones
                    </div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div
                      class="gantt-bar bg-red-400 text-white text-xs px-1 py-1 rounded text-center"
                    >
                      ‚è∏Ô∏è Pendiente
                    </div>
                    <div
                      class="gantt-bar bg-red-400 text-white text-xs px-1 py-1 rounded text-center"
                    >
                      ‚è∏Ô∏è Pendiente
                    </div>
                    <div></div>
                    <div></div>
                  </div>

                  <!-- Entrega Final -->
                  <div
                    class="gantt-row grid grid-cols-12 gap-1 items-center py-1 hover:bg-gray-50 rounded-lg ml-4"
                  >
                    <div class="col-span-3 text-xs text-gray-600">
                      üìã Entrega Final Integrada
                    </div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div
                      class="gantt-milestone bg-red-600 w-3 h-3 rounded-full mx-auto"
                    ></div>
                    <div></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Gantt Legend -->
            <div
              class="flex justify-center space-x-6 text-sm mt-6 pt-4 border-t"
            >
              <div class="flex items-center space-x-2">
                <div class="w-4 h-2 bg-green-500 rounded"></div>
                <span>Completado</span>
              </div>
              <div class="flex items-center space-x-2">
                <div class="w-4 h-2 bg-orange-500 rounded"></div>
                <span>En progreso</span>
              </div>
              <div class="flex items-center space-x-2">
                <div class="w-4 h-2 bg-blue-500 rounded"></div>
                <span>Pr√≥ximo</span>
              </div>
              <div class="flex items-center space-x-2">
                <div class="w-4 h-2 bg-purple-400 rounded"></div>
                <span>Pendiente</span>
              </div>
              <div class="flex items-center space-x-2">
                <div class="w-3 h-3 bg-red-600 rounded-full"></div>
                <span>Fecha l√≠mite</span>
              </div>
            </div>
          </div>

          <!-- Progress Summary -->
          <div class="grid md:grid-cols-2 gap-6">
            <!-- Overall Progress -->
            <div class="bg-white rounded-xl p-6 shadow-lg">
              <h3 class="text-xl font-bold text-gray-800 mb-4">
                üìà Progreso General del Proyecto
              </h3>
              <div class="space-y-4">
                <div>
                  <div class="flex justify-between mb-2">
                    <span class="text-sm font-medium text-gray-700"
                      >Fases completadas</span
                    >
                    <span class="text-sm text-gray-600">2 de 5 (40%)</span>
                  </div>
                  <div class="progress-bar">
                    <div class="progress-fill" style="width: 40%"></div>
                  </div>
                </div>
                <div>
                  <div class="flex justify-between mb-2">
                    <span class="text-sm font-medium text-gray-700"
                      >Entregas completadas</span
                    >
                    <span class="text-sm text-gray-600">2 de 6 (33%)</span>
                  </div>
                  <div class="progress-bar">
                    <div class="progress-fill" style="width: 33%"></div>
                  </div>
                </div>
                <div>
                  <div class="flex justify-between mb-2">
                    <span class="text-sm font-medium text-gray-700"
                      >Tiempo transcurrido</span
                    >
                    <span class="text-sm text-gray-600"
                      >12 de 16 semanas (75%)</span
                    >
                  </div>
                  <div class="progress-bar">
                    <div class="progress-fill" style="width: 75%"></div>
                  </div>
                </div>
              </div>

              <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                <h4 class="font-semibold text-blue-800 mb-2">
                  ‚ö†Ô∏è Alerta de Cronograma
                </h4>
                <p class="text-sm text-blue-700">
                  El proyecto est√° ligeramente retrasado. Se recomienda acelerar
                  las entregas pendientes para cumplir con las fechas l√≠mite.
                </p>
              </div>
            </div>

            <!-- Critical Path -->
            <div class="bg-white rounded-xl p-6 shadow-lg">
              <h3 class="text-xl font-bold text-gray-800 mb-4">
                üéØ Ruta Cr√≠tica
              </h3>
              <div class="space-y-3">
                <div
                  class="flex items-center justify-between p-3 bg-red-50 rounded-lg border-l-4 border-red-500"
                >
                  <div>
                    <div class="font-semibold text-red-800">
                      Registro de Defectos
                    </div>
                    <div class="text-sm text-red-600">Vence en 2 d√≠as</div>
                  </div>
                  <div class="text-red-600 font-bold">17 Nov</div>
                </div>

                <div
                  class="flex items-center justify-between p-3 bg-orange-50 rounded-lg border-l-4 border-orange-500"
                >
                  <div>
                    <div class="font-semibold text-orange-800">
                      Gap Analysis
                    </div>
                    <div class="text-sm text-orange-600">Vence en 9 d√≠as</div>
                  </div>
                  <div class="text-orange-600 font-bold">24 Nov</div>
                </div>

                <div
                  class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg border-l-4 border-yellow-500"
                >
                  <div>
                    <div class="font-semibold text-yellow-800">Roadmap</div>
                    <div class="text-sm text-yellow-600">Vence en 16 d√≠as</div>
                  </div>
                  <div class="text-yellow-600 font-bold">1 Dic</div>
                </div>

                <div
                  class="flex items-center justify-between p-3 bg-purple-50 rounded-lg border-l-4 border-purple-500"
                >
                  <div>
                    <div class="font-semibold text-purple-800">
                      Presentaciones
                    </div>
                    <div class="text-sm text-purple-600">Vence en 19 d√≠as</div>
                  </div>
                  <div class="text-purple-600 font-bold">4-6 Dic</div>
                </div>
              </div>

              <div class="mt-4 text-center">
                <button
                  onclick="generateReminders()"
                  class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm"
                >
                  üìß Enviar Recordatorios
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    </div>

    <!-- Add Event Modal -->
    <div
      id="add-event-modal"
      class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden"
    >
      <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-xl p-6 w-full max-w-md">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-bold text-gray-800">‚ûï Agregar Evento</h3>
            <button
              onclick="hideAddEventModal()"
              class="text-gray-500 hover:text-gray-700"
            >
              ‚úï
            </button>
          </div>

          <form id="event-form" class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >T√≠tulo del evento:</label
              >
              <input
                type="text"
                id="event-title"
                class="w-full p-3 border border-gray-300 rounded-lg"
                placeholder="Ej: Entrega de proyecto"
                required
              />
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >Fecha:</label
              >
              <input
                type="date"
                id="event-date"
                class="w-full p-3 border border-gray-300 rounded-lg"
                required
              />
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >Tipo de evento:</label
              >
              <select
                id="event-type"
                class="w-full p-3 border border-gray-300 rounded-lg"
              >
                <option value="class">Clase</option>
                <option value="deadline">Fecha l√≠mite</option>
                <option value="exam">Examen</option>
                <option value="special">Evento especial</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >Descripci√≥n (opcional):</label
              >
              <textarea
                id="event-description"
                class="w-full p-3 border border-gray-300 rounded-lg"
                rows="3"
                placeholder="Detalles adicionales..."
              ></textarea>
            </div>

            <div class="flex space-x-3 pt-4">
              <button
                type="submit"
                class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg"
              >
                üíæ Guardar Evento
              </button>
              <button
                type="button"
                onclick="hideAddEventModal()"
                class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-3 rounded-lg"
              >
                Cancelar
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Event Details Modal -->
    <div
      id="event-details-modal"
      class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden"
    >
      <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-xl p-6 w-full max-w-md">
          <div class="flex justify-between items-center mb-4">
            <h3
              class="text-xl font-bold text-gray-800"
              id="event-details-title"
            >
              üìÖ Detalles del Evento
            </h3>
            <button
              onclick="hideEventDetailsModal()"
              class="text-gray-500 hover:text-gray-700"
            >
              ‚úï
            </button>
          </div>

          <div id="event-details-content" class="space-y-3">
            <!-- Event details will be populated here -->
          </div>

          <div class="flex space-x-3 pt-4">
            <button
              onclick="editEvent()"
              class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg text-sm"
            >
              ‚úèÔ∏è Editar
            </button>
            <button
              onclick="deleteEvent()"
              class="flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg text-sm"
            >
              üóëÔ∏è Eliminar
            </button>
            <button
              onclick="hideEventDetailsModal()"
              class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 rounded-lg text-sm"
            >
              Cerrar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Notification Container -->
    <div id="notification-container"></div>

    <script>
      // Calendar and Events Data
      let currentDate = new Date();
      let currentEventId = null;

      // Academic events data - Cronograma detallado del Proyecto Final
      let academicEvents = [
        // Semana 10 - Lanzamiento del Proyecto Final
        {
          id: 1,
          title: "Sesi√≥n 28: Presentaci√≥n del reto",
          date: "2024-10-28",
          type: "class",
          description: "Empresas ficticias: Innovatech, Legacy, GovWare",
        },
        {
          id: 2,
          title: "Sesi√≥n 29: Selecci√≥n de equipos",
          date: "2024-10-30",
          type: "class",
          description: "Selecci√≥n de equipo y empresa caso",
        },
        {
          id: 3,
          title: "Sesi√≥n 30: Explicaci√≥n de fases",
          date: "2024-11-01",
          type: "class",
          description: "R√∫brica y criterios del proyecto",
        },
        {
          id: 4,
          title: "Entrega: Diagn√≥stico inicial",
          date: "2024-11-03",
          type: "deadline",
          description:
            "Documento breve de Diagn√≥stico y selecci√≥n del modelo (ISO, CMMI o MoProSoft)",
        },

        // Semana 11 - Diagn√≥stico detallado y Plan de Pruebas
        {
          id: 5,
          title: "Sesi√≥n 31: Cultura de la calidad",
          date: "2024-11-04",
          type: "class",
          description: "Fundamentos de cultura organizacional de calidad",
        },
        {
          id: 6,
          title: "Sesi√≥n 32: Gur√∫s de la calidad",
          date: "2024-11-06",
          type: "class",
          description: "Deming, Juran, Crosby y sus filosof√≠as",
        },
        {
          id: 7,
          title: "Sesi√≥n 33: Filosof√≠as al software",
          date: "2024-11-08",
          type: "class",
          description:
            "Aplicaci√≥n de filosof√≠as de calidad al desarrollo de software",
        },
        {
          id: 8,
          title: "Entrega: Diagn√≥stico ampliado",
          date: "2024-11-10",
          type: "deadline",
          description:
            "Diagn√≥stico ampliado + Plan de Pruebas (IEEE 829/29119)",
        },

        // Semana 12 - Documentaci√≥n y Gesti√≥n de Defectos
        {
          id: 9,
          title: "Sesi√≥n 34: Documentaci√≥n en QA",
          date: "2024-11-11",
          type: "class",
          description: "Est√°ndares y mejores pr√°cticas de documentaci√≥n",
        },
        {
          id: 10,
          title: "Sesi√≥n 35: Ciclo de vida de defectos",
          date: "2024-11-13",
          type: "class",
          description: "Gesti√≥n completa del ciclo de vida de defectos",
        },
        {
          id: 11,
          title: "Sesi√≥n 36: RCA y m√©tricas",
          date: "2024-11-15",
          type: "class",
          description: "Root Cause Analysis y m√©tricas de defectos",
        },
        {
          id: 12,
          title: "Entrega: Registro de Defectos",
          date: "2024-11-17",
          type: "deadline",
          description:
            "Bug Report con 2+ ejemplos ficticios de la empresa caso",
        },

        // Semana 13 - Gap Analysis
        {
          id: 13,
          title: "Sesi√≥n 37: Introducci√≥n Gap Analysis",
          date: "2024-11-18",
          type: "class",
          description: "Fundamentos del an√°lisis de brechas",
        },
        {
          id: 14,
          title: "Sesi√≥n 38: Gap Analysis en modelos",
          date: "2024-11-20",
          type: "class",
          description: "Aplicaci√≥n en CMMI, ISO, MoProSoft",
        },
        {
          id: 15,
          title: "Sesi√≥n 39: De brechas a acci√≥n",
          date: "2024-11-22",
          type: "class",
          description: "Transformar brechas en plan de acci√≥n",
        },
        {
          id: 16,
          title: "Entrega: Gap Analysis",
          date: "2024-11-24",
          type: "deadline",
          description: "Tabla con 3-5 brechas detectadas y acciones sugeridas",
        },

        // Semana 14 - Roadmap de Implementaci√≥n
        {
          id: 17,
          title: "Sesi√≥n 40: ¬øQu√© es un roadmap?",
          date: "2024-11-25",
          type: "class",
          description: "Conceptos fundamentales de roadmapping",
        },
        {
          id: 18,
          title: "Sesi√≥n 41: Componentes del roadmap",
          date: "2024-11-27",
          type: "class",
          description: "Elementos clave de un roadmap efectivo",
        },
        {
          id: 19,
          title: "Sesi√≥n 42: Roadmap del proyecto",
          date: "2024-11-29",
          type: "class",
          description: "Aplicaci√≥n pr√°ctica al proyecto final",
        },
        {
          id: 20,
          title: "Entrega: Roadmap",
          date: "2024-12-01",
          type: "deadline",
          description: "Cronograma de fases, hitos y responsables",
        },

        // Semanas 15-16 - Exposici√≥n Final
        {
          id: 21,
          title: "Sesi√≥n 43: Preparaci√≥n final",
          date: "2024-12-02",
          type: "class",
          description:
            "Integraci√≥n de documentos y preparaci√≥n de presentaciones",
        },
        {
          id: 22,
          title: "Sesi√≥n 44: Presentaciones D√≠a 1",
          date: "2024-12-04",
          type: "special",
          description:
            "Exposiciones finales - Equipos 1 y 2 (15 min + 5 min Q&A)",
        },
        {
          id: 23,
          title: "Sesi√≥n 45: Presentaciones D√≠a 2",
          date: "2024-12-06",
          type: "special",
          description:
            "Exposiciones finales - Equipos 3 y 4 (15 min + 5 min Q&A)",
        },
        {
          id: 24,
          title: "Entrega Final Integrada",
          date: "2024-12-08",
          type: "deadline",
          description:
            "Documento final: Diagn√≥stico + Gap Analysis + Roadmap + Gesti√≥n del Cambio",
        },
      ];

      // Real student data
      const studentsData = [
        // Equipo 1 - Innovatech Startup (6 estudiantes)
        {
          id: 1,
          name: "Arana Guerrero, Danett Itzanami",
          matricula: "00000249116",
          team: 1,
          teamName: "Innovatech",
          average: 88.5,
          status: "good",
          assignments: [95, 87, 90, 85, 92],
          exams: [82, 79],
        },
        {
          id: 2,
          name: "Araujo Godoy, Abraham Francisco",
          matricula: "00000147818",
          team: 1,
          teamName: "Innovatech",
          average: 86.2,
          status: "good",
          assignments: [88, 85, 87, 82, 89],
          exams: [84, 81],
        },
        {
          id: 3,
          name: "Avalos Morales, Egla Icel",
          matricula: "00000244228",
          team: 1,
          teamName: "Innovatech",
          average: 91.3,
          status: "excellent",
          assignments: [93, 90, 95, 88, 94],
          exams: [89, 87],
        },
        {
          id: 4,
          name: "Blasco Villagomez, Luis Mario",
          matricula: "00000244442",
          team: 1,
          teamName: "Innovatech",
          average: 84.7,
          status: "good",
          assignments: [86, 83, 88, 81, 85],
          exams: [82, 80],
        },
        {
          id: 5,
          name: "Duarte Lopez, Adlemi Guadalupe",
          matricula: "00000244242",
          team: 1,
          teamName: "Innovatech",
          average: 89.1,
          status: "good",
          assignments: [90, 88, 92, 86, 89],
          exams: [87, 85],
        },
        {
          id: 6,
          name: "Espericueta Ramos, Jesus Alan",
          matricula: "00000244473",
          team: 1,
          teamName: "Innovatech",
          average: 87.3,
          status: "good",
          assignments: [89, 85, 90, 83, 88],
          exams: [85, 83],
        },

        // Equipo 2 - Legacy Corp (6 estudiantes)
        {
          id: 7,
          name: "Gracia Morales, Sergio Alejandro",
          matricula: "00000244608",
          team: 2,
          teamName: "Legacy Corp",
          average: 85.9,
          status: "good",
          assignments: [87, 84, 89, 82, 86],
          exams: [83, 81],
        },
        {
          id: 8,
          name: "Hernandez Gonzalez, Julian Ricardo",
          matricula: "00000228847",
          team: 2,
          teamName: "Legacy Corp",
          average: 77.1,
          status: "risk",
          assignments: [75, 78, 80, 72, 76],
          exams: [74, 73],
        },
        {
          id: 9,
          name: "Le Blohic Garay, Mario Enrique",
          matricula: "00000248997",
          team: 2,
          teamName: "Legacy Corp",
          average: 90.2,
          status: "excellent",
          assignments: [92, 89, 93, 87, 91],
          exams: [88, 86],
        },
        {
          id: 10,
          name: "Lopez Guerrero, Luis Carlos",
          matricula: "00000249012",
          team: 2,
          teamName: "Legacy Corp",
          average: 83.6,
          status: "good",
          assignments: [85, 82, 86, 80, 84],
          exams: [81, 79],
        },
        {
          id: 11,
          name: "Maldonado Montoya, Jose Gabriel",
          matricula: "00000248990",
          team: 2,
          teamName: "Legacy Corp",
          average: 86.4,
          status: "good",
          assignments: [88, 85, 89, 83, 87],
          exams: [84, 82],
        },
        {
          id: 12,
          name: "Mart√≠nez Santacruz, Yolanda",
          matricula: "00000244378",
          team: 2,
          teamName: "Legacy Corp",
          average: 88.7,
          status: "good",
          assignments: [90, 87, 91, 85, 89],
          exams: [86, 84],
        },

        // Equipo 3 - GovWare Solutions (6 estudiantes)
        {
          id: 13,
          name: "Mart√≠nez Soto, Dainiz Ra√≠",
          matricula: "00000217812",
          team: 3,
          teamName: "GovWare",
          average: 89.7,
          status: "good",
          assignments: [91, 88, 92, 86, 90],
          exams: [87, 85],
        },
        {
          id: 14,
          name: "Nevescanin Moreno, Angel Stipe",
          matricula: "00000244321",
          team: 3,
          teamName: "GovWare",
          average: 85.2,
          status: "good",
          assignments: [87, 83, 88, 81, 86],
          exams: [83, 81],
        },
        {
          id: 15,
          name: "Osuna Aguilera, Erik David",
          matricula: "00000244477",
          team: 3,
          teamName: "GovWare",
          average: 92.1,
          status: "excellent",
          assignments: [94, 91, 95, 89, 93],
          exams: [90, 88],
        },
        {
          id: 16,
          name: "Palacios Cardenas, Jorge Eduardo",
          matricula: "00000244711",
          team: 3,
          teamName: "GovWare",
          average: 87.8,
          status: "good",
          assignments: [89, 86, 90, 84, 88],
          exams: [85, 83],
        },
        {
          id: 17,
          name: "Preciado Ruiz, Juan Carlos",
          matricula: "00000244569",
          team: 3,
          teamName: "GovWare",
          average: 84.3,
          status: "good",
          assignments: [86, 82, 87, 80, 85],
          exams: [82, 80],
        },
        {
          id: 18,
          name: "Reyes Galaz, Jose Abelardo",
          matricula: "00000244373",
          team: 3,
          teamName: "GovWare",
          average: 88.9,
          status: "good",
          assignments: [90, 87, 91, 85, 89],
          exams: [86, 84],
        },

        // Equipo 4 - DataFlow Systems (7 estudiantes)
        {
          id: 19,
          name: "Rivas Quintana, Emmanuel",
          matricula: "00000240691",
          team: 4,
          teamName: "DataFlow",
          average: 86.5,
          status: "good",
          assignments: [88, 85, 89, 83, 87],
          exams: [84, 82],
        },
        {
          id: 20,
          name: "Rocha Aguilar, V√≠ctor Emmanuel",
          matricula: "00000244266",
          team: 4,
          teamName: "DataFlow",
          average: 79.4,
          status: "risk",
          assignments: [81, 77, 82, 75, 79],
          exams: [76, 74],
        },
        {
          id: 21,
          name: "Rodriguez Alvarado, Jose Agustin",
          matricula: "00000244312",
          team: 4,
          teamName: "DataFlow",
          average: 87.6,
          status: "good",
          assignments: [89, 86, 90, 84, 88],
          exams: [85, 83],
        },
        {
          id: 22,
          name: "Soto Carrazco, Francisco Javier",
          matricula: "00000244621",
          team: 4,
          teamName: "DataFlow",
          average: 83.1,
          status: "good",
          assignments: [85, 81, 86, 79, 84],
          exams: [81, 79],
        },
        {
          id: 23,
          name: "S√°nchez Zavala, Dulce Mar√≠a",
          matricula: "00000216759",
          team: 4,
          teamName: "DataFlow",
          average: 91.8,
          status: "excellent",
          assignments: [93, 90, 94, 88, 92],
          exams: [89, 87],
        },
        {
          id: 24,
          name: "Villegas Sosa, Rams√©s Mauricio",
          matricula: "00000244689",
          team: 4,
          teamName: "DataFlow",
          average: 85.7,
          status: "good",
          assignments: [87, 84, 88, 82, 86],
          exams: [83, 81],
        },
        {
          id: 25,
          name: "Viveros Zavala, Angel Gael",
          matricula: "00000244679",
          team: 4,
          teamName: "DataFlow",
          average: 88.2,
          status: "good",
          assignments: [90, 86, 91, 84, 89],
          exams: [86, 84],
        },
      ];

      let currentTab = "overview";

      function showTab(tabName) {
        // Hide all tabs
        document.querySelectorAll(".tab-content").forEach((tab) => {
          tab.classList.remove("active");
        });

        // Remove active class from all buttons
        document.querySelectorAll(".tab-button").forEach((btn) => {
          btn.classList.remove("active");
        });

        // Show selected tab
        document.getElementById(tabName).classList.add("active");

        // Add active class to clicked button
        event.target.classList.add("active");

        currentTab = tabName;

        // Load tab-specific content
        if (tabName === "students") {
          loadStudents();
        }
      }

      function loadStudents(filteredStudents = null) {
        const container = document.getElementById("students-container");
        container.innerHTML = "";

        const students = filteredStudents || studentsData;

        if (students.length === 0) {
          container.innerHTML = `
                    <div class="col-span-2 text-center py-8">
                        <div class="text-4xl mb-4">üîç</div>
                        <h3 class="text-lg font-semibold text-gray-600 mb-2">No se encontraron estudiantes</h3>
                        <p class="text-gray-500">Intenta ajustar los filtros de b√∫squeda</p>
                    </div>
                `;
          return;
        }

        students.forEach((student) => {
          const statusColor =
            student.status === "excellent"
              ? "green"
              : student.status === "good"
              ? "blue"
              : "red";

          const card = document.createElement("div");
          card.className = "student-card";
          card.innerHTML = `
                    <div class="flex items-center justify-between mb-3">
                        <div>
                            <h3 class="text-lg font-bold text-gray-800">${
                              student.name
                            }</h3>
                            <p class="text-sm text-gray-600">${
                              student.matricula
                            } - ${student.teamName}</p>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-${statusColor}-600">${
            student.average
          }</div>
                            <div class="text-xs text-gray-500">Promedio</div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-3">
                        <div>
                            <div class="text-sm font-medium text-gray-700 mb-1">Asignaciones:</div>
                            <div class="text-sm text-gray-600">${
                              student.assignments.length
                            }/6 completadas</div>
                        </div>
                        <div>
                            <div class="text-sm font-medium text-gray-700 mb-1">Ex√°menes:</div>
                            <div class="text-sm text-gray-600">${
                              student.exams.length
                            }/3 completados</div>
                        </div>
                    </div>
                    
                    <div class="progress-bar mb-3">
                        <div class="progress-fill" style="width: ${
                          (student.average / 100) * 100
                        }%"></div>
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <span class="text-xs px-2 py-1 rounded-full bg-${statusColor}-100 text-${statusColor}-800">
                            ${
                              student.status === "excellent"
                                ? "Excelente"
                                : student.status === "good"
                                ? "Bueno"
                                : "En riesgo"
                            }
                        </span>
                        <button onclick="viewStudentDetail(${
                          student.id
                        })" class="text-blue-600 hover:text-blue-800 text-sm">
                            Ver detalle
                        </button>
                    </div>
                `;

          container.appendChild(card);
        });
      }

      function filterStudents() {
        const searchTerm = document
          .getElementById("student-search")
          .value.toLowerCase();
        const teamFilter = document.getElementById("team-filter").value;
        const statusFilter = document.getElementById("status-filter").value;

        let filtered = studentsData.filter((student) => {
          // Search filter
          const matchesSearch =
            !searchTerm ||
            student.name.toLowerCase().includes(searchTerm) ||
            student.matricula.includes(searchTerm);

          // Team filter
          const matchesTeam =
            !teamFilter || student.team.toString() === teamFilter;

          // Status filter
          const matchesStatus =
            !statusFilter || student.status === statusFilter;

          return matchesSearch && matchesTeam && matchesStatus;
        });

        loadStudents(filtered);
      }

      function calculateRubricGrade() {
        const grades = document.querySelectorAll(".rubric-grade");
        let totalWeightedScore = 0;
        let totalWeight = 0;

        grades.forEach((select) => {
          const grade = parseFloat(select.value);
          const weight = parseFloat(select.dataset.weight);

          if (!isNaN(grade) && !isNaN(weight)) {
            totalWeightedScore += (grade * weight) / 100;
            totalWeight += weight;
          }
        });

        if (totalWeight > 0) {
          const finalGrade = totalWeightedScore;
          document.getElementById("final-grade").textContent =
            finalGrade.toFixed(1);
          document.getElementById("calculated-grade").textContent =
            finalGrade.toFixed(1);
        } else {
          document.getElementById("final-grade").textContent = "--";
          document.getElementById("calculated-grade").textContent = "--";
        }
      }

      function resetRubric() {
        document.querySelectorAll(".rubric-grade").forEach((select) => {
          select.value = "";
        });
        document.getElementById("final-grade").textContent = "--";
        document.getElementById("calculated-grade").textContent = "--";
        document.getElementById("feedback-comments").value = "";
      }

      function addQuickComment(comment) {
        const textarea = document.getElementById("feedback-comments");
        const currentText = textarea.value;
        textarea.value =
          currentText + (currentText ? "\n\n" : "") + comment + ": ";
        textarea.focus();
      }

      function saveRubricGrade() {
        const studentSelect = document.getElementById("student-select");
        const finalGrade = document.getElementById("final-grade").textContent;

        if (!studentSelect.value) {
          showNotification(
            "‚ö†Ô∏è Seleccione un estudiante/equipo primero.",
            "warning"
          );
          return;
        }

        if (finalGrade === "--") {
          showNotification(
            "‚ö†Ô∏è Complete la evaluaci√≥n antes de guardar.",
            "warning"
          );
          return;
        }

        showNotification(
          `‚úÖ Calificaci√≥n guardada para ${
            studentSelect.options[studentSelect.selectedIndex].text
          }: ${finalGrade}`,
          "success"
        );
      }

      function saveComments() {
        const comments = document.getElementById("feedback-comments").value;
        if (!comments.trim()) {
          showNotification(
            "‚ö†Ô∏è Escriba comentarios antes de guardar.",
            "warning"
          );
          return;
        }

        showNotification("‚úÖ Comentarios guardados exitosamente.", "success");
      }

      function exportGrades() {
        showNotification("üìä Exportando calificaciones a Excel...", "info");
        // Simulate export process
        setTimeout(() => {
          showNotification(
            "‚úÖ Archivo de calificaciones descargado.",
            "success"
          );
        }, 2000);
      }

      function viewSubmissions(phase) {
        showNotification(`üìã Abriendo entregas de ${phase}...`, "info");
      }

      function viewAssignment(num) {
        showNotification(
          `üìù Abriendo detalles de Asignaci√≥n ${num}...`,
          "info"
        );
      }

      function viewExamResults(num) {
        showNotification(`üìö Abriendo resultados del Examen ${num}...`, "info");
      }

      function configureExam(num) {
        showNotification(`‚öôÔ∏è Configurando Examen ${num}...`, "info");
      }

      function schedulePresentation() {
        showNotification("üìÖ Abriendo calendario de presentaciones...", "info");
      }

      function viewStudentDetail(id) {
        const student = studentsData.find((s) => s.id === id);
        showNotification(`üë§ Abriendo perfil de ${student.name}...`, "info");
      }

      function showNotification(message, type) {
        const container = document.getElementById("notification-container");
        const notification = document.createElement("div");
        notification.className = `notification notification-${type}`;
        notification.innerHTML = `
                <div class="flex items-center space-x-3">
                    <div class="text-lg">
                        ${
                          type === "success"
                            ? "‚úÖ"
                            : type === "warning"
                            ? "‚ö†Ô∏è"
                            : type === "info"
                            ? "‚ÑπÔ∏è"
                            : "‚ùå"
                        }
                    </div>
                    <div class="text-sm font-medium">${message}</div>
                </div>
            `;

        container.appendChild(notification);

        // Show notification
        setTimeout(() => notification.classList.add("show"), 100);

        // Hide and remove notification
        setTimeout(() => {
          notification.classList.remove("show");
          setTimeout(() => container.removeChild(notification), 300);
        }, 4000);
      }

      // Calendar Functions
      function renderCalendar() {
        const grid = document.getElementById("calendar-grid");
        const monthYear = document.getElementById("calendar-month-year");

        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();

        const monthNames = [
          "Enero",
          "Febrero",
          "Marzo",
          "Abril",
          "Mayo",
          "Junio",
          "Julio",
          "Agosto",
          "Septiembre",
          "Octubre",
          "Noviembre",
          "Diciembre",
        ];

        monthYear.textContent = `${monthNames[month]} ${year}`;

        // Clear existing calendar days (keep headers)
        const headers = grid.querySelectorAll(".text-center.font-semibold");
        grid.innerHTML = "";
        headers.forEach((header) => grid.appendChild(header));

        // Get first day of month and number of days
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const today = new Date();

        // Add empty cells for days before month starts
        for (let i = 0; i < firstDay; i++) {
          const emptyDay = document.createElement("div");
          emptyDay.className = "calendar-day";
          grid.appendChild(emptyDay);
        }

        // Add days of the month
        for (let day = 1; day <= daysInMonth; day++) {
          const dayElement = document.createElement("div");
          dayElement.className = "calendar-day";
          dayElement.textContent = day;

          const currentDateStr = `${year}-${String(month + 1).padStart(
            2,
            "0"
          )}-${String(day).padStart(2, "0")}`;

          // Check if this day has events
          const dayEvents = academicEvents.filter(
            (event) => event.date === currentDateStr
          );

          if (dayEvents.length > 0) {
            const event = dayEvents[0]; // Show first event's type
            switch (event.type) {
              case "deadline":
                dayElement.classList.add("deadline");
                break;
              case "exam":
                dayElement.classList.add("has-event");
                dayElement.style.backgroundColor = "#e9d5ff";
                dayElement.style.color = "#7c3aed";
                break;
              case "class":
                dayElement.classList.add("has-event");
                break;
              case "special":
                dayElement.style.backgroundColor = "#dcfce7";
                dayElement.style.color = "#16a34a";
                break;
            }

            dayElement.style.cursor = "pointer";
            dayElement.onclick = () => showEventDetails(currentDateStr);
          }

          // Highlight today
          if (
            year === today.getFullYear() &&
            month === today.getMonth() &&
            day === today.getDate()
          ) {
            dayElement.style.backgroundColor = "#3b82f6";
            dayElement.style.color = "white";
            dayElement.style.fontWeight = "bold";
          }

          grid.appendChild(dayElement);
        }
      }

      function changeMonth(direction) {
        currentDate.setMonth(currentDate.getMonth() + direction);
        renderCalendar();
      }

      function goToToday() {
        currentDate = new Date();
        renderCalendar();
      }

      function showEventDetails(dateStr) {
        const events = academicEvents.filter((event) => event.date === dateStr);
        if (events.length === 0) return;

        const modal = document.getElementById("event-details-modal");
        const content = document.getElementById("event-details-content");

        content.innerHTML = "";

        events.forEach((event) => {
          const eventDiv = document.createElement("div");
          eventDiv.className = "p-3 bg-gray-50 rounded-lg";

          const typeEmoji = {
            class: "üìö",
            deadline: "‚è∞",
            exam: "üìù",
            special: "üéØ",
          };

          const typeColor = {
            class: "blue",
            deadline: "red",
            exam: "purple",
            special: "green",
          };

          eventDiv.innerHTML = `
                    <div class="flex items-center space-x-2 mb-2">
                        <span class="text-lg">${typeEmoji[event.type]}</span>
                        <h4 class="font-semibold text-${
                          typeColor[event.type]
                        }-600">${event.title}</h4>
                    </div>
                    <p class="text-sm text-gray-600 mb-1"><strong>Fecha:</strong> ${formatDate(
                      event.date
                    )}</p>
                    <p class="text-sm text-gray-600">${event.description}</p>
                    <div class="mt-2 flex space-x-2">
                        <button onclick="editEventById(${
                          event.id
                        })" class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded">Editar</button>
                        <button onclick="deleteEventById(${
                          event.id
                        })" class="text-xs bg-red-100 text-red-700 px-2 py-1 rounded">Eliminar</button>
                    </div>
                `;

          content.appendChild(eventDiv);
        });

        modal.classList.remove("hidden");
      }

      function formatDate(dateStr) {
        const date = new Date(dateStr);
        const options = {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
        };
        return date.toLocaleDateString("es-ES", options);
      }

      function showAddEventModal() {
        document.getElementById("add-event-modal").classList.remove("hidden");
        document.getElementById("event-date").value = "";
        document.getElementById("event-title").value = "";
        document.getElementById("event-description").value = "";
        document.getElementById("event-type").value = "class";
      }

      function hideAddEventModal() {
        document.getElementById("add-event-modal").classList.add("hidden");
      }

      function hideEventDetailsModal() {
        document.getElementById("event-details-modal").classList.add("hidden");
      }

      function addEvent(event) {
        event.preventDefault();

        const title = document.getElementById("event-title").value;
        const date = document.getElementById("event-date").value;
        const type = document.getElementById("event-type").value;
        const description = document.getElementById("event-description").value;

        if (!title || !date) {
          showNotification(
            "‚ö†Ô∏è Complete todos los campos requeridos.",
            "warning"
          );
          return;
        }

        const newEvent = {
          id: Math.max(...academicEvents.map((e) => e.id)) + 1,
          title,
          date,
          type,
          description: description || `Evento: ${title}`,
        };

        academicEvents.push(newEvent);
        renderCalendar();
        hideAddEventModal();

        showNotification(
          `‚úÖ Evento "${title}" agregado exitosamente.`,
          "success"
        );
      }

      function editEventById(id) {
        currentEventId = id;
        const event = academicEvents.find((e) => e.id === id);

        document.getElementById("event-title").value = event.title;
        document.getElementById("event-date").value = event.date;
        document.getElementById("event-type").value = event.type;
        document.getElementById("event-description").value = event.description;

        hideEventDetailsModal();
        showAddEventModal();
      }

      function deleteEventById(id) {
        if (confirm("¬øEst√° seguro de que desea eliminar este evento?")) {
          academicEvents = academicEvents.filter((e) => e.id !== id);
          renderCalendar();
          hideEventDetailsModal();
          showNotification("üóëÔ∏è Evento eliminado exitosamente.", "success");
        }
      }

      function editEvent() {
        // This function is called from the event details modal
        showNotification(
          "‚úèÔ∏è Funci√≥n de edici√≥n disponible desde los detalles del evento.",
          "info"
        );
      }

      function deleteEvent() {
        // This function is called from the event details modal
        showNotification(
          "üóëÔ∏è Seleccione un evento espec√≠fico para eliminar.",
          "info"
        );
      }

      // Gantt Chart Functions
      function zoomGantt(level) {
        if (level === "week") {
          showNotification(
            "üìÖ Vista semanal activada - Mostrando detalles por semana",
            "info"
          );
        } else if (level === "month") {
          showNotification(
            "üìÜ Vista mensual activada - Mostrando resumen por mes",
            "info"
          );
        }
      }

      function exportGantt() {
        showNotification("üìä Exportando cronograma Gantt a PDF...", "info");
        setTimeout(() => {
          showNotification(
            "‚úÖ Cronograma Gantt exportado exitosamente",
            "success"
          );
        }, 2000);
      }

      function generateReminders() {
        showNotification(
          "üìß Enviando recordatorios autom√°ticos a todos los equipos...",
          "info"
        );
        setTimeout(() => {
          showNotification(
            "‚úÖ Recordatorios enviados a 25 estudiantes (4 equipos)",
            "success"
          );
        }, 2500);
      }

      // Event listeners
      document.addEventListener("DOMContentLoaded", () => {
        // Add event listeners for rubric calculation
        document.querySelectorAll(".rubric-grade").forEach((select) => {
          select.addEventListener("change", calculateRubricGrade);
        });

        // Add event listeners for student filters
        document
          .getElementById("student-search")
          .addEventListener("input", filterStudents);
        document
          .getElementById("team-filter")
          .addEventListener("change", filterStudents);
        document
          .getElementById("status-filter")
          .addEventListener("change", filterStudents);

        // Add event form listener
        document
          .getElementById("event-form")
          .addEventListener("submit", addEvent);

        // Load initial content
        loadStudents();
        renderCalendar();

        // Show welcome notification
        setTimeout(() => {
          showNotification(
            "üëã Bienvenido al Panel del Maestro. Semana 8 de 15 en progreso.",
            "info"
          );
        }, 1000);
      });
    </script>
    <script>
      (function () {
        function c() {
          var b = a.contentDocument || a.contentWindow.document;
          if (b) {
            var d = b.createElement("script");
            d.innerHTML =
              "window.__CF$cv$params={r:'97f37ad032d10fb3',t:'MTc1Nzg5MDYwOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
            b.getElementsByTagName("head")[0].appendChild(d);
          }
        }
        if (document.body) {
          var a = document.createElement("iframe");
          a.height = 1;
          a.width = 1;
          a.style.position = "absolute";
          a.style.top = 0;
          a.style.left = 0;
          a.style.border = "none";
          a.style.visibility = "hidden";
          document.body.appendChild(a);
          if ("loading" !== document.readyState) c();
          else if (window.addEventListener)
            document.addEventListener("DOMContentLoaded", c);
          else {
            var e = document.onreadystatechange || function () {};
            document.onreadystatechange = function (b) {
              e(b);
              "loading" !== document.readyState &&
                ((document.onreadystatechange = e), c());
            };
          }
        }
      })();
    </script>
    <script type="module" src="./js/paneldocente-backend.js"></script>
    <script type="module" src="./js/role-gate.js"></script>
    <!-- Protecci√≥n adicional: oculta este panel a usuarios que no sean docentes. -->
    <script type="module">
      (async () => {
        // Importar las utilidades de Firebase sin filtrar por dominio.  Se
        // utiliza la misma versi√≥n de firebase.js que el resto del proyecto.
        const { onAuth, isTeacherEmail, isTeacherByDoc } = await import('./js/firebase.js');
        onAuth(async (user) => {
          if (!user) {
            // Sin sesi√≥n: redirige a login
            window.location.href = 'login.html';
            return;
          }
          // Verificar si el correo pertenece al listado de docentes o si
          // existe un documento de profesor en Firestore.  Si el usuario no
          // cumple ninguna de estas condiciones, redirige a la portada.
          let isDoc = false;
          try {
            isDoc = (await isTeacherByDoc(user.uid)) || false;
          } catch (_) {}
          if (!isTeacherEmail(user.email) && !isDoc) {
            window.location.href = 'index.html';
          }
        });
      })().catch(console.error);
    </script>
    <script defer src="./js/layout.js"></script>
    <script defer src="js/back-home.js"></script>
    <script defer src="js/nav-inject.js"></script>
  </body>
</html>