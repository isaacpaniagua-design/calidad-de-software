<!doctype html>
<html lang="es">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reporte de Defectos IEEE 829</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .ieee-header {
            background: linear-gradient(135deg, #dc2626 0%, #ef4444 50%, #f87171 100%);
            border-bottom: 4px solid #b91c1c;
        }
        .bug-card {
            transition: all 0.2s ease;
            border-left: 4px solid #e5e7eb;
        }
        .bug-card.new {
            border-left-color: #3b82f6;
        }
        .bug-card.assigned {
            border-left-color: #f59e0b;
        }
        .bug-card.in-progress {
            border-left-color: #8b5cf6;
        }
        .bug-card.resolved {
            border-left-color: #10b981;
        }
        .bug-card.closed {
            border-left-color: #6b7280;
        }
        .bug-card.reopened {
            border-left-color: #ef4444;
        }
        .bug-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .formal-section {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
        }
        .ieee-standard {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border: 2px solid #fca5a5;
        }
        .loading-spinner {
            border: 2px solid #f3f4f6;
            border-top: 2px solid #dc2626;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .status-badge {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 4px 8px;
            border-radius: 4px;
        }
        .status-new {
            background: #dbeafe;
            color: #1d4ed8;
        }
        .status-assigned {
            background: #fef3c7;
            color: #d97706;
        }
        .status-in-progress {
            background: #ede9fe;
            color: #7c3aed;
        }
        .status-resolved {
            background: #d1fae5;
            color: #065f46;
        }
        .status-closed {
            background: #f3f4f6;
            color: #374151;
        }
        .status-reopened {
            background: #fee2e2;
            color: #dc2626;
        }
        .severity-critical {
            background: #fee2e2;
            color: #dc2626;
            border: 1px solid #fca5a5;
        }
        .severity-high {
            background: #fef3c7;
            color: #d97706;
            border: 1px solid #fde68a;
        }
        .severity-medium {
            background: #dbeafe;
            color: #1d4ed8;
            border: 1px solid #bfdbfe;
        }
        .severity-low {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }
        .priority-urgent {
            background: #fee2e2;
            color: #dc2626;
        }
        .priority-high {
            background: #fef3c7;
            color: #d97706;
        }
        .priority-medium {
            background: #dbeafe;
            color: #1d4ed8;
        }
        .priority-low {
            background: #d1fae5;
            color: #065f46;
        }
        .formal-button {
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: 13px;
            border: 1px solid transparent;
            transition: all 0.2s ease;
        }
        .formal-input {
            border: 1px solid #d1d5db;
            font-size: 14px;
            transition: border-color 0.2s ease;
        }
        .formal-input:focus {
            border-color: #dc2626;
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
        }
        .template-section {
            background: #fef2f2;
            border: 1px solid #fca5a5;
        }
        .attachment-zone {
            border: 2px dashed #d1d5db;
            background: #f9fafb;
            transition: all 0.2s ease;
        }
        .attachment-zone:hover {
            border-color: #dc2626;
            background: #fef2f2;
        }
        .comparison-section {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #bae6fd;
        }
        .actual-result {
            background: #fef2f2;
            border: 1px solid #fca5a5;
        }
        .expected-result {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="min-h-full bg-gray-50"><!-- IEEE 829 Header -->
  <header class="ieee-header text-white py-8 mb-8">
   <div class="container mx-auto px-6">
    <div class="text-center">
     <div class="flex justify-center items-center gap-3 mb-2"><span class="text-3xl">üêõ</span>
      <h1 class="text-4xl font-bold">Reporte de Defectos IEEE 829</h1>
     </div>
     <div class="flex justify-center items-center gap-6 text-lg mb-4 opacity-90"><span>Proyecto: <span id="project-name-display" class="font-semibold cursor-pointer hover:bg-red-600 px-2 py-1 rounded transition-colors" title="Click para editar">Sistema de Gesti√≥n</span> <input type="text" id="project-name-input" class="font-semibold bg-red-600 border border-red-400 rounded px-2 py-1 text-white placeholder-red-200 hidden" placeholder="Nombre del Proyecto"> </span> <span class="text-red-200">|</span> <span>Versi√≥n: <span id="version-display" class="font-semibold cursor-pointer hover:bg-red-600 px-2 py-1 rounded transition-colors" title="Click para editar">v1.0.0</span> <input type="text" id="version-input" class="font-semibold bg-red-600 border border-red-400 rounded px-2 py-1 text-white placeholder-red-200 hidden" placeholder="v1.0.0"> </span> <span class="text-red-200">|</span> <span>QA Manager: <span id="qa-manager-display" class="font-semibold cursor-pointer hover:bg-red-600 px-2 py-1 rounded transition-colors" title="Click para editar">Responsable de QA</span> <input type="text" id="qa-manager-input" class="font-semibold bg-red-600 border border-red-400 rounded px-2 py-1 text-white placeholder-red-200 hidden" placeholder="Nombre del QA Manager"> </span>
     </div>
     <div class="text-red-100 mb-4"><span id="organization" class="font-medium">Organizaci√≥n</span> ‚Ä¢ <span>Fecha: <span id="current-date"></span></span>
     </div>
     <p class="text-red-100 max-w-4xl mx-auto text-lg leading-relaxed">Sistema de gesti√≥n de defectos siguiendo el est√°ndar IEEE 829. Documenta fallos cuando los resultados esperados no coinciden con los resultados actuales.</p>
    </div>
   </div>
  </header>
  <main class="container mx-auto px-6 pb-12"><!-- Quick Templates Section -->
   <section class="template-section rounded-lg p-6 mb-8">
    <div class="border-b border-red-200 pb-4 mb-6">
     <h2 class="text-2xl font-semibold text-gray-800">Plantillas de Defectos Comunes</h2>
     <p class="text-gray-600 mt-1">Reportes predefinidos para tipos de errores frecuentes</p>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"><button class="template-btn bg-red-600 hover:bg-red-700 text-white p-4 rounded-lg text-left transition-colors" data-template="auth-error">
      <div class="font-semibold mb-1">
       üîê Error de Autenticaci√≥n
      </div>
      <div class="text-sm opacity-90">
       Fallo en login con credenciales v√°lidas
      </div></button> <button class="template-btn bg-orange-600 hover:bg-orange-700 text-white p-4 rounded-lg text-left transition-colors" data-template="form-validation">
      <div class="font-semibold mb-1">
       üìù Validaci√≥n de Formulario
      </div>
      <div class="text-sm opacity-90">
       Error en validaci√≥n de campos
      </div></button> <button class="template-btn bg-purple-600 hover:bg-purple-700 text-white p-4 rounded-lg text-left transition-colors" data-template="ui-display">
      <div class="font-semibold mb-1">
       üé® Error de Interfaz
      </div>
      <div class="text-sm opacity-90">
       Problema de visualizaci√≥n o layout
      </div></button> <button class="template-btn bg-blue-600 hover:bg-blue-700 text-white p-4 rounded-lg text-left transition-colors" data-template="data-loss">
      <div class="font-semibold mb-1">
       üíæ P√©rdida de Datos
      </div>
      <div class="text-sm opacity-90">
       Datos no se guardan correctamente
      </div></button> <button class="template-btn bg-green-600 hover:bg-green-700 text-white p-4 rounded-lg text-left transition-colors" data-template="performance">
      <div class="font-semibold mb-1">
       ‚ö° Problema de Rendimiento
      </div>
      <div class="text-sm opacity-90">
       Lentitud o timeout en operaciones
      </div></button> <button class="template-btn bg-indigo-600 hover:bg-indigo-700 text-white p-4 rounded-lg text-left transition-colors" data-template="navigation">
      <div class="font-semibold mb-1">
       üß≠ Error de Navegaci√≥n
      </div>
      <div class="text-sm opacity-90">
       Enlaces rotos o redirecciones incorrectas
      </div></button>
    </div>
   </section><!-- Bug Report Form -->
   <section class="formal-section rounded-lg p-8 mb-8">
    <div class="border-b border-gray-200 pb-4 mb-6">
     <h2 class="text-2xl font-semibold text-gray-800">Crear Reporte de Defecto</h2>
     <p class="text-gray-600 mt-1">Complete todos los campos para documentar el defecto encontrado</p>
    </div>
    <form id="bug-report-form" class="space-y-6">
     <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <div><label for="bug-id" class="block text-sm font-semibold text-gray-700 mb-2">ID del Defecto *</label> <input type="text" id="bug-id" class="formal-input w-full px-4 py-3 rounded-md focus:outline-none" placeholder="Ej. BUG-001" required>
       <p class="text-xs text-gray-500 mt-1">Formato: BUG-[N√öMERO]</p>
      </div>
      <div><label for="test-case-id" class="block text-sm font-semibold text-gray-700 mb-2">Caso de Prueba Asociado</label> <input type="text" id="test-case-id" class="formal-input w-full px-4 py-3 rounded-md focus:outline-none" placeholder="Ej. CP-LOGIN-001">
       <p class="text-xs text-gray-500 mt-1">ID del caso que fall√≥</p>
      </div>
      <div><label for="bug-category" class="block text-sm font-semibold text-gray-700 mb-2">Categor√≠a *</label> <select id="bug-category" class="formal-input w-full px-4 py-3 rounded-md focus:outline-none" required> <option value="">Seleccionar categor√≠a</option> <option value="funcional">Funcional</option> <option value="interfaz">Interfaz de Usuario</option> <option value="rendimiento">Rendimiento</option> <option value="seguridad">Seguridad</option> <option value="compatibilidad">Compatibilidad</option> <option value="usabilidad">Usabilidad</option> <option value="datos">Integridad de Datos</option> <option value="configuracion">Configuraci√≥n</option> </select>
      </div>
     </div>
     <div><label for="bug-title" class="block text-sm font-semibold text-gray-700 mb-2">T√≠tulo del Defecto *</label> <input type="text" id="bug-title" class="formal-input w-full px-4 py-3 rounded-md focus:outline-none" placeholder="Ej. Error de autenticaci√≥n al usar credenciales v√°lidas" required>
      <p class="text-xs text-gray-500 mt-1">Descripci√≥n clara y concisa del problema</p>
     </div>
     <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <div><label for="bug-severity" class="block text-sm font-semibold text-gray-700 mb-2">Severidad *</label> <select id="bug-severity" class="formal-input w-full px-4 py-3 rounded-md focus:outline-none" required> <option value="critical">Cr√≠tica - Sistema no funciona</option> <option value="high">Alta - Funcionalidad principal afectada</option> <option value="medium" selected>Media - Funcionalidad secundaria afectada</option> <option value="low">Baja - Problema menor o cosm√©tico</option> </select>
      </div>
      <div><label for="bug-priority" class="block text-sm font-semibold text-gray-700 mb-2">Prioridad *</label> <select id="bug-priority" class="formal-input w-full px-4 py-3 rounded-md focus:outline-none" required> <option value="urgent">Urgente - Arreglar inmediatamente</option> <option value="high">Alta - Arreglar en esta iteraci√≥n</option> <option value="medium" selected>Media - Arreglar en pr√≥xima iteraci√≥n</option> <option value="low">Baja - Arreglar cuando sea posible</option> </select>
      </div>
     </div>
     <div><label for="steps-to-reproduce" class="block text-sm font-semibold text-gray-700 mb-2">Pasos para Reproducir *</label> <textarea id="steps-to-reproduce" rows="5" class="formal-input w-full px-4 py-3 rounded-md focus:outline-none" placeholder="1. Abrir navegador en app.com/login
2. Ingresar 'test@itson.edu.mx' en el campo 'usuario'
3. Ingresar 'Pass123' en 'contrase√±a'
4. Hacer clic en 'Ingresar'" required></textarea>
      <p class="text-xs text-gray-500 mt-1">Pasos detallados para reproducir el error</p>
     </div>
     <div class="comparison-section rounded-lg p-6">
      <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"><span class="text-xl">‚öñÔ∏è</span> Comparaci√≥n de Resultados</h3>
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
       <div class="actual-result rounded-lg p-4"><label for="actual-result" class="block text-sm font-semibold text-red-700 mb-2"> ‚ùå Resultado Actual * </label> <textarea id="actual-result" rows="4" class="formal-input w-full px-4 py-3 rounded-md focus:outline-none border-red-300" placeholder="Ej. El sistema muestra el mensaje 'Usuario o contrase√±a inv√°lido' y no permite el acceso." required></textarea>
        <p class="text-xs text-red-600 mt-1">Lo que realmente sucede</p>
       </div>
       <div class="expected-result rounded-lg p-4"><label for="expected-result" class="block text-sm font-semibold text-green-700 mb-2"> ‚úÖ Resultado Esperado * </label> <textarea id="expected-result" rows="4" class="formal-input w-full px-4 py-3 rounded-md focus:outline-none border-green-300" placeholder="Ej. El sistema deb√≠a permitir el acceso al Dashboard." required></textarea>
        <p class="text-xs text-green-600 mt-1">Lo que deber√≠a suceder</p>
       </div>
      </div>
     </div>
     <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <div><label for="environment" class="block text-sm font-semibold text-gray-700 mb-2">Entorno de Prueba</label> <input type="text" id="environment" class="formal-input w-full px-4 py-3 rounded-md focus:outline-none" placeholder="Ej. Windows 10, Chrome 120, Staging">
       <p class="text-xs text-gray-500 mt-1">SO, navegador, ambiente</p>
      </div>
      <div><label for="reporter" class="block text-sm font-semibold text-gray-700 mb-2">Reportado por</label> <input type="text" id="reporter" class="formal-input w-full px-4 py-3 rounded-md focus:outline-none" placeholder="Nombre del tester">
      </div>
     </div>
     <div><label for="assigned-to" class="block text-sm font-semibold text-gray-700 mb-2">Asignado a</label> <input type="text" id="assigned-to" class="formal-input w-full px-4 py-3 rounded-md focus:outline-none" placeholder="Desarrollador responsable">
     </div>
     <div class="attachment-zone rounded-lg p-6 text-center">
      <div class="text-4xl text-gray-400 mb-3">
       üìé
      </div>
      <h3 class="text-lg font-semibold text-gray-700 mb-2">Adjuntos (¬°Indispensable!)</h3>
      <p class="text-gray-600 mb-4">Los adjuntos son cr√≠ticos para la resoluci√≥n efectiva del defecto</p>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
       <div class="bg-white rounded-lg p-4 border border-gray-200">
        <div class="text-2xl mb-2">
         üì∏
        </div>
        <div class="font-semibold text-gray-700">
         Capturas de Pantalla
        </div>
        <div class="text-gray-500">
         Evidencia visual del error
        </div>
       </div>
       <div class="bg-white rounded-lg p-4 border border-gray-200">
        <div class="text-2xl mb-2">
         üé•
        </div>
        <div class="font-semibold text-gray-700">
         Videos
        </div>
        <div class="text-gray-500">
         Reproducci√≥n del problema
        </div>
       </div>
       <div class="bg-white rounded-lg p-4 border border-gray-200">
        <div class="text-2xl mb-2">
         üìã
        </div>
        <div class="font-semibold text-gray-700">
         Logs del Sistema
        </div>
        <div class="text-gray-500">
         Errores de consola/servidor
        </div>
       </div>
      </div><textarea id="attachments-note" rows="2" class="formal-input w-full px-4 py-3 rounded-md focus:outline-none mt-4" placeholder="Describir los adjuntos incluidos (ej. screenshot_login_error.png, console_logs.txt)"></textarea>
     </div>
     <div class="flex justify-end"><button type="submit" id="create-bug-btn" class="formal-button bg-red-700 hover:bg-red-800 text-white px-8 py-3 rounded-md flex items-center gap-3"> <span>Crear Reporte de Defecto</span>
       <div id="create-loading" class="loading-spinner hidden"></div></button>
     </div>
    </form>
   </section><!-- Bug Reports List -->
   <section id="bug-reports-container" class="mb-8">
    <div class="border-b border-gray-200 pb-4 mb-8">
     <div class="flex justify-between items-center">
      <div>
       <h2 class="text-2xl font-semibold text-gray-800">Defectos Reportados</h2>
       <p class="text-gray-600 mt-1">Gestione el ciclo de vida de los defectos</p>
      </div>
      <div class="flex gap-4 text-sm">
       <div class="flex items-center gap-2">
        <div class="w-3 h-3 bg-blue-500 rounded"></div><span>Nuevo</span>
       </div>
       <div class="flex items-center gap-2">
        <div class="w-3 h-3 bg-amber-500 rounded"></div><span>Asignado</span>
       </div>
       <div class="flex items-center gap-2">
        <div class="w-3 h-3 bg-purple-500 rounded"></div><span>En Progreso</span>
       </div>
       <div class="flex items-center gap-2">
        <div class="w-3 h-3 bg-green-500 rounded"></div><span>Resuelto</span>
       </div>
       <div class="flex items-center gap-2">
        <div class="w-3 h-3 bg-gray-500 rounded"></div><span>Cerrado</span>
       </div>
      </div>
     </div>
    </div>
    <div id="bug-reports-list" class="space-y-6"><!-- Bug reports will be rendered here -->
    </div>
    <div id="no-bugs-message" class="formal-section rounded-lg text-center py-16 text-gray-500">
     <div class="text-5xl mb-4 text-gray-400">
      üêõ
     </div>
     <h3 class="text-xl font-medium text-gray-700 mb-2">No hay Defectos Reportados</h3>
     <p class="text-gray-600">Use las plantillas r√°pidas o cree reportes personalizados para comenzar</p>
    </div>
   </section><!-- IEEE 829 Guidelines -->
   <section class="ieee-standard rounded-lg p-8 mb-8">
    <div class="border-b border-red-300 pb-4 mb-6">
     <h2 class="text-2xl font-semibold text-gray-800">Gu√≠a IEEE 829 - Reportes de Defectos</h2>
     <p class="text-gray-700 mt-1">Elementos esenciales para reportes de defectos profesionales</p>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
     <div class="bg-white rounded-lg p-6 border border-gray-200 shadow-sm">
      <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"><span class="w-8 h-8 bg-red-600 text-white rounded-lg flex items-center justify-center text-sm">üéØ</span> Identificaci√≥n Clara</h3>
      <ul class="text-sm text-gray-600 space-y-2">
       <li class="flex items-start"><span class="text-red-600 mr-2">‚Ä¢</span>ID √∫nico y secuencial</li>
       <li class="flex items-start"><span class="text-red-600 mr-2">‚Ä¢</span>T√≠tulo descriptivo y conciso</li>
       <li class="flex items-start"><span class="text-red-600 mr-2">‚Ä¢</span>Referencia al caso de prueba</li>
      </ul>
     </div>
     <div class="bg-white rounded-lg p-6 border border-gray-200 shadow-sm">
      <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"><span class="w-8 h-8 bg-orange-600 text-white rounded-lg flex items-center justify-center text-sm">üîÑ</span> Reproducibilidad</h3>
      <ul class="text-sm text-gray-600 space-y-2">
       <li class="flex items-start"><span class="text-orange-600 mr-2">‚Ä¢</span>Pasos detallados y numerados</li>
       <li class="flex items-start"><span class="text-orange-600 mr-2">‚Ä¢</span>Datos espec√≠ficos utilizados</li>
       <li class="flex items-start"><span class="text-orange-600 mr-2">‚Ä¢</span>Condiciones del entorno</li>
      </ul>
     </div>
     <div class="bg-white rounded-lg p-6 border border-gray-200 shadow-sm">
      <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"><span class="w-8 h-8 bg-purple-600 text-white rounded-lg flex items-center justify-center text-sm">‚öñÔ∏è</span> Comparaci√≥n de Resultados</h3>
      <ul class="text-sm text-gray-600 space-y-2">
       <li class="flex items-start"><span class="text-purple-600 mr-2">‚Ä¢</span>Resultado actual observado</li>
       <li class="flex items-start"><span class="text-purple-600 mr-2">‚Ä¢</span>Resultado esperado seg√∫n especificaci√≥n</li>
       <li class="flex items-start"><span class="text-purple-600 mr-2">‚Ä¢</span>Diferencias claramente marcadas</li>
      </ul>
     </div>
     <div class="bg-white rounded-lg p-6 border border-gray-200 shadow-sm">
      <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"><span class="w-8 h-8 bg-green-600 text-white rounded-lg flex items-center justify-center text-sm">üìé</span> Evidencia Adjunta</h3>
      <ul class="text-sm text-gray-600 space-y-2">
       <li class="flex items-start"><span class="text-green-600 mr-2">‚Ä¢</span>Capturas de pantalla del error</li>
       <li class="flex items-start"><span class="text-green-600 mr-2">‚Ä¢</span>Videos de reproducci√≥n</li>
       <li class="flex items-start"><span class="text-green-600 mr-2">‚Ä¢</span>Logs y mensajes de error</li>
      </ul>
     </div>
    </div>
   </section><!-- Export and Actions -->
   <section class="formal-section rounded-lg p-8">
    <div class="border-b border-gray-200 pb-4 mb-6">
     <h2 class="text-2xl font-semibold text-gray-800">Exportar Reportes de Defectos</h2>
     <p class="text-gray-600 mt-1">Genere documentos para seguimiento y gesti√≥n</p>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4"><button id="export-bug-list" class="formal-button bg-red-700 hover:bg-red-800 text-white px-6 py-4 rounded-md flex items-center justify-center gap-3 border border-red-800"> <span class="text-xl">üìã</span>
      <div class="text-left">
       <div class="font-semibold">
        Lista de Defectos
       </div>
       <div class="text-xs opacity-90">
        Todos los reportes
       </div>
      </div></button> <button id="export-critical-bugs" class="formal-button bg-orange-700 hover:bg-orange-800 text-white px-6 py-4 rounded-md flex items-center justify-center gap-3 border border-orange-800"> <span class="text-xl">üö®</span>
      <div class="text-left">
       <div class="font-semibold">
        Defectos Cr√≠ticos
       </div>
       <div class="text-xs opacity-90">
        Alta/Cr√≠tica severidad
       </div>
      </div></button> <button id="export-status-report" class="formal-button bg-blue-700 hover:bg-blue-800 text-white px-6 py-4 rounded-md flex items-center justify-center gap-3 border border-blue-800"> <span class="text-xl">üìä</span>
      <div class="text-left">
       <div class="font-semibold">
        Reporte de Estado
       </div>
       <div class="text-xs opacity-90">
        M√©tricas y estad√≠sticas
       </div>
      </div></button> <button id="clear-all-bugs" class="formal-button bg-gray-700 hover:bg-gray-800 text-white px-6 py-4 rounded-md flex items-center justify-center gap-3 border border-gray-800"> <span class="text-xl">üóëÔ∏è</span>
      <div class="text-left">
       <div class="font-semibold">
        Limpiar Todo
       </div>
       <div class="text-xs opacity-90">
        Reiniciar reportes
       </div>
      </div></button>
    </div>
   </section>
  </main>
  <script>
        // Configuration and state
        const defaultConfig = {
            project_name: "Sistema de Gesti√≥n",
            version: "v1.0.0",
            qa_manager: "Responsable de QA",
            organization: "Organizaci√≥n"
        };

        let bugReports = [];
        let isInitialized = false;

        // Template definitions
        const templates = {
            "auth-error": {
                bug_id: "BUG-001",
                title: "Error de autenticaci√≥n al usar credenciales v√°lidas",
                test_case_id: "CP-LOGIN-001",
                steps_to_reproduce: "1. Abrir navegador web en app.com/login\n2. Ingresar 'test@itson.edu.mx' en el campo 'Usuario'\n3. Ingresar 'Pass123!' en el campo 'Contrase√±a'\n4. Hacer clic en el bot√≥n 'Iniciar Sesi√≥n'\n5. Observar el comportamiento del sistema",
                actual_result: "El sistema muestra el mensaje 'Usuario o contrase√±a inv√°lido' y no permite el acceso. La p√°gina permanece en el formulario de login sin redirecci√≥n.",
                expected_result: "El sistema deb√≠a validar las credenciales exitosamente, redirigir al Dashboard principal y mostrar el mensaje 'Bienvenido, test'.",
                severity: "critical",
                priority: "urgent",
                category: "funcional",
                environment: "Windows 10, Chrome 120.0, Ambiente de Staging",
                attachments_note: "screenshot_login_error.png, console_errors.txt, network_logs.har"
            },
            "form-validation": {
                bug_id: "BUG-002",
                title: "Validaci√≥n de formulario permite env√≠o con campos obligatorios vac√≠os",
                test_case_id: "CP-FORM-001",
                steps_to_reproduce: "1. Navegar a la p√°gina de registro de usuario\n2. Dejar el campo 'Email' completamente vac√≠o\n3. Completar solo el campo 'Nombre' con 'Juan P√©rez'\n4. Hacer clic en el bot√≥n 'Registrar Usuario'\n5. Observar el comportamiento del sistema",
                actual_result: "El formulario se env√≠a exitosamente a pesar de tener el campo 'Email' vac√≠o. Se crea un registro en la base de datos con email NULL.",
                expected_result: "El sistema deb√≠a mostrar un mensaje de error 'El campo Email es obligatorio' y prevenir el env√≠o del formulario.",
                severity: "high",
                priority: "high",
                category: "funcional",
                environment: "Firefox 119.0, Ubuntu 22.04, Ambiente de Testing",
                attachments_note: "form_validation_error.mp4, database_record_screenshot.png"
            },
            "ui-display": {
                bug_id: "BUG-003",
                title: "Elementos de la interfaz se superponen en resoluciones m√≥viles",
                test_case_id: "CP-UI-001",
                steps_to_reproduce: "1. Abrir la aplicaci√≥n en un dispositivo m√≥vil o emulador\n2. Configurar la resoluci√≥n a 375x667 (iPhone SE)\n3. Navegar a la p√°gina principal del Dashboard\n4. Desplazarse hacia abajo para ver todos los elementos\n5. Observar la disposici√≥n de los elementos",
                actual_result: "Los botones de acci√≥n se superponen con el texto del contenido principal. El men√∫ lateral cubre parcialmente el √°rea de contenido.",
                expected_result: "Todos los elementos de la interfaz deb√≠an ajustarse correctamente al tama√±o de pantalla sin superposiciones.",
                severity: "medium",
                priority: "medium",
                category: "interfaz",
                environment: "Safari Mobile, iOS 16.5, iPhone SE (375x667)",
                attachments_note: "mobile_layout_issue.png, responsive_comparison.png"
            },
            "data-loss": {
                bug_id: "BUG-004",
                title: "Datos del formulario se pierden al cambiar de pesta√±a",
                test_case_id: "CP-DATA-001",
                steps_to_reproduce: "1. Abrir el formulario de creaci√≥n de producto\n2. Completar todos los campos con informaci√≥n v√°lida\n3. Cambiar a otra pesta√±a del navegador por 30 segundos\n4. Regresar a la pesta√±a del formulario\n5. Verificar el estado de los datos ingresados",
                actual_result: "Todos los datos ingresados en el formulario se han perdido. Los campos aparecen vac√≠os como si nunca se hubieran completado.",
                expected_result: "Los datos del formulario deb√≠an mantenerse intactos al regresar a la pesta√±a, permitiendo continuar con el proceso.",
                severity: "high",
                priority: "high",
                category: "datos",
                environment: "Chrome 120.0, Windows 11, Ambiente de Producci√≥n",
                attachments_note: "data_loss_video.mp4, browser_console_logs.txt"
            },
            "performance": {
                bug_id: "BUG-005",
                title: "Tiempo de carga excesivo en la p√°gina de reportes",
                test_case_id: "CP-PERF-001",
                steps_to_reproduce: "1. Iniciar sesi√≥n en el sistema con usuario administrador\n2. Navegar al m√≥dulo 'Reportes'\n3. Seleccionar 'Reporte de Ventas Mensual'\n4. Hacer clic en 'Generar Reporte'\n5. Medir el tiempo de respuesta hasta que aparezcan los datos",
                actual_result: "El reporte tarda 45 segundos en cargar completamente. Durante este tiempo, la p√°gina muestra solo un indicador de carga sin informaci√≥n adicional.",
                expected_result: "El reporte deb√≠a cargar en menos de 10 segundos seg√∫n los requerimientos de rendimiento especificados.",
                severity: "medium",
                priority: "medium",
                category: "rendimiento",
                environment: "Edge 119.0, Windows 10, Red corporativa (100 Mbps)",
                attachments_note: "performance_timeline.png, network_analysis.har, server_response_times.log"
            },
            "navigation": {
                bug_id: "BUG-006",
                title: "Enlace de 'Configuraci√≥n' redirige a p√°gina 404",
                test_case_id: "CP-NAV-001",
                steps_to_reproduce: "1. Iniciar sesi√≥n como usuario administrador\n2. Localizar el men√∫ principal de navegaci√≥n\n3. Hacer clic en el enlace 'Configuraci√≥n'\n4. Observar la p√°gina de destino",
                actual_result: "El navegador redirige a una p√°gina de error 404 'P√°gina no encontrada'. La URL muestra '/config' en lugar de '/configuracion'.",
                expected_result: "El enlace deb√≠a redirigir correctamente a la p√°gina de configuraci√≥n del sistema (/configuracion).",
                severity: "medium",
                priority: "high",
                category: "funcional",
                environment: "Chrome 120.0, macOS Ventura, Ambiente de Staging",
                attachments_note: "404_error_screenshot.png, browser_network_tab.png"
            }
        };

        // Data handler for SDK
        const dataHandler = {
            onDataChanged(data) {
                bugReports = data.sort((a, b) => {
                    const severityOrder = { critical: 1, high: 2, medium: 3, low: 4 };
                    const priorityOrder = { urgent: 1, high: 2, medium: 3, low: 4 };
                    
                    const severityDiff = severityOrder[a.severity] - severityOrder[b.severity];
                    if (severityDiff !== 0) return severityDiff;
                    
                    return priorityOrder[a.priority] - priorityOrder[b.priority];
                });
                renderBugReports();
            }
        };

        // Element SDK configuration
        const elementConfig = {
            defaultConfig,
            onConfigChange: async (config) => {
                document.getElementById('project-name-display').textContent = config.project_name || defaultConfig.project_name;
                document.getElementById('project-name-input').value = config.project_name || defaultConfig.project_name;
                document.getElementById('version-display').textContent = config.version || defaultConfig.version;
                document.getElementById('version-input').value = config.version || defaultConfig.version;
                document.getElementById('qa-manager-display').textContent = config.qa_manager || defaultConfig.qa_manager;
                document.getElementById('qa-manager-input').value = config.qa_manager || defaultConfig.qa_manager;
                document.getElementById('organization').textContent = config.organization || defaultConfig.organization;
            },
            mapToCapabilities: (config) => ({
                recolorables: [],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            }),
            mapToEditPanelValues: (config) => new Map([
                ["project_name", config.project_name || defaultConfig.project_name],
                ["version", config.version || defaultConfig.version],
                ["qa_manager", config.qa_manager || defaultConfig.qa_manager],
                ["organization", config.organization || defaultConfig.organization]
            ])
        };

        // Initialize SDKs
        async function initializeApp() {
            try {
                // Set current date
                document.getElementById('current-date').textContent = new Date().toLocaleDateString();
                
                if (window.elementSdk) {
                    await window.elementSdk.init(elementConfig);
                }
                
                if (window.dataSdk) {
                    const result = await window.dataSdk.init(dataHandler);
                    if (!result.isOk) {
                        console.error("Failed to initialize data SDK");
                    }
                }
                
                isInitialized = true;
                setupEventListeners();
            } catch (error) {
                console.error("Initialization error:", error);
                setupEventListeners();
            }
        }

        // Render bug reports
        function renderBugReports() {
            const container = document.getElementById('bug-reports-list');
            const noMessage = document.getElementById('no-bugs-message');
            
            if (bugReports.length === 0) {
                container.innerHTML = '';
                noMessage.style.display = 'block';
                return;
            }
            
            noMessage.style.display = 'none';
            
            container.innerHTML = bugReports.map((bug, index) => `
                <div class="bug-card ${bug.status} bg-white rounded-lg shadow-sm border border-gray-200 p-8">
                    <div class="flex justify-between items-start mb-6">
                        <div class="flex items-center gap-4">
                            <div class="bg-red-700 text-white rounded-lg w-12 h-12 flex items-center justify-center font-bold text-sm">
                                ${bug.bug_id.split('-').pop()}
                            </div>
                            <div>
                                <div class="flex items-center gap-3 mb-1">
                                    <h3 class="text-xl font-semibold text-gray-800">${bug.bug_id}</h3>
                                    <span class="status-badge ${bug.status === 'new' ? 'status-new' : bug.status === 'assigned' ? 'status-assigned' : bug.status === 'in-progress' ? 'status-in-progress' : bug.status === 'resolved' ? 'status-resolved' : bug.status === 'closed' ? 'status-closed' : 'status-reopened'}">
                                        ${bug.status === 'new' ? 'Nuevo' : bug.status === 'assigned' ? 'Asignado' : bug.status === 'in-progress' ? 'En Progreso' : bug.status === 'resolved' ? 'Resuelto' : bug.status === 'closed' ? 'Cerrado' : 'Reabierto'}
                                    </span>
                                    <span class="status-badge severity-${bug.severity}">
                                        ${bug.severity === 'critical' ? 'CR√çTICA' : bug.severity === 'high' ? 'ALTA' : bug.severity === 'medium' ? 'MEDIA' : 'BAJA'}
                                    </span>
                                    <span class="status-badge priority-${bug.priority}">
                                        ${bug.priority === 'urgent' ? 'URGENTE' : bug.priority === 'high' ? 'ALTA' : bug.priority === 'medium' ? 'MEDIA' : 'BAJA'}
                                    </span>
                                </div>
                                <p class="text-lg text-gray-700 font-medium">${bug.title}</p>
                                <div class="flex items-center gap-3 mt-1">
                                    <span class="text-sm text-gray-600 capitalize">${bug.category}</span>
                                    ${bug.test_case_id ? `<span class="text-gray-400">‚Ä¢</span><span class="text-sm text-blue-600">${bug.test_case_id}</span>` : ''}
                                    <span class="text-gray-400">‚Ä¢</span>
                                    <span class="text-sm text-gray-500">Reportado: ${new Date(bug.created_at).toLocaleDateString()}</span>
                                </div>
                                ${bug.reporter || bug.assigned_to ? `
                                    <div class="flex items-center gap-3 mt-1 text-sm text-gray-600">
                                        ${bug.reporter ? `<span>üë§ ${bug.reporter}</span>` : ''}
                                        ${bug.reporter && bug.assigned_to ? '<span class="text-gray-400">‚Üí</span>' : ''}
                                        ${bug.assigned_to ? `<span>üë®‚Äçüíª ${bug.assigned_to}</span>` : ''}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                        <div class="flex gap-3">
                            <select class="status-select formal-input px-3 py-2 text-sm rounded-md" data-bug-id="${bug.__backendId}">
                                <option value="new" ${bug.status === 'new' ? 'selected' : ''}>Nuevo</option>
                                <option value="assigned" ${bug.status === 'assigned' ? 'selected' : ''}>Asignado</option>
                                <option value="in-progress" ${bug.status === 'in-progress' ? 'selected' : ''}>En Progreso</option>
                                <option value="resolved" ${bug.status === 'resolved' ? 'selected' : ''}>Resuelto</option>
                                <option value="closed" ${bug.status === 'closed' ? 'selected' : ''}>Cerrado</option>
                                <option value="reopened" ${bug.status === 'reopened' ? 'selected' : ''}>Reabierto</option>
                            </select>
                            <button class="edit-bug text-red-600 hover:text-red-800 hover:bg-red-50 p-2 rounded-md transition-colors" data-bug-id="${bug.__backendId}">
                                ‚úèÔ∏è
                            </button>
                            <button class="delete-bug text-gray-600 hover:text-gray-800 hover:bg-gray-50 p-2 rounded-md transition-colors" data-bug-id="${bug.__backendId}">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div class="bg-blue-50 rounded-lg p-4">
                                <h4 class="font-semibold text-blue-800 mb-2 flex items-center gap-2">
                                    <span class="w-5 h-5 bg-blue-600 text-white rounded flex items-center justify-center text-xs">üîÑ</span>
                                    Pasos para Reproducir
                                </h4>
                                <pre class="text-blue-700 text-sm leading-relaxed whitespace-pre-wrap font-sans">${bug.steps_to_reproduce}</pre>
                            </div>
                            
                            ${bug.environment ? `
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <h4 class="font-semibold text-gray-800 mb-2 flex items-center gap-2">
                                        <span class="w-5 h-5 bg-gray-600 text-white rounded flex items-center justify-center text-xs">üíª</span>
                                        Entorno
                                    </h4>
                                    <p class="text-gray-700 text-sm">${bug.environment}</p>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="space-y-4">
                            <div class="actual-result rounded-lg p-4">
                                <h4 class="font-semibold text-red-800 mb-2 flex items-center gap-2">
                                    <span class="w-5 h-5 bg-red-600 text-white rounded flex items-center justify-center text-xs">‚ùå</span>
                                    Resultado Actual
                                </h4>
                                <pre class="text-red-700 text-sm leading-relaxed whitespace-pre-wrap font-sans">${bug.actual_result}</pre>
                            </div>
                            
                            <div class="expected-result rounded-lg p-4">
                                <h4 class="font-semibold text-green-800 mb-2 flex items-center gap-2">
                                    <span class="w-5 h-5 bg-green-600 text-white rounded flex items-center justify-center text-xs">‚úÖ</span>
                                    Resultado Esperado
                                </h4>
                                <pre class="text-green-700 text-sm leading-relaxed whitespace-pre-wrap font-sans">${bug.expected_result}</pre>
                            </div>
                        </div>
                    </div>
                    
                    ${bug.attachments_note ? `
                        <div class="mt-6 bg-yellow-50 rounded-lg p-4 border border-yellow-200">
                            <h4 class="font-semibold text-yellow-800 mb-2 flex items-center gap-2">
                                <span class="w-5 h-5 bg-yellow-600 text-white rounded flex items-center justify-center text-xs">üìé</span>
                                Adjuntos
                            </h4>
                            <p class="text-yellow-700 text-sm">${bug.attachments_note}</p>
                        </div>
                    ` : ''}
                </div>
            `).join('');
            
            // Add event listeners
            container.querySelectorAll('.status-select').forEach(select => {
                select.addEventListener('change', handleStatusChange);
            });
            
            container.querySelectorAll('.edit-bug').forEach(button => {
                button.addEventListener('click', handleEditBug);
            });
            
            container.querySelectorAll('.delete-bug').forEach(button => {
                button.addEventListener('click', handleDeleteBug);
            });
        }

        // Handle template button clicks
        function handleTemplateClick(event) {
            const templateType = event.currentTarget.dataset.template;
            const template = templates[templateType];
            
            if (template) {
                document.getElementById('bug-id').value = template.bug_id;
                document.getElementById('bug-title').value = template.title;
                document.getElementById('test-case-id').value = template.test_case_id || '';
                document.getElementById('steps-to-reproduce').value = template.steps_to_reproduce;
                document.getElementById('actual-result').value = template.actual_result;
                document.getElementById('expected-result').value = template.expected_result;
                document.getElementById('bug-severity').value = template.severity;
                document.getElementById('bug-priority').value = template.priority;
                document.getElementById('bug-category').value = template.category;
                document.getElementById('environment').value = template.environment || '';
                document.getElementById('attachments-note').value = template.attachments_note || '';
                
                // Scroll to form
                document.getElementById('bug-report-form').scrollIntoView({ behavior: 'smooth' });
                
                showToast(`Plantilla "${template.title}" cargada`, "success");
            }
        }

        // Handle form submission
        async function handleFormSubmit(event) {
            event.preventDefault();
            
            if (bugReports.length >= 999) {
                showToast("L√≠mite m√°ximo de 999 reportes de defectos alcanzado", "error");
                return;
            }
            
            const bugData = {
                bug_id: document.getElementById('bug-id').value,
                title: document.getElementById('bug-title').value,
                test_case_id: document.getElementById('test-case-id').value,
                steps_to_reproduce: document.getElementById('steps-to-reproduce').value,
                actual_result: document.getElementById('actual-result').value,
                expected_result: document.getElementById('expected-result').value,
                severity: document.getElementById('bug-severity').value,
                priority: document.getElementById('bug-priority').value,
                category: document.getElementById('bug-category').value,
                environment: document.getElementById('environment').value,
                reporter: document.getElementById('reporter').value,
                assigned_to: document.getElementById('assigned-to').value,
                attachments_note: document.getElementById('attachments-note').value,
                status: 'new',
                created_at: new Date().toISOString()
            };
            
            const createButton = document.getElementById('create-bug-btn');
            const loading = document.getElementById('create-loading');
            
            createButton.disabled = true;
            loading.classList.remove('hidden');
            
            if (window.dataSdk) {
                const result = await window.dataSdk.create(bugData);
                
                if (result.isOk) {
                    event.target.reset();
                    showToast("Reporte de defecto creado exitosamente", "success");
                } else {
                    showToast("Error al crear el reporte de defecto", "error");
                }
            } else {
                bugReports.push({ ...bugData, __backendId: bugData.bug_id });
                renderBugReports();
                event.target.reset();
                showToast("Reporte de defecto creado exitosamente", "success");
            }
            
            createButton.disabled = false;
            loading.classList.add('hidden');
        }

        // Handle status change
        async function handleStatusChange(event) {
            const bugId = event.target.dataset.bugId;
            const newStatus = event.target.value;
            const bug = bugReports.find(b => b.__backendId === bugId);
            
            if (bug && window.dataSdk) {
                const updatedBug = { ...bug, status: newStatus };
                const result = await window.dataSdk.update(updatedBug);
                
                if (!result.isOk) {
                    event.target.value = bug.status;
                    showToast("Error al actualizar el estado", "error");
                }
            }
        }

        // Handle edit bug
        function handleEditBug(event) {
            const bugId = event.target.dataset.bugId;
            const bug = bugReports.find(b => b.__backendId === bugId);
            
            if (bug) {
                document.getElementById('bug-id').value = bug.bug_id;
                document.getElementById('bug-title').value = bug.title;
                document.getElementById('test-case-id').value = bug.test_case_id || '';
                document.getElementById('steps-to-reproduce').value = bug.steps_to_reproduce;
                document.getElementById('actual-result').value = bug.actual_result;
                document.getElementById('expected-result').value = bug.expected_result;
                document.getElementById('bug-severity').value = bug.severity;
                document.getElementById('bug-priority').value = bug.priority;
                document.getElementById('bug-category').value = bug.category;
                document.getElementById('environment').value = bug.environment || '';
                document.getElementById('reporter').value = bug.reporter || '';
                document.getElementById('assigned-to').value = bug.assigned_to || '';
                document.getElementById('attachments-note').value = bug.attachments_note || '';
                
                document.getElementById('bug-report-form').scrollIntoView({ behavior: 'smooth' });
                showToast("Reporte de defecto cargado para edici√≥n", "info");
            }
        }

        // Handle delete bug
        async function handleDeleteBug(event) {
            const bugId = event.target.dataset.bugId;
            const bug = bugReports.find(b => b.__backendId === bugId);
            
            if (bug && window.dataSdk) {
                const button = event.target;
                const originalText = button.innerHTML;
                button.innerHTML = '‚ùå';
                button.style.backgroundColor = '#fee2e2';
                
                const confirmDelete = () => {
                    button.innerHTML = '‚è≥';
                    window.dataSdk.delete(bug).then(result => {
                        if (!result.isOk) {
                            showToast("Error al eliminar el reporte", "error");
                            button.innerHTML = originalText;
                            button.style.backgroundColor = '';
                        }
                    });
                };
                
                const cancelDelete = () => {
                    button.innerHTML = originalText;
                    button.style.backgroundColor = '';
                };
                
                const timeoutId = setTimeout(confirmDelete, 2000);
                
                const clickHandler = (e) => {
                    if (!button.contains(e.target)) {
                        clearTimeout(timeoutId);
                        cancelDelete();
                        document.removeEventListener('click', clickHandler);
                    }
                };
                
                document.addEventListener('click', clickHandler);
                
                button.onclick = (e) => {
                    e.stopPropagation();
                    clearTimeout(timeoutId);
                    confirmDelete();
                    document.removeEventListener('click', clickHandler);
                };
            }
        }

        // Export functions
        function exportBugList() {
            const bugList = generateBugList();
            downloadText(bugList, 'lista-defectos.txt');
        }

        function exportCriticalBugs() {
            const criticalBugs = generateCriticalBugsReport();
            downloadText(criticalBugs, 'defectos-criticos.txt');
        }

        function exportStatusReport() {
            const statusReport = generateStatusReport();
            downloadText(statusReport, 'reporte-estado-defectos.txt');
        }

        function generateBugList() {
            const config = window.elementSdk?.config || defaultConfig;
            const currentDate = new Date().toLocaleDateString();
            
            return `
LISTA DE DEFECTOS IEEE 829
==========================

INFORMACI√ìN DEL PROYECTO:
Proyecto: ${config.project_name || defaultConfig.project_name}
Versi√≥n: ${config.version || defaultConfig.version}
Organizaci√≥n: ${config.organization || defaultConfig.organization}
QA Manager: ${config.qa_manager || defaultConfig.qa_manager}
Fecha de Generaci√≥n: ${currentDate}

RESUMEN DE DEFECTOS:
Total de Defectos: ${bugReports.length}
Nuevos: ${bugReports.filter(b => b.status === 'new').length}
Asignados: ${bugReports.filter(b => b.status === 'assigned').length}
En Progreso: ${bugReports.filter(b => b.status === 'in-progress').length}
Resueltos: ${bugReports.filter(b => b.status === 'resolved').length}
Cerrados: ${bugReports.filter(b => b.status === 'closed').length}
Reabiertos: ${bugReports.filter(b => b.status === 'reopened').length}

DISTRIBUCI√ìN POR SEVERIDAD:
‚Ä¢ Cr√≠tica: ${bugReports.filter(b => b.severity === 'critical').length} defectos
‚Ä¢ Alta: ${bugReports.filter(b => b.severity === 'high').length} defectos
‚Ä¢ Media: ${bugReports.filter(b => b.severity === 'medium').length} defectos
‚Ä¢ Baja: ${bugReports.filter(b => b.severity === 'low').length} defectos

DISTRIBUCI√ìN POR CATEGOR√çA:
${Object.entries(bugReports.reduce((acc, bug) => {
    acc[bug.category] = (acc[bug.category] || 0) + 1;
    return acc;
}, {})).map(([category, count]) => `‚Ä¢ ${category.charAt(0).toUpperCase() + category.slice(1)}: ${count} defectos`).join('\n')}

${bugReports.map((bug, index) => `
================================================================================
DEFECTO #${index + 1}
================================================================================

ID: ${bug.bug_id}
T√çTULO: ${bug.title}
CASO DE PRUEBA ASOCIADO: ${bug.test_case_id || 'N/A'}
CATEGOR√çA: ${bug.category.toUpperCase()}
SEVERIDAD: ${bug.severity.toUpperCase()}
PRIORIDAD: ${bug.priority.toUpperCase()}
ESTADO: ${bug.status.toUpperCase()}

PASOS PARA REPRODUCIR:
${bug.steps_to_reproduce}

RESULTADO ACTUAL:
${bug.actual_result}

RESULTADO ESPERADO:
${bug.expected_result}

INFORMACI√ìN ADICIONAL:
‚Ä¢ Entorno: ${bug.environment || 'No especificado'}
‚Ä¢ Reportado por: ${bug.reporter || 'No especificado'}
‚Ä¢ Asignado a: ${bug.assigned_to || 'No asignado'}
‚Ä¢ Fecha de Reporte: ${new Date(bug.created_at).toLocaleDateString()}
‚Ä¢ Adjuntos: ${bug.attachments_note || 'Ninguno'}

`).join('')}

================================================================================
FIN DE LA LISTA DE DEFECTOS
================================================================================

Documento generado autom√°ticamente
Est√°ndar: IEEE 829-2008
Total de defectos incluidos: ${bugReports.length}
            `.trim();
        }

        function generateCriticalBugsReport() {
            const config = window.elementSdk?.config || defaultConfig;
            const currentDate = new Date().toLocaleDateString();
            const criticalBugs = bugReports.filter(b => b.severity === 'critical' || b.severity === 'high');
            
            return `
REPORTE DE DEFECTOS CR√çTICOS
============================

INFORMACI√ìN DEL PROYECTO:
Proyecto: ${config.project_name || defaultConfig.project_name}
Versi√≥n: ${config.version || defaultConfig.version}
QA Manager: ${config.qa_manager || defaultConfig.qa_manager}
Fecha: ${currentDate}

‚ö†Ô∏è  ALERTA: Este reporte contiene defectos de severidad CR√çTICA y ALTA
    Requieren atenci√≥n inmediata del equipo de desarrollo.

RESUMEN EJECUTIVO:
Total de Defectos Cr√≠ticos/Altos: ${criticalBugs.length}
Defectos Cr√≠ticos: ${criticalBugs.filter(b => b.severity === 'critical').length}
Defectos de Alta Severidad: ${criticalBugs.filter(b => b.severity === 'high').length}

ESTADO ACTUAL:
‚Ä¢ Nuevos: ${criticalBugs.filter(b => b.status === 'new').length}
‚Ä¢ Asignados: ${criticalBugs.filter(b => b.status === 'assigned').length}
‚Ä¢ En Progreso: ${criticalBugs.filter(b => b.status === 'in-progress').length}
‚Ä¢ Resueltos: ${criticalBugs.filter(b => b.status === 'resolved').length}

${criticalBugs.length > 0 ? criticalBugs.map((bug, index) => `
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ DEFECTO CR√çTICO #${index + 1}: ${bug.bug_id}                                
‚îÇ SEVERIDAD: ${bug.severity.toUpperCase()} | PRIORIDAD: ${bug.priority.toUpperCase()}
‚îÇ ESTADO: ${bug.status.toUpperCase()}
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

T√çTULO: ${bug.title}
CASO DE PRUEBA: ${bug.test_case_id || 'N/A'}

IMPACTO:
${bug.actual_result}

PASOS PARA REPRODUCIR:
${bug.steps_to_reproduce}

RESULTADO ESPERADO:
${bug.expected_result}

INFORMACI√ìN DE SEGUIMIENTO:
‚Ä¢ Reportado: ${new Date(bug.created_at).toLocaleDateString()}
‚Ä¢ Reportado por: ${bug.reporter || 'No especificado'}
‚Ä¢ Asignado a: ${bug.assigned_to || '‚ö†Ô∏è  SIN ASIGNAR'}
‚Ä¢ Entorno: ${bug.environment || 'No especificado'}
‚Ä¢ Adjuntos: ${bug.attachments_note || 'Ninguno'}

`).join('') : 
'üéâ EXCELENTE: No hay defectos cr√≠ticos o de alta severidad reportados.'}

================================================================================
RECOMENDACIONES
================================================================================

${criticalBugs.length > 0 ? `
‚ö†Ô∏è  ACCIONES REQUERIDAS:
1. Asignar inmediatamente todos los defectos sin asignar
2. Priorizar la resoluci√≥n de defectos cr√≠ticos
3. Establecer reuniones diarias de seguimiento
4. Considerar hotfix para defectos cr√≠ticos en producci√≥n
5. Revisar procesos de QA para prevenir defectos similares

üìä M√âTRICAS DE CALIDAD:
‚Ä¢ Tasa de defectos cr√≠ticos: ${((criticalBugs.length / bugReports.length) * 100).toFixed(1)}%
‚Ä¢ Defectos sin asignar: ${criticalBugs.filter(b => !b.assigned_to).length}
‚Ä¢ Tiempo promedio de resoluci√≥n: Pendiente de c√°lculo
` : `
‚úÖ ESTADO SALUDABLE:
‚Ä¢ No hay defectos cr√≠ticos pendientes
‚Ä¢ El sistema mantiene buena calidad
‚Ä¢ Continuar con las pruebas regulares
`}

Generado autom√°ticamente el ${currentDate}
            `.trim();
        }

        function generateStatusReport() {
            const config = window.elementSdk?.config || defaultConfig;
            const currentDate = new Date().toLocaleDateString();
            
            const statusCounts = bugReports.reduce((acc, bug) => {
                acc[bug.status] = (acc[bug.status] || 0) + 1;
                return acc;
            }, {});
            
            const severityCounts = bugReports.reduce((acc, bug) => {
                acc[bug.severity] = (acc[bug.severity] || 0) + 1;
                return acc;
            }, {});
            
            const categoryCounts = bugReports.reduce((acc, bug) => {
                acc[bug.category] = (acc[bug.category] || 0) + 1;
                return acc;
            }, {});
            
            return `
REPORTE DE ESTADO DE DEFECTOS
=============================

INFORMACI√ìN DEL PROYECTO:
Proyecto: ${config.project_name || defaultConfig.project_name}
Versi√≥n: ${config.version || defaultConfig.version}
QA Manager: ${config.qa_manager || defaultConfig.qa_manager}
Fecha de Reporte: ${currentDate}

M√âTRICAS GENERALES:
==================
Total de Defectos Reportados: ${bugReports.length}
Defectos Activos (No Cerrados): ${bugReports.filter(b => b.status !== 'closed').length}
Defectos Resueltos: ${bugReports.filter(b => b.status === 'resolved' || b.status === 'closed').length}
Tasa de Resoluci√≥n: ${bugReports.length > 0 ? ((bugReports.filter(b => b.status === 'resolved' || b.status === 'closed').length / bugReports.length) * 100).toFixed(1) : 0}%

DISTRIBUCI√ìN POR ESTADO:
=======================
${Object.entries(statusCounts).map(([status, count]) => {
    const percentage = ((count / bugReports.length) * 100).toFixed(1);
    const statusName = status === 'new' ? 'Nuevos' : 
                      status === 'assigned' ? 'Asignados' : 
                      status === 'in-progress' ? 'En Progreso' : 
                      status === 'resolved' ? 'Resueltos' : 
                      status === 'closed' ? 'Cerrados' : 'Reabiertos';
    return `‚Ä¢ ${statusName}: ${count} (${percentage}%)`;
}).join('\n')}

DISTRIBUCI√ìN POR SEVERIDAD:
===========================
${Object.entries(severityCounts).map(([severity, count]) => {
    const percentage = ((count / bugReports.length) * 100).toFixed(1);
    const severityName = severity === 'critical' ? 'Cr√≠tica' : 
                        severity === 'high' ? 'Alta' : 
                        severity === 'medium' ? 'Media' : 'Baja';
    return `‚Ä¢ ${severityName}: ${count} (${percentage}%)`;
}).join('\n')}

DISTRIBUCI√ìN POR CATEGOR√çA:
===========================
${Object.entries(categoryCounts).map(([category, count]) => {
    const percentage = ((count / bugReports.length) * 100).toFixed(1);
    return `‚Ä¢ ${category.charAt(0).toUpperCase() + category.slice(1)}: ${count} (${percentage}%)`;
}).join('\n')}

AN√ÅLISIS DE TENDENCIAS:
======================
${bugReports.length > 0 ? `
‚Ä¢ Defectos cr√≠ticos/altos: ${bugReports.filter(b => b.severity === 'critical' || b.severity === 'high').length} (${((bugReports.filter(b => b.severity === 'critical' || b.severity === 'high').length / bugReports.length) * 100).toFixed(1)}%)
‚Ä¢ Defectos sin asignar: ${bugReports.filter(b => !b.assigned_to || b.assigned_to.trim() === '').length}
‚Ä¢ Defectos reabiertos: ${bugReports.filter(b => b.status === 'reopened').length}
‚Ä¢ Categor√≠a m√°s problem√°tica: ${Object.entries(categoryCounts).sort((a, b) => b[1] - a[1])[0]?.[0] || 'N/A'}
` : '‚Ä¢ No hay datos suficientes para an√°lisis de tendencias'}

RECOMENDACIONES:
===============
${bugReports.length === 0 ? 
'‚úÖ Excelente: No hay defectos reportados. Continuar con las pruebas regulares.' :
bugReports.filter(b => b.severity === 'critical').length > 0 ?
'‚ö†Ô∏è  CR√çTICO: Hay defectos cr√≠ticos pendientes. Requieren atenci√≥n inmediata.' :
bugReports.filter(b => b.status === 'new').length > bugReports.length * 0.3 ?
'üìã Hay muchos defectos nuevos sin asignar. Revisar asignaciones del equipo.' :
'‚úÖ Estado general saludable. Continuar con el proceso normal de resoluci√≥n.'}

${bugReports.filter(b => !b.assigned_to || b.assigned_to.trim() === '').length > 0 ?
`\nüîÑ ACCI√ìN REQUERIDA: ${bugReports.filter(b => !b.assigned_to || b.assigned_to.trim() === '').length} defectos necesitan asignaci√≥n.` : ''}

PR√ìXIMOS PASOS:
==============
1. Revisar defectos cr√≠ticos y de alta prioridad
2. Asignar defectos pendientes al equipo de desarrollo
3. Seguimiento semanal del progreso de resoluci√≥n
4. An√°lisis de causa ra√≠z para defectos recurrentes
5. Actualizaci√≥n de casos de prueba basada en defectos encontrados

================================================================================
Reporte generado autom√°ticamente
Est√°ndar: IEEE 829-2008
Fecha: ${currentDate}
            `.trim();
        }

        function downloadText(content, filename) {
            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        async function clearAllBugs() {
            if (bugReports.length === 0) {
                showToast("No hay reportes de defectos para limpiar", "info");
                return;
            }
            
            const button = document.getElementById('clear-all-bugs');
            const originalText = button.textContent;
            button.textContent = '‚ö†Ô∏è Confirmar';
            button.style.backgroundColor = '#dc2626';
            
            const confirmClear = async () => {
                button.textContent = '‚è≥ Limpiando...';
                
                if (window.dataSdk) {
                    for (const bug of bugReports) {
                        await window.dataSdk.delete(bug);
                    }
                } else {
                    bugReports = [];
                    renderBugReports();
                }
                
                showToast("Reportes de defectos eliminados", "success");
                button.textContent = originalText;
                button.style.backgroundColor = '';
            };
            
            const cancelClear = () => {
                button.textContent = originalText;
                button.style.backgroundColor = '';
            };
            
            const timeoutId = setTimeout(confirmClear, 3000);
            
            const clickHandler = (e) => {
                if (!button.contains(e.target)) {
                    clearTimeout(timeoutId);
                    cancelClear();
                    document.removeEventListener('click', clickHandler);
                }
            };
            
            document.addEventListener('click', clickHandler);
            
            button.onclick = (e) => {
                e.stopPropagation();
                clearTimeout(timeoutId);
                confirmClear();
                document.removeEventListener('click', clickHandler);
            };
        }

        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';
            
            toast.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-transform duration-300 translate-x-full`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.remove('translate-x-full');
            }, 100);
            
            setTimeout(() => {
                toast.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }

        function setupEventListeners() {
            document.getElementById('bug-report-form').addEventListener('submit', handleFormSubmit);
            document.getElementById('export-bug-list').addEventListener('click', exportBugList);
            document.getElementById('export-critical-bugs').addEventListener('click', exportCriticalBugs);
            document.getElementById('export-status-report').addEventListener('click', exportStatusReport);
            document.getElementById('clear-all-bugs').addEventListener('click', clearAllBugs);
            
            // Template buttons
            document.querySelectorAll('.template-btn').forEach(button => {
                button.addEventListener('click', handleTemplateClick);
            });
            
            // Inline editing for all fields
            setupInlineEditing();
        }

        function setupInlineEditing() {
            // Setup editing for project name
            setupFieldEditing('project-name', 'project_name', 'Nombre del proyecto actualizado');
            
            // Setup editing for version
            setupFieldEditing('version', 'version', 'Versi√≥n actualizada');
            
            // Setup editing for QA manager
            setupFieldEditing('qa-manager', 'qa_manager', 'QA Manager actualizado');
        }
        
        function setupFieldEditing(fieldName, configKey, successMessage) {
            const display = document.getElementById(`${fieldName}-display`);
            const input = document.getElementById(`${fieldName}-input`);
            
            // Click to edit
            display.addEventListener('click', () => {
                display.classList.add('hidden');
                input.classList.remove('hidden');
                input.focus();
                input.select();
            });
            
            // Save on Enter or blur
            const saveField = async () => {
                const newValue = input.value.trim();
                if (newValue && window.elementSdk) {
                    const updateConfig = {};
                    updateConfig[configKey] = newValue;
                    await window.elementSdk.setConfig(updateConfig);
                    showToast(successMessage, "success");
                }
                input.classList.add('hidden');
                display.classList.remove('hidden');
            };
            
            // Cancel on Escape
            const cancelEdit = () => {
                const currentValue = window.elementSdk?.config?.[configKey] || defaultConfig[configKey];
                input.value = currentValue;
                input.classList.add('hidden');
                display.classList.remove('hidden');
            };
            
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    saveField();
                } else if (e.key === 'Escape') {
                    e.preventDefault();
                    cancelEdit();
                }
            });
            
            input.addEventListener('blur', saveField);
        }

        // Initialize the application
        initializeApp();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'996510a631024711',t:'MTc2MTc2NTk5MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
